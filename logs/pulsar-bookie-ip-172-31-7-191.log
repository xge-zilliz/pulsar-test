10:45:57.505 [main] INFO  org.apache.bookkeeper.server.Main - Using configuration file /home/ubuntu/app/apache-pulsar-2.6.0/conf/bookkeeper.conf
10:45:57.516 [main] INFO  org.apache.bookkeeper.server.Main - Hello, I'm your bookie, listening on port 3181. Metadata service uri is zk+null://172.31.7.191:2181;172.31.15.110:2181/ledgers. Journals are in [data/bookkeeper/journal]. Ledgers are stored in data/bookkeeper/ledgers.
10:45:57.530 [main] INFO  org.apache.bookkeeper.server.Main - Load lifecycle component : org.apache.bookkeeper.server.service.StatsProviderService
10:45:57.544 [main] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "readBufferSizeBytes" : "4096",
  "statsProviderClass" : "org.apache.bookkeeper.stats.prometheus.PrometheusMetricsProvider",
  "majorCompactionThreshold" : "0.5",
  "numJournalCallbackThreads" : "8",
  "httpServerPort" : "8000",
  "lostBookieRecoveryDelay" : "0",
  "journalAlignmentSize" : "4096",
  "compactionRateByBytes" : "1000000",
  "httpServerClass" : "org.apache.bookkeeper.http.vertx.VertxHttpServer",
  "dbStorage_rocksDB_numFilesInLevel0" : "4",
  "minUsableSizeForIndexFileCreation" : "1073741824",
  "gcOverreplicatedLedgerWaitTime" : "86400000",
  "journalMaxGroupWaitMSec" : "1",
  "dbStorage_rocksDB_numLevels" : "-1",
  "dbStorage_rocksDB_bloomFilterBitsPerKey" : "10",
  "nettyMaxFrameSizeBytes" : "5253120",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage",
  "auditorPeriodicBookieCheckInterval" : "86400",
  "gcWaitTime" : "900000",
  "compactionRate" : "1000",
  "fileInfoFormatVersionToWrite" : "0",
  "entryLogFilePreallocationEnabled" : "true",
  "journalSyncData" : "true",
  "zkServers" : "[172.31.7.191:2181, 172.31.15.110:2181]",
  "compactionRateByEntries" : "1000",
  "dbStorage_rocksDB_maxSizeInLevel1MB" : "256",
  "diskCheckInterval" : "10000",
  "auditorPeriodicCheckInterval" : "604800",
  "dbStorage_rocksDB_writeBufferSizeMB" : "64",
  "autoRecoveryDaemonEnabled" : "true",
  "maxPendingAddRequestsPerThread" : "10000",
  "flushEntrylogBytes" : "268435456",
  "majorCompactionInterval" : "86400",
  "httpServerEnabled" : "false",
  "flushInterval" : "60000",
  "journalFlushWhenQueueEmpty" : "false",
  "minorCompactionInterval" : "3600",
  "dbStorage_rocksDB_blockCacheSize" : "",
  "isThrottleByBytes" : "false",
  "numAddWorkerThreads" : "0",
  "dbStorage_rocksDB_sstSizeInMB" : "64",
  "journalDirectory" : "data/bookkeeper/journal",
  "journalWriteBufferSizeKB" : "64",
  "diskUsageThreshold" : "0.95",
  "openFileLimit" : "0",
  "prometheusStatsHttpPort" : "8100",
  "zkLedgersRootPath" : "/ledgers",
  "journalMaxSizeMB" : "2048",
  "journalAdaptiveGroupWrites" : "true",
  "openLedgerRereplicationGracePeriod" : "30",
  "ledgerDirectories" : "data/bookkeeper/ledgers",
  "zkTimeout" : "30000",
  "dbStorage_rocksDB_blockSize" : "65536",
  "journalMaxBackups" : "5",
  "maxPendingReadRequestsPerThread" : "2500",
  "useHostNameAsBookieID" : "false",
  "rereplicationEntryBatchSize" : "100",
  "allowLoopback" : "false",
  "readOnlyModeEnabled" : "true",
  "journalRemoveFromPageCache" : "true",
  "dbStorage_readAheadCacheMaxSizeMb" : "",
  "zkEnableSecurity" : "false",
  "numHighPriorityWorkerThreads" : "8",
  "dbStorage_readAheadCacheBatchSize" : "1000",
  "journalFormatVersionToWrite" : "5",
  "writeBufferSizeBytes" : "65536",
  "bookiePort" : "3181",
  "dbStorage_writeCacheMaxSizeMb" : "",
  "pageLimit" : "0",
  "logSizeLimit" : "1073741824",
  "advertisedAddress" : "172.31.7.191",
  "bookieDeathWatchInterval" : "1000",
  "numReadWorkerThreads" : "8",
  "minorCompactionThreshold" : "0.2",
  "serverTcpNoDelay" : "true",
  "journalBufferedWritesThreshold" : "524288",
  "compactionMaxOutstandingRequests" : "100000",
  "journalPreAllocSizeMB" : "16"
}
10:45:57.952 [main] INFO  org.apache.bookkeeper.meta.MetadataDrivers - BookKeeper metadata driver manager initialized
10:45:57.952 [main] INFO  org.apache.bookkeeper.meta.MetadataDrivers - BookKeeper metadata driver manager initialized
10:45:57.952 [main] INFO  org.apache.bookkeeper.meta.MetadataDrivers - BookKeeper metadata driver manager initialized
10:45:57.959 [main] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk+null://172.31.7.191:2181;172.31.15.110:2181/ledgers : zkServers = 172.31.7.191:2181,172.31.15.110:2181, ledgersRootPath = /ledgers.
10:45:57.964 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:zookeeper.version=3.5.7-f0fdd52973d373ffd9c86b81d99842dc2c7f660e, built on 02/10/2020 11:30 GMT
10:45:57.964 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:host.name=ip-172-31-7-191
10:45:57.964 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.version=1.8.0_265
10:45:57.964 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.vendor=Private Build
10:45:57.964 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.home=/usr/lib/jvm/java-8-openjdk-amd64/jre
10:45:57.964 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.class.path=/home/ubuntu/app/apache-pulsar-2.6.0/conf:::/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-http-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-auth-sasl-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.commons-commons-lang3-3.6.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-managed-ledger-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.dataformat-jackson-dataformat-yaml-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.commons-commons-collections4-4.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.slf4j-slf4j-api-1.7.25.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.commons-commons-compress-1.19.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-cpu-affinity-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_hotspot-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-client-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.api.grpc-proto-google-common-protos-1.12.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-xml-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.jaxrs-jackson-jaxrs-base-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.vertx-vertx-web-3.4.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-original-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.core-jackson-databind-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.slf4j-jul-to-slf4j-1.7.25.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.jsonwebtoken-jjwt-jackson-0.11.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_jetty-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.airlift-aircompressor-0.16.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-all-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.logging.log4j-log4j-slf4j-impl-2.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-io-commons-io-2.5.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-tools-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.distributedlog-distributedlog-common-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.auth-google-auth-library-credentials-0.9.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.distributedlog-distributedlog-core-4.10.0-tests.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-common-allocator-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.protobuf.nano-protobuf-javanano-3.0.0-alpha-5.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-common-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.checkerframework-checker-compat-qual-2.5.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.jsonwebtoken-jjwt-impl-0.11.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/log4j-log4j-1.2.17.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-circe-checksum-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-java-client-base-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.dropwizard.metrics-metrics-jvm-3.1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-logging-commons-logging-1.1.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-testclient-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.vertx-vertx-core-3.4.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-broker-auth-sasl-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.kubernetes-client-java-2.0.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.carrotsearch-hppc-0.7.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-proto-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.curator-curator-recipes-4.0.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_log4j2-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-broker-common-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-transaction-common-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.ext-jersey-entity-filtering-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-common-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.stats-bookkeeper-stats-api-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-api-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-proxy-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.media-jersey-media-json-jackson-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_common-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.aspectj-aspectjweaver-1.9.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-collections-commons-collections-3.2.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.logging.log4j-log4j-api-2.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-transaction-coordinator-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-http-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.opencensus-opencensus-api-0.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.httpcomponents-httpcore-4.4.9.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.aspectj-aspectjrt-1.9.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.containers-jersey-container-servlet-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.curator-curator-client-4.0.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.inject-javax.inject-1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.rocksdb-rocksdbjni-5.13.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-handler-proxy-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.errorprone-error_prone_annotations-2.1.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.jsonwebtoken-jjwt-api-0.11.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-zookeeper-utils-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.codehaus.mojo-animal-sniffer-annotations-1.14.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.module-jackson-module-jsonSchema-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.code.findbugs-jsr305-3.0.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-common-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-runtime-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-protobuf-shaded-2.1.0-incubating.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus.jmx-collector-0.12.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.logging.log4j-log4j-web-2.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/jakarta.activation-jakarta.activation-api-1.2.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.logging.log4j-log4j-core-2.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.github.ben-manes.caffeine-caffeine-2.6.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-broker-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.core-jersey-client-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-native-kqueue-4.1.48.Final-osx-x86_64.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.yaml-snakeyaml-1.24.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2-hk2-utils-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-continuation-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.distributedlog-distributedlog-core-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.protobuf-protobuf-java-3.5.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.stats-codahale-metrics-provider-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-servlets-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.asynchttpclient-async-http-client-2.12.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_httpserver-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-cli-commons-cli-1.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-security-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.curator-curator-framework-4.0.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-resolver-dns-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.inferred-freebuilder-1.14.9.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.slf4j-jcl-over-slf4j-1.7.25.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.hamcrest-hamcrest-core-1.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.core-jersey-common-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-java-client-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-core-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.yahoo.datasketches-memory-0.8.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.sun.activation-javax.activation-1.2.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.swagger-swagger-models-1.5.21.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-auth-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-websocket-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.dropwizard.metrics-metrics-core-3.1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-http2-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.core-jersey-server-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-statelib-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-testing-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-servlet-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.squareup.okhttp-okhttp-2.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-protobuf-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-api-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-context-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-javax-websocket-client-impl-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.avro-avro-protobuf-1.9.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-netty-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.javassist-javassist-3.25.0-GA.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/net.jcip-jcip-annotations-1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/net.jodah-typetools-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-servlet-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-common-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.j2objc-j2objc-annotations-1.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-api-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-admin-original-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.swagger-swagger-core-1.5.21.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.checkerframework-checker-qual-2.0.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.xml.bind-jaxb-api-2.3.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.core-jackson-core-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2.external-aopalliance-repackaged-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-api-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.servlet-javax.servlet-api-3.1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-common-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.distributedlog-distributedlog-protocol-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-messagecrypto-bc-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-tools-framework-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_servlet-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-worker-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.opencensus-opencensus-contrib-grpc-metrics-0.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.squareup.okio-okio-1.13.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2.external-javax.inject-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.inject-jersey-hk2-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.core-jackson-annotations-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.hdrhistogram-HdrHistogram-2.1.9.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.stats-prometheus-metrics-provider-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.media-jersey-media-multipart-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-api-examples-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-codec-commons-codec-1.10.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.ws.rs-javax.ws.rs-api-2.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2-osgi-resource-locator-1.0.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.asynchttpclient-async-http-client-netty-utils-2.12.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-resolver-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-buffer-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-metadata-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-secrets-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.jctools-jctools-core-2.1.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.kubernetes-client-java-api-2.0.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.code.gson-gson-2.8.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.yahoo.datasketches-sketches-core-0.8.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-proto-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.websocket-javax.websocket-client-api-1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-server-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.annotation-javax.annotation-api-1.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2-hk2-api-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.jaxrs-jackson-jaxrs-json-provider-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.http-vertx-http-server-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-util-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.media-jersey-media-jaxb-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.httpcomponents-httpclient-4.5.5.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-server-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.swagger-swagger-annotations-1.5.21.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.validation-validation-api-1.1.0.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.module-jackson-module-jaxb-annotations-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.http-http-server-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-client-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/joda-time-joda-time-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-server-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-tcnative-boringssl-static-2.0.30.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-io-core-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-configuration-commons-configuration-1.10.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.squareup.okhttp-logging-interceptor-2.7.5.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-native-unix-common-4.1.48.Final-linux-x86_64.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-dns-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.tests-stream-storage-tests-common-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_caffeine-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.typesafe.netty-netty-reactive-streams-2.0.4.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.containers-jersey-container-servlet-core-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-bouncy-castle-bc-shaded-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-discovery-service-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.yetus-audience-annotations-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-local-runner-original-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-utils-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-proto-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.beust-jcommander-1.48.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-instance-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.protobuf-protobuf-java-util-3.5.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.zookeeper-zookeeper-jute-3.5.7.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-protobuf-lite-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.vertx-vertx-auth-common-3.4.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.avro-avro-1.9.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-io-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-socks-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.jvnet.mimepull-mimepull-1.9.6.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-proxy-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2-hk2-locator-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/jakarta.xml.bind-jakarta.xml.bind-api-2.3.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.kubernetes-client-java-proto-2.0.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/net.java.dev.jna-jna-4.2.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-service-impl-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-okhttp-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.guava-guava-25.1-jre.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.squareup.okhttp-okhttp-ws-2.7.5.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-service-api-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.github.zafarkhaja-java-semver-0.9.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-native-epoll-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.dropwizard.metrics-metrics-graphite-3.1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-handler-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-protobuf-nano-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-lang-commons-lang-2.6.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.reactivestreams-reactive-streams-1.0.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-stub-1.18.0.jar:
10:45:57.966 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.library.path=/usr/java/packages/lib/amd64:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
10:45:57.966 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.io.tmpdir=/tmp
10:45:57.966 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.compiler=<NA>
10:45:57.966 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:os.name=Linux
10:45:57.966 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:os.arch=amd64
10:45:57.966 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:os.version=5.4.0-1025-aws
10:45:57.966 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:user.name=ubuntu
10:45:57.966 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:user.home=/home/ubuntu
10:45:57.966 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:user.dir=/home/ubuntu/app/apache-pulsar-2.6.0
10:45:57.966 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:os.memory.free=1998MB
10:45:57.966 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:os.memory.max=2048MB
10:45:57.966 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:os.memory.total=2048MB
10:45:57.970 [main] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=172.31.7.191:2181,172.31.15.110:2181 sessionTimeout=30000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@31e75d13
10:45:57.974 [main] INFO  org.apache.zookeeper.common.X509Util - Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation
10:45:57.980 [main] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 10485760 Bytes
10:45:57.987 [main] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=
10:45:57.993 [main-SendThread(172.31.7.191:2181)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server ip-172-31-7-191/172.31.7.191:2181. Will not attempt to authenticate using SASL (unknown error)
10:45:57.997 [main-SendThread(172.31.7.191:2181)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /172.31.7.191:41658, server: ip-172-31-7-191/172.31.7.191:2181
10:45:58.003 [main-SendThread(172.31.7.191:2181)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server ip-172-31-7-191/172.31.7.191:2181, sessionid = 0x100019f79e70006, negotiated timeout = 30000
10:45:58.005 [main-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
10:45:58.041 [main] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [data/bookkeeper/journal/current] [data/bookkeeper/ledgers/current]
10:45:58.109 [main] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
10:45:58.126 [main] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from data/bookkeeper/ledgers/current/lastMark (this is okay if it is the first time starting this bookie
10:45:58.128 [main] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage
10:45:58.129 [main] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Started Db Ledger Storage
10:45:58.129 [main] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage -  - Number of directories: 1
10:45:58.129 [main] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage -  - Write cache size: 512 MB
10:45:58.129 [main] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage -  - Read Cache: 512 MB
10:45:58.132 [main] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Creating single directory db ledger storage on data/bookkeeper/ledgers/current
10:45:58.269 [main] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
10:45:58.278 [main] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.2, interval=3600000
10:45:58.278 [main] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.5, interval=86400000
10:45:58.306 [main] INFO  org.apache.bookkeeper.server.Main - Load lifecycle component : org.apache.bookkeeper.server.service.BookieService
10:45:58.349 [main] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk+null://172.31.7.191:2181;172.31.15.110:2181/ledgers : zkServers = 172.31.7.191:2181,172.31.15.110:2181, ledgersRootPath = /ledgers.
10:45:58.349 [main] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=172.31.7.191:2181,172.31.15.110:2181 sessionTimeout=30000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@5aa360ea
10:45:58.350 [main] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 10485760 Bytes
10:45:58.350 [main] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=
10:45:58.350 [main-SendThread(172.31.7.191:2181)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server ip-172-31-7-191/172.31.7.191:2181. Will not attempt to authenticate using SASL (unknown error)
10:45:58.350 [main-SendThread(172.31.7.191:2181)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /172.31.7.191:41660, server: ip-172-31-7-191/172.31.7.191:2181
10:45:58.353 [main-SendThread(172.31.7.191:2181)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server ip-172-31-7-191/172.31.7.191:2181, sessionid = 0x100019f79e70007, negotiated timeout = 30000
10:45:58.353 [main-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
10:45:58.376 [main] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
10:45:58.394 [main] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:172.31.7.191:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
10:45:58.394 [main] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
10:45:58.397 [main] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
10:45:58.459 [main] INFO  org.apache.bookkeeper.server.Main - Load lifecycle component : org.apache.bookkeeper.server.service.AutoRecoveryService
10:45:58.464 [main] INFO  org.apache.bookkeeper.common.component.ComponentStarter - Starting component bookie-server.
10:45:58.476 [main] INFO  org.eclipse.jetty.util.log - Logging initialized @1950ms to org.eclipse.jetty.util.log.Slf4jLog
10:45:58.552 [main] INFO  org.eclipse.jetty.server.Server - jetty-9.4.20.v20190813; built: 2019-08-13T21:28:18.144Z; git: 84700530e645e812b336747464d6fbbf370c9a20; jvm 1.8.0_265-8u265-b01-0ubuntu2~18.04-b01
10:45:58.582 [main] INFO  org.eclipse.jetty.server.handler.ContextHandler - Started o.e.j.s.ServletContextHandler@42f22995{/,null,AVAILABLE}
10:45:58.592 [main] INFO  org.eclipse.jetty.server.AbstractConnector - Started ServerConnector@1a1ed4e5{HTTP/1.1,[http/1.1]}{0.0.0.0:8100}
10:45:58.592 [main] INFO  org.eclipse.jetty.server.Server - Started @2066ms
10:45:58.592 [main] INFO  org.apache.bookkeeper.stats.prometheus.PrometheusMetricsProvider - Started Prometheus stats endpoint at 0.0.0.0:8100
10:45:58.600 [main] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 1 ms.
10:45:58.614 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
10:45:58.617 [main] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
10:45:58.618 [BookieJournal-3181] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on data/bookkeeper/journal/current
10:45:58.619 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
10:45:58.621 [BookieJournal-3181] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal data/bookkeeper/journal/current/174d97810dc.txn
10:45:58.625 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/172.31.7.191:3181
10:45:58.876 [main] INFO  org.apache.bookkeeper.common.component.ComponentStarter - Started component bookie-server.
10:45:58.894 [AuditorElector-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - AuthProvider used by the Auditor is null
10:45:58.896 [AuditorElector-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Initializing lostBookieRecoveryDelay zNode to the conif value: 0
10:45:58.897 [AuditorElector-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - I'm starting as Auditor Bookie. ID: 172.31.7.191:3181
10:45:58.900 [AuditorElector-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
10:45:58.900 [AuditorElector-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
10:45:58.901 [AuditorElector-172.31.7.191:3181] WARN  org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager - checkAllLedgersCtimeZnode is not yet available
10:45:58.901 [AuditorElector-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: -1 durationSinceLastExecutionInSecs: -1 initialDelay: 0 interval: 604800
10:45:58.901 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Starting auditBookies
10:45:58.901 [AuditorElector-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Periodic placementPolicy check disabled
10:45:58.901 [AuditorElector-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Periodic replicas check disabled
10:45:58.920 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Completed auditBookies
10:45:58.921 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Starting checkAllLedgers
10:45:58.928 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk+null://172.31.7.191:2181;172.31.15.110:2181/ledgers : zkServers = 172.31.7.191:2181,172.31.15.110:2181, ledgersRootPath = /ledgers.
10:45:58.928 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=172.31.7.191:2181,172.31.15.110:2181 sessionTimeout=30000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@63fd8bda
10:45:58.929 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 10485760 Bytes
10:45:58.929 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=
10:45:58.929 [AuditorBookie-172.31.7.191:3181-SendThread(172.31.7.191:2181)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server ip-172-31-7-191/172.31.7.191:2181. Will not attempt to authenticate using SASL (unknown error)
10:45:58.929 [AuditorBookie-172.31.7.191:3181-SendThread(172.31.7.191:2181)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /172.31.7.191:41662, server: ip-172-31-7-191/172.31.7.191:2181
10:45:58.932 [AuditorBookie-172.31.7.191:3181-SendThread(172.31.7.191:2181)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server ip-172-31-7-191/172.31.7.191:2181, sessionid = 0x100019f79e70008, negotiated timeout = 30000
10:45:58.932 [AuditorBookie-172.31.7.191:3181-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
10:45:58.973 [AuditorBookie-172.31.7.191:3181] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
10:45:58.973 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:172.31.7.191:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
10:45:58.973 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
10:45:58.973 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
10:45:58.975 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/172.31.7.191:3181
10:45:59.107 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100019f79e70008 closed
10:45:59.107 [AuditorBookie-172.31.7.191:3181-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100019f79e70008
10:45:59.107 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Completed checkAllLedgers in 185 milliSeconds
10:46:03.922 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/172.31.15.110:3181
10:46:12.923 [bookie-io-1-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
10:46:12.923 [bookie-io-1-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x4802040f, L:/172.31.7.191:3181 - R:/172.31.7.191:54960]
10:46:13.082 [BookieHighPriorityThread-3181-OrderedExecutor-0-0] INFO  org.apache.bookkeeper.proto.ReadEntryProcessorV3 - Ledger fence request received for ledger: 0 from address: /172.31.7.191:54960
10:46:13.146 [bookie-io-1-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x4802040f, L:/172.31.7.191:3181 ! R:/172.31.7.191:54960]
10:46:58.619 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
10:46:58.621 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/0.log for logId 0.
10:46:58.622 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/1.log for logId 1.
10:47:17.510 [bookie-io-1-3] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
10:47:17.510 [bookie-io-1-3] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x0f91cbe1, L:/172.31.7.191:3181 - R:/172.31.15.110:58356]
10:47:17.516 [bookie-io-1-4] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
10:47:17.516 [bookie-io-1-4] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x7aa2f819, L:/172.31.7.191:3181 - R:/172.31.15.110:58358]
10:47:17.516 [bookie-io-1-5] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
10:47:17.517 [bookie-io-1-6] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
10:47:17.517 [bookie-io-1-6] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x2ed3a167, L:/172.31.7.191:3181 - R:/172.31.15.110:58362]
10:47:17.517 [bookie-io-1-5] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xf130caa0, L:/172.31.7.191:3181 - R:/172.31.15.110:58360]
10:47:17.519 [bookie-io-1-7] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
10:47:17.519 [bookie-io-1-7] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x4fd25e85, L:/172.31.7.191:3181 - R:/172.31.15.110:58364]
10:47:17.519 [bookie-io-1-8] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
10:47:17.520 [bookie-io-1-8] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x7875b04a, L:/172.31.7.191:3181 - R:/172.31.15.110:58366]
10:47:17.520 [bookie-io-1-9] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
10:47:17.520 [bookie-io-1-9] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x08d78028, L:/172.31.7.191:3181 - R:/172.31.15.110:58368]
10:47:17.521 [bookie-io-1-10] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
10:47:17.521 [bookie-io-1-10] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x88f02dec, L:/172.31.7.191:3181 - R:/172.31.15.110:58370]
10:47:17.522 [bookie-io-1-11] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
10:47:17.522 [bookie-io-1-11] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x3d8feaa0, L:/172.31.7.191:3181 - R:/172.31.15.110:58372]
10:47:17.527 [bookie-io-1-12] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
10:47:17.527 [bookie-io-1-13] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
10:47:17.527 [bookie-io-1-13] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x805c7956, L:/172.31.7.191:3181 - R:/172.31.15.110:58376]
10:47:17.527 [bookie-io-1-12] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x18b9bf36, L:/172.31.7.191:3181 - R:/172.31.15.110:58374]
10:47:17.530 [bookie-io-1-15] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
10:47:17.530 [bookie-io-1-14] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
10:47:17.530 [bookie-io-1-15] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xfb8e3324, L:/172.31.7.191:3181 - R:/172.31.15.110:58380]
10:47:17.530 [bookie-io-1-14] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x777b3ece, L:/172.31.7.191:3181 - R:/172.31.15.110:58378]
10:47:17.531 [bookie-io-1-16] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
10:47:17.531 [bookie-io-1-16] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x1430b1d5, L:/172.31.7.191:3181 - R:/172.31.15.110:58382]
10:47:17.532 [bookie-io-1-17] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
10:47:17.532 [bookie-io-1-17] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x3e125158, L:/172.31.7.191:3181 - R:/172.31.15.110:58384]
10:47:17.534 [bookie-io-1-18] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
10:47:17.534 [bookie-io-1-18] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x2cfaf6ae, L:/172.31.7.191:3181 - R:/172.31.15.110:58386]
11:01:58.621 [db-storage-cleanup-10-1] INFO  org.apache.bookkeeper.bookie.storage.ldb.EntryLocationIndex - Deleting indexes for ledgers: [0]
11:01:58.623 [db-storage-cleanup-10-1] INFO  org.apache.bookkeeper.bookie.storage.ldb.EntryLocationIndex - Deleted indexes for 10 entries from 1 ledgers in 0.001 seconds
11:02:47.092 [bookie-io-1-19] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:02:47.092 [bookie-io-1-19] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x50f803f2, L:/172.31.7.191:3181 - R:/172.31.7.191:54988]
11:02:47.093 [bookie-io-1-20] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:02:47.094 [bookie-io-1-22] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:02:47.094 [bookie-io-1-22] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x5cc5b215, L:/172.31.7.191:3181 - R:/172.31.7.191:54992]
11:02:47.094 [bookie-io-1-21] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:02:47.094 [bookie-io-1-20] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x49d1f629, L:/172.31.7.191:3181 - R:/172.31.7.191:55026]
11:02:47.094 [bookie-io-1-21] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x659cf280, L:/172.31.7.191:3181 - R:/172.31.7.191:54994]
11:02:47.095 [bookie-io-1-23] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:02:47.095 [bookie-io-1-23] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x5b78af99, L:/172.31.7.191:3181 - R:/172.31.7.191:55028]
11:02:47.095 [bookie-io-1-25] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:02:47.095 [bookie-io-1-25] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x6b1ba923, L:/172.31.7.191:3181 - R:/172.31.7.191:55032]
11:02:47.096 [bookie-io-1-24] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:02:47.096 [bookie-io-1-24] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x13f55081, L:/172.31.7.191:3181 - R:/172.31.7.191:54990]
11:02:47.097 [bookie-io-1-26] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:02:47.098 [bookie-io-1-26] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x24e05e98, L:/172.31.7.191:3181 - R:/172.31.7.191:55040]
11:02:47.098 [bookie-io-1-28] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:02:47.098 [bookie-io-1-27] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:02:47.098 [bookie-io-1-28] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xe387ccee, L:/172.31.7.191:3181 - R:/172.31.7.191:55044]
11:02:47.099 [bookie-io-1-27] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xfcee2d07, L:/172.31.7.191:3181 - R:/172.31.7.191:55038]
11:02:47.100 [bookie-io-1-29] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:02:47.100 [bookie-io-1-30] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:02:47.101 [bookie-io-1-30] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x03ecc87c, L:/172.31.7.191:3181 - R:/172.31.7.191:55048]
11:02:47.101 [bookie-io-1-29] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x1a791ecf, L:/172.31.7.191:3181 - R:/172.31.7.191:55050]
11:02:47.101 [bookie-io-1-31] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:02:47.101 [bookie-io-1-31] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xf311c875, L:/172.31.7.191:3181 - R:/172.31.7.191:55054]
11:02:47.102 [bookie-io-1-32] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:02:47.102 [bookie-io-1-32] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xa4da9be8, L:/172.31.7.191:3181 - R:/172.31.7.191:55058]
11:02:47.102 [bookie-io-1-1] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:02:47.102 [bookie-io-1-1] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xd25f321b, L:/172.31.7.191:3181 - R:/172.31.7.191:55066]
11:02:47.103 [bookie-io-1-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:02:47.103 [bookie-io-1-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x5462c566, L:/172.31.7.191:3181 - R:/172.31.7.191:55070]
11:15:03.357 [bookie-io-1-6] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:15:10.590 [bookie-io-1-30] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:15:22.844 [bookie-io-1-15] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:15:27.725 [bookie-io-1-29] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:15:29.822 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
11:15:29.824 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 0 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=0, logFile=data/bookkeeper/ledgers/current/0.log, ledgerIdAssigned=-1}].
11:15:29.838 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/2.log for logId 2.
11:15:30.131 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 0 to disk.
11:15:34.832 [bookie-io-1-23] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:15:47.680 [bookie-io-1-9] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:15:52.295 [bookie-io-1-8] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:15:53.215 [BookieJournal-3181] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal data/bookkeeper/journal/current/174d97810dd.txn
11:15:58.618 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Extracting entry log meta from entryLogId: 0
11:15:59.663 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
11:15:59.663 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 1 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=1, logFile=data/bookkeeper/ledgers/current/1.log, ledgerIdAssigned=-1}].
11:15:59.664 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/3.log for logId 3.
11:15:59.761 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 1 to disk.
11:15:59.766 [db-storage-cleanup-10-1] INFO  org.apache.bookkeeper.bookie.storage.ldb.EntryLocationIndex - Deleting indexes for ledgers: [269, 79, 83, 20, 85, 23, 215, 24, 90, 26, 411, 91, 412, 220, 221, 415, 224, 225, 419, 420, 229, 422, 233, 238, 48, 241, 242, 246, 248, 249]
11:15:59.799 [db-storage-cleanup-10-1] INFO  org.apache.bookkeeper.bookie.storage.ldb.EntryLocationIndex - Deleted indexes for 27807 entries from 30 ledgers in 0.032 seconds
11:20:49.099 [bookie-io-1-26] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:20:56.108 [bookie-io-1-17] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:30:58.618 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Extracting entry log meta from entryLogId: 1
11:30:58.624 [db-storage-cleanup-10-1] INFO  org.apache.bookkeeper.bookie.storage.ldb.EntryLocationIndex - Deleting indexes for ledgers: [417, 427, 428, 47, 432, 434, 211, 212, 245, 22, 439, 88, 217, 250, 413, 126]
11:30:58.646 [db-storage-cleanup-10-1] INFO  org.apache.bookkeeper.bookie.storage.ldb.EntryLocationIndex - Deleted indexes for 11799 entries from 16 ledgers in 0.021 seconds
11:38:19.267 [bookie-io-1-20] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:38:21.216 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
11:38:21.216 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 2 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=2, logFile=data/bookkeeper/ledgers/current/2.log, ledgerIdAssigned=-1}].
11:38:21.223 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/4.log for logId 4.
11:38:23.331 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 2 to disk.
11:38:33.360 [bookie-io-1-7] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:38:44.578 [bookie-io-1-11] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:38:48.911 [bookie-io-1-3] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:38:49.033 [BookieJournal-3181] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal data/bookkeeper/journal/current/174d97810de.txn
11:38:59.813 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
11:38:59.813 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 3 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=3, logFile=data/bookkeeper/ledgers/current/3.log, ledgerIdAssigned=-1}].
11:38:59.822 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/5.log for logId 5.
11:39:00.898 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 3 to disk.
11:39:03.533 [bookie-io-1-17] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:39:11.455 [bookie-io-1-19] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:39:22.833 [bookie-io-1-21] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:39:32.999 [bookie-io-1-31] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:39:34.350 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
11:39:34.351 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 4 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=4, logFile=data/bookkeeper/ledgers/current/4.log, ledgerIdAssigned=-1}].
11:39:34.359 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/6.log for logId 6.
11:39:36.018 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 4 to disk.
11:39:44.557 [bookie-io-1-15] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:39:55.492 [bookie-io-1-1] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:39:58.675 [BookieJournal-3181] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal data/bookkeeper/journal/current/174d97810df.txn
11:40:04.544 [bookie-io-1-7] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:40:06.161 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
11:40:06.161 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 5 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=5, logFile=data/bookkeeper/ledgers/current/5.log, ledgerIdAssigned=-1}].
11:40:06.168 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/7.log for logId 7.
11:40:07.761 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 5 to disk.
11:40:18.118 [bookie-io-1-1] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:40:29.184 [bookie-io-1-26] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:40:39.291 [bookie-io-1-31] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:40:50.001 [bookie-io-1-5] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:40:50.741 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
11:40:50.741 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 6 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=6, logFile=data/bookkeeper/ledgers/current/6.log, ledgerIdAssigned=-1}].
11:40:50.742 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/8.log for logId 8.
11:40:53.018 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 6 to disk.
11:41:09.205 [bookie-io-1-12] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:41:19.291 [bookie-io-1-8] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:41:19.348 [BookieJournal-3181] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal data/bookkeeper/journal/current/174d97810e0.txn
11:41:24.368 [bookie-io-1-32] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:41:25.921 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
11:41:25.921 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 7 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=7, logFile=data/bookkeeper/ledgers/current/7.log, ledgerIdAssigned=-1}].
11:41:25.927 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/9.log for logId 9.
11:41:27.429 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 7 to disk.
11:41:36.026 [bookie-io-1-3] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:41:36.026 [bookie-io-1-6] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:41:50.863 [bookie-io-1-10] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:44:26.468 [bookie-io-1-20] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:44:26.545 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
11:44:26.546 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 8 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=8, logFile=data/bookkeeper/ledgers/current/8.log, ledgerIdAssigned=-1}].
11:44:26.548 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/a.log for logId 10.
11:44:30.042 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 8 to disk.
11:44:38.855 [bookie-io-1-4] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:44:41.336 [bookie-io-1-3] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:44:43.426 [BookieJournal-3181] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal data/bookkeeper/journal/current/174d97810e1.txn
11:44:45.309 [bookie-io-1-13] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:44:50.252 [bookie-io-1-10] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:44:50.331 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
11:44:50.332 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 9 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=9, logFile=data/bookkeeper/ledgers/current/9.log, ledgerIdAssigned=-1}].
11:44:50.335 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/b.log for logId 11.
11:44:53.874 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 9 to disk.
11:45:04.492 [bookie-io-1-26] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:45:07.954 [bookie-io-1-12] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:45:12.802 [bookie-io-1-32] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:45:12.884 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
11:45:12.884 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 10 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=10, logFile=data/bookkeeper/ledgers/current/a.log, ledgerIdAssigned=-1}].
11:45:12.885 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/c.log for logId 12.
11:45:15.094 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 10 to disk.
11:45:18.957 [bookie-io-1-1] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:45:30.252 [bookie-io-1-1] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:45:58.618 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Extracting entry log meta from entryLogId: 2
11:45:58.619 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Extracting entry log meta from entryLogId: 3
11:45:58.619 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Extracting entry log meta from entryLogId: 4
11:45:58.620 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Extracting entry log meta from entryLogId: 5
11:45:58.620 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Extracting entry log meta from entryLogId: 6
11:45:58.621 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Extracting entry log meta from entryLogId: 7
11:45:58.621 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Extracting entry log meta from entryLogId: 8
11:45:58.621 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Extracting entry log meta from entryLogId: 9
11:45:58.622 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Extracting entry log meta from entryLogId: 10
11:45:58.639 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Enter minor compaction, suspendMinor false
11:45:58.639 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Do compaction to compact those files lower than 0.2
11:45:59.113 [db-storage-cleanup-10-1] INFO  org.apache.bookkeeper.bookie.storage.ldb.EntryLocationIndex - Deleting indexes for ledgers: [3, 12, 13, 14, 15, 16, 17, 18, 19, 21, 25, 27, 28, 29, 30, 34, 37, 38, 39, 40, 44, 49, 51, 52, 53, 55, 57, 58, 59, 60, 63, 64, 65, 81, 82, 84, 86, 87, 89, 93, 103, 104, 105, 106, 108, 109, 112, 113, 114, 115, 116, 117, 118, 119, 122, 123, 125, 127, 130, 131, 132, 133, 134, 135, 136, 149, 156, 157, 159, 161, 163, 166, 167, 169, 172, 174, 181, 182, 187, 188, 190, 192, 193, 194, 195, 200, 203, 206, 207, 208, 209, 210, 213, 214, 216, 218, 219, 222, 223, 226, 227, 228, 230, 231, 232, 234, 235, 236, 237, 239, 240, 243, 244, 247, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 270, 279, 280, 289, 291, 293, 300, 302, 304, 305, 306, 308, 309, 318, 320, 324, 328, 329, 330, 333, 335, 345, 347, 350, 352, 359, 360, 361, 364, 365, 366, 368, 370, 380, 388, 392, 395, 399, 402, 405, 410, 414, 416, 418, 421, 423, 424, 425, 426, 429, 430, 431, 433, 435, 436, 437, 438, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 540, 541, 542, 543, 544, 545, 546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560, 561, 562, 565, 566, 567, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 583, 584, 585, 587, 588, 589, 590, 591, 592, 593, 594, 596, 597, 598, 599, 600, 601, 602, 603, 606, 607, 608, 609, 610, 611, 614, 615, 616, 617, 618, 619, 620, 622, 623, 624, 625, 626, 628, 629, 630, 632, 634, 637, 638, 639, 641, 642, 643, 645, 646, 647, 648, 649, 650, 653, 654, 655, 656, 657, 658, 660, 661, 662, 665, 666, 667, 668, 669, 671, 672, 673, 674, 675, 676, 678, 679, 680, 681, 682, 683, 684, 686, 687, 688, 689, 692, 693, 694, 695, 696, 697, 698, 699, 700, 701, 702, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 715, 717, 718, 719, 720, 722, 723, 724, 726, 727, 728, 729, 733, 734, 735, 736, 737, 747, 748, 749, 750, 751, 752, 754, 755, 756, 757, 758, 759, 760, 761, 769, 771, 800, 801, 805, 807, 808, 811, 813, 815, 818, 819, 820, 823, 830, 835, 861, 866, 868, 877]
11:45:59.826 [db-storage-cleanup-10-1] INFO  org.apache.bookkeeper.bookie.storage.ldb.EntryLocationIndex - Deleted indexes for 523312 entries from 478 ledgers in 0.711 seconds
11:46:02.164 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.EntryLogCompactor - Removing entry log 3 after compaction
11:46:02.270 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Removing entry log metadata for 3
11:46:05.947 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.EntryLogCompactor - Removing entry log 1 after compaction
11:46:06.047 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Removing entry log metadata for 1
11:46:53.277 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.EntryLogCompactor - Removing entry log 0 after compaction
11:46:53.372 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Removing entry log metadata for 0
11:46:55.595 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
11:46:55.596 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 11 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=11, logFile=data/bookkeeper/ledgers/current/b.log, ledgerIdAssigned=-1}].
11:46:55.596 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/d.log for logId 13.
11:46:55.766 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 11 to disk.
11:46:55.787 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.EntryLogCompactor - Removing entry log 4 after compaction
11:46:55.893 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Removing entry log metadata for 4
11:47:10.170 [BookieJournal-3181] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal data/bookkeeper/journal/current/174d97810e2.txn
11:47:11.036 [bookie-io-1-15] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:47:15.042 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.Journal - garbage collected journal 174d97810dc.txn
11:47:15.190 [bookie-io-1-21] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:47:19.268 [bookie-io-1-1] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:47:24.241 [bookie-io-1-32] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:47:27.498 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
11:47:27.498 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 12 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=12, logFile=data/bookkeeper/ledgers/current/c.log, ledgerIdAssigned=-1}].
11:47:27.499 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/e.log for logId 14.
11:47:27.587 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 12 to disk.
11:47:36.253 [bookie-io-1-19] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:47:39.154 [bookie-io-1-10] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:47:43.161 [bookie-io-1-23] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:47:55.971 [bookie-io-1-1] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:47:55.980 [BookieJournal-3181] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal data/bookkeeper/journal/current/174d97810e3.txn
11:47:58.479 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
11:47:58.479 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 13 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=13, logFile=data/bookkeeper/ledgers/current/d.log, ledgerIdAssigned=-1}].
11:47:58.481 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/f.log for logId 15.
11:47:58.715 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 13 to disk.
11:48:01.110 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.Journal - garbage collected journal 174d97810dd.txn
11:48:11.014 [bookie-io-1-24] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:48:13.787 [bookie-io-1-31] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:48:17.963 [bookie-io-1-27] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:48:21.734 [bookie-io-1-23] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:48:21.891 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
11:48:21.892 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 14 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=14, logFile=data/bookkeeper/ledgers/current/e.log, ledgerIdAssigned=-1}].
11:48:21.893 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/10.log for logId 16.
11:48:25.704 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 14 to disk.
11:48:26.019 [bookie-io-1-25] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:48:30.110 [bookie-io-1-2] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:48:34.115 [bookie-io-1-19] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:48:34.228 [BookieJournal-3181] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal data/bookkeeper/journal/current/174d97810e4.txn
11:48:37.191 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
11:48:37.191 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 15 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=15, logFile=data/bookkeeper/ledgers/current/f.log, ledgerIdAssigned=-1}].
11:48:37.199 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/11.log for logId 17.
11:48:37.416 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 15 to disk.
11:48:41.241 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.Journal - garbage collected journal 174d97810de.txn
11:48:41.515 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.EntryLogCompactor - Removing entry log 2 after compaction
11:48:41.617 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Removing entry log metadata for 2
11:48:44.203 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.EntryLogCompactor - Removing entry log 5 after compaction
11:48:44.299 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Removing entry log metadata for 5
11:48:45.795 [bookie-io-1-26] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:48:50.912 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
11:48:50.912 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 16 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=16, logFile=data/bookkeeper/ledgers/current/10.log, ledgerIdAssigned=-1}].
11:48:50.913 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/12.log for logId 18.
11:48:50.980 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 16 to disk.
11:48:50.992 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.EntryLogCompactor - Removing entry log 6 after compaction
11:48:51.088 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Removing entry log metadata for 6
11:48:51.089 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 6, 1, 2, 0, 1, 0, 1, 0, 0]
11:49:38.271 [bookie-io-1-3] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x0f91cbe1, L:/172.31.7.191:3181 ! R:/172.31.15.110:58356]
11:49:38.272 [bookie-io-1-5] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xf130caa0, L:/172.31.7.191:3181 ! R:/172.31.15.110:58360]
11:49:38.272 [bookie-io-1-6] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x2ed3a167, L:/172.31.7.191:3181 ! R:/172.31.15.110:58362]
11:49:38.272 [bookie-io-1-4] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x7aa2f819, L:/172.31.7.191:3181 ! R:/172.31.15.110:58358]
11:49:38.272 [bookie-io-1-7] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x4fd25e85, L:/172.31.7.191:3181 ! R:/172.31.15.110:58364]
11:49:38.272 [bookie-io-1-8] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x7875b04a, L:/172.31.7.191:3181 ! R:/172.31.15.110:58366]
11:49:38.272 [bookie-io-1-10] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x88f02dec, L:/172.31.7.191:3181 ! R:/172.31.15.110:58370]
11:49:38.272 [bookie-io-1-9] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x08d78028, L:/172.31.7.191:3181 ! R:/172.31.15.110:58368]
11:49:38.273 [bookie-io-1-11] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x3d8feaa0, L:/172.31.7.191:3181 ! R:/172.31.15.110:58372]
11:49:38.273 [bookie-io-1-12] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x18b9bf36, L:/172.31.7.191:3181 ! R:/172.31.15.110:58374]
11:49:38.273 [bookie-io-1-13] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x805c7956, L:/172.31.7.191:3181 ! R:/172.31.15.110:58376]
11:49:38.273 [bookie-io-1-14] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x777b3ece, L:/172.31.7.191:3181 ! R:/172.31.15.110:58378]
11:49:38.273 [bookie-io-1-15] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xfb8e3324, L:/172.31.7.191:3181 ! R:/172.31.15.110:58380]
11:49:38.273 [bookie-io-1-16] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x1430b1d5, L:/172.31.7.191:3181 ! R:/172.31.15.110:58382]
11:49:38.273 [bookie-io-1-17] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x3e125158, L:/172.31.7.191:3181 ! R:/172.31.15.110:58384]
11:49:38.274 [bookie-io-1-18] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x2cfaf6ae, L:/172.31.7.191:3181 ! R:/172.31.15.110:58386]
11:49:44.832 [bookie-io-1-25] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x6b1ba923, L:/172.31.7.191:3181 ! R:/172.31.7.191:55032]
11:49:44.833 [bookie-io-1-24] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x13f55081, L:/172.31.7.191:3181 ! R:/172.31.7.191:54990]
11:49:44.833 [bookie-io-1-23] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x5b78af99, L:/172.31.7.191:3181 ! R:/172.31.7.191:55028]
11:49:44.833 [bookie-io-1-27] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xfcee2d07, L:/172.31.7.191:3181 ! R:/172.31.7.191:55038]
11:49:44.833 [bookie-io-1-19] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x50f803f2, L:/172.31.7.191:3181 ! R:/172.31.7.191:54988]
11:49:44.834 [bookie-io-1-21] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x659cf280, L:/172.31.7.191:3181 ! R:/172.31.7.191:54994]
11:49:44.834 [bookie-io-1-30] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x03ecc87c, L:/172.31.7.191:3181 ! R:/172.31.7.191:55048]
11:49:44.834 [bookie-io-1-28] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xe387ccee, L:/172.31.7.191:3181 ! R:/172.31.7.191:55044]
11:49:44.834 [bookie-io-1-26] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x24e05e98, L:/172.31.7.191:3181 ! R:/172.31.7.191:55040]
11:49:44.835 [bookie-io-1-1] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xd25f321b, L:/172.31.7.191:3181 ! R:/172.31.7.191:55066]
11:49:44.836 [bookie-io-1-20] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x49d1f629, L:/172.31.7.191:3181 ! R:/172.31.7.191:55026]
11:49:44.836 [bookie-io-1-29] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x1a791ecf, L:/172.31.7.191:3181 ! R:/172.31.7.191:55050]
11:49:44.837 [bookie-io-1-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x5462c566, L:/172.31.7.191:3181 ! R:/172.31.7.191:55070]
11:49:44.837 [bookie-io-1-32] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xa4da9be8, L:/172.31.7.191:3181 ! R:/172.31.7.191:55058]
11:49:44.837 [bookie-io-1-31] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xf311c875, L:/172.31.7.191:3181 ! R:/172.31.7.191:55054]
11:49:44.837 [bookie-io-1-22] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x5cc5b215, L:/172.31.7.191:3181 ! R:/172.31.7.191:54992]
11:50:00.732 [component-shutdown-thread] INFO  org.apache.bookkeeper.common.component.ComponentStarter - Closing component bookie-server in shutdown hook.
11:50:00.733 [component-shutdown-thread] INFO  org.apache.bookkeeper.replication.AutoRecoveryMain - Shutting down auto recovery: 0
11:50:00.733 [component-shutdown-thread] INFO  org.apache.bookkeeper.replication.AutoRecoveryMain - Shutting down AutoRecovery
11:50:00.733 [component-shutdown-thread] INFO  org.apache.bookkeeper.replication.Auditor - Shutting down auditor
11:50:00.733 [AuditorElector-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.AuditorElector - Shutting down AuditorElector
11:50:00.733 [component-shutdown-thread] INFO  org.apache.bookkeeper.replication.ReplicationWorker - Shutting down replication worker
11:50:00.734 [component-shutdown-thread] INFO  org.apache.bookkeeper.replication.ReplicationWorker - Shutting down ReplicationWorker
11:50:00.734 [ReplicationWorker] ERROR org.apache.bookkeeper.replication.ReplicationWorker - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:611) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:998) ~[?:1.8.0_265]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1304) ~[?:1.8.0_265]
	at java.util.concurrent.CountDownLatch.await(CountDownLatch.java:231) ~[?:1.8.0_265]
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:606) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	... 4 more
11:50:00.737 [ReplicationWorker] INFO  org.apache.bookkeeper.replication.ReplicationWorker - ReplicationWorker exited loop!
11:50:00.844 [component-shutdown-thread] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100019f79e70007 closed
11:50:00.844 [main-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100019f79e70007
11:50:00.844 [component-shutdown-thread] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
11:50:00.844 [component-shutdown-thread] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
11:50:00.851 [component-shutdown-thread] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-3181 with exitCode 0
11:50:00.851 [component-shutdown-thread] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
11:50:00.851 [component-shutdown-thread] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
11:50:00.858 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1601376358628 , logFileOffset - 870731776]}.
11:50:00.860 [component-shutdown-thread] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
11:50:00.860 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
11:50:00.860 [BookieJournal-3181] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
11:50:00.861 [BookieJournal-3181] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
11:50:00.862 [component-shutdown-thread] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
11:50:00.862 [Bookie-3181] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
11:50:00.868 [component-shutdown-thread] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
11:50:00.868 [component-shutdown-thread] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
11:50:00.869 [component-shutdown-thread] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
11:50:00.908 [component-shutdown-thread] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
11:50:01.010 [component-shutdown-thread] INFO  org.apache.zookeeper.11:52:20.268 [main] INFO  org.apache.bookkeeper.server.Main - Using configuration file /home/ubuntu/app/apache-pulsar-2.6.0/conf/bookkeeper.conf
11:52:20.273 [main] INFO  org.apache.bookkeeper.server.Main - Hello, I'm your bookie, listening on port 3181. Metadata service uri is zk+null://172.31.7.191:2181;172.31.15.110:2181/ledgers. Journals are in [data/bookkeeper/journal]. Ledgers are stored in data/bookkeeper/ledgers.
11:52:20.284 [main] INFO  org.apache.bookkeeper.server.Main - Load lifecycle component : org.apache.bookkeeper.server.service.StatsProviderService
11:52:20.297 [main] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "readBufferSizeBytes" : "4096",
  "statsProviderClass" : "org.apache.bookkeeper.stats.prometheus.PrometheusMetricsProvider",
  "majorCompactionThreshold" : "0.5",
  "numJournalCallbackThreads" : "8",
  "httpServerPort" : "8000",
  "lostBookieRecoveryDelay" : "0",
  "journalAlignmentSize" : "4096",
  "compactionRateByBytes" : "1000000",
  "httpServerClass" : "org.apache.bookkeeper.http.vertx.VertxHttpServer",
  "dbStorage_rocksDB_numFilesInLevel0" : "4",
  "minUsableSizeForIndexFileCreation" : "1073741824",
  "gcOverreplicatedLedgerWaitTime" : "86400000",
  "journalMaxGroupWaitMSec" : "1",
  "dbStorage_rocksDB_numLevels" : "-1",
  "dbStorage_rocksDB_bloomFilterBitsPerKey" : "10",
  "nettyMaxFrameSizeBytes" : "5253120",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage",
  "auditorPeriodicBookieCheckInterval" : "86400",
  "gcWaitTime" : "900000",
  "compactionRate" : "1000",
  "fileInfoFormatVersionToWrite" : "0",
  "entryLogFilePreallocationEnabled" : "true",
  "journalSyncData" : "true",
  "zkServers" : "[172.31.7.191:2181, 172.31.15.110:2181]",
  "compactionRateByEntries" : "1000",
  "dbStorage_rocksDB_maxSizeInLevel1MB" : "256",
  "diskCheckInterval" : "10000",
  "auditorPeriodicCheckInterval" : "604800",
  "dbStorage_rocksDB_writeBufferSizeMB" : "64",
  "autoRecoveryDaemonEnabled" : "true",
  "maxPendingAddRequestsPerThread" : "10000",
  "flushEntrylogBytes" : "268435456",
  "majorCompactionInterval" : "86400",
  "httpServerEnabled" : "false",
  "flushInterval" : "60000",
  "journalFlushWhenQueueEmpty" : "false",
  "minorCompactionInterval" : "3600",
  "dbStorage_rocksDB_blockCacheSize" : "",
  "isThrottleByBytes" : "false",
  "numAddWorkerThreads" : "0",
  "dbStorage_rocksDB_sstSizeInMB" : "64",
  "journalDirectory" : "data/bookkeeper/journal",
  "journalWriteBufferSizeKB" : "64",
  "diskUsageThreshold" : "0.95",
  "openFileLimit" : "0",
  "prometheusStatsHttpPort" : "8100",
  "zkLedgersRootPath" : "/ledgers",
  "journalMaxSizeMB" : "2048",
  "journalAdaptiveGroupWrites" : "true",
  "openLedgerRereplicationGracePeriod" : "30",
  "ledgerDirectories" : "data/bookkeeper/ledgers",
  "zkTimeout" : "30000",
  "dbStorage_rocksDB_blockSize" : "65536",
  "journalMaxBackups" : "5",
  "maxPendingReadRequestsPerThread" : "2500",
  "useHostNameAsBookieID" : "false",
  "rereplicationEntryBatchSize" : "100",
  "allowLoopback" : "false",
  "readOnlyModeEnabled" : "true",
  "journalRemoveFromPageCache" : "true",
  "dbStorage_readAheadCacheMaxSizeMb" : "",
  "zkEnableSecurity" : "false",
  "numHighPriorityWorkerThreads" : "8",
  "dbStorage_readAheadCacheBatchSize" : "1000",
  "journalFormatVersionToWrite" : "5",
  "writeBufferSizeBytes" : "65536",
  "bookiePort" : "3181",
  "dbStorage_writeCacheMaxSizeMb" : "",
  "pageLimit" : "0",
  "logSizeLimit" : "1073741824",
  "advertisedAddress" : "172.31.7.191",
  "bookieDeathWatchInterval" : "1000",
  "numReadWorkerThreads" : "8",
  "minorCompactionThreshold" : "0.2",
  "serverTcpNoDelay" : "true",
  "journalBufferedWritesThreshold" : "524288",
  "compactionMaxOutstandingRequests" : "100000",
  "journalPreAllocSizeMB" : "16"
}
11:52:20.605 [main] INFO  org.apache.bookkeeper.meta.MetadataDrivers - BookKeeper metadata driver manager initialized
11:52:20.605 [main] INFO  org.apache.bookkeeper.meta.MetadataDrivers - BookKeeper metadata driver manager initialized
11:52:20.605 [main] INFO  org.apache.bookkeeper.meta.MetadataDrivers - BookKeeper metadata driver manager initialized
11:52:20.612 [main] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk+null://172.31.7.191:2181;172.31.15.110:2181/ledgers : zkServers = 172.31.7.191:2181,172.31.15.110:2181, ledgersRootPath = /ledgers.
11:52:20.617 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:zookeeper.version=3.5.7-f0fdd52973d373ffd9c86b81d99842dc2c7f660e, built on 02/10/2020 11:30 GMT
11:52:20.617 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:host.name=ip-172-31-7-191
11:52:20.617 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.version=1.8.0_265
11:52:20.617 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.vendor=Private Build
11:52:20.617 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.home=/usr/lib/jvm/java-8-openjdk-amd64/jre
11:52:20.617 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.class.path=/home/ubuntu/app/apache-pulsar-2.6.0/conf:::/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-http-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-auth-sasl-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.commons-commons-lang3-3.6.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-managed-ledger-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.dataformat-jackson-dataformat-yaml-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.commons-commons-collections4-4.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.slf4j-slf4j-api-1.7.25.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.commons-commons-compress-1.19.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-cpu-affinity-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_hotspot-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-client-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.api.grpc-proto-google-common-protos-1.12.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-xml-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.jaxrs-jackson-jaxrs-base-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.vertx-vertx-web-3.4.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-original-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.core-jackson-databind-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.slf4j-jul-to-slf4j-1.7.25.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.jsonwebtoken-jjwt-jackson-0.11.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_jetty-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.airlift-aircompressor-0.16.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-all-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.logging.log4j-log4j-slf4j-impl-2.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-io-commons-io-2.5.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-tools-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.distributedlog-distributedlog-common-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.auth-google-auth-library-credentials-0.9.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.distributedlog-distributedlog-core-4.10.0-tests.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-common-allocator-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.protobuf.nano-protobuf-javanano-3.0.0-alpha-5.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-common-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.checkerframework-checker-compat-qual-2.5.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.jsonwebtoken-jjwt-impl-0.11.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/log4j-log4j-1.2.17.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-circe-checksum-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-java-client-base-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.dropwizard.metrics-metrics-jvm-3.1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-logging-commons-logging-1.1.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-testclient-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.vertx-vertx-core-3.4.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-broker-auth-sasl-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.kubernetes-client-java-2.0.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.carrotsearch-hppc-0.7.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-proto-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.curator-curator-recipes-4.0.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_log4j2-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-broker-common-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-transaction-common-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.ext-jersey-entity-filtering-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-common-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.stats-bookkeeper-stats-api-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-api-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-proxy-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.media-jersey-media-json-jackson-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_common-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.aspectj-aspectjweaver-1.9.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-collections-commons-collections-3.2.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.logging.log4j-log4j-api-2.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-transaction-coordinator-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-http-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.opencensus-opencensus-api-0.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.httpcomponents-httpcore-4.4.9.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.aspectj-aspectjrt-1.9.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.containers-jersey-container-servlet-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.curator-curator-client-4.0.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.inject-javax.inject-1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.rocksdb-rocksdbjni-5.13.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-handler-proxy-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.errorprone-error_prone_annotations-2.1.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.jsonwebtoken-jjwt-api-0.11.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-zookeeper-utils-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.codehaus.mojo-animal-sniffer-annotations-1.14.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.module-jackson-module-jsonSchema-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.code.findbugs-jsr305-3.0.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-common-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-runtime-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-protobuf-shaded-2.1.0-incubating.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus.jmx-collector-0.12.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.logging.log4j-log4j-web-2.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/jakarta.activation-jakarta.activation-api-1.2.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.logging.log4j-log4j-core-2.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.github.ben-manes.caffeine-caffeine-2.6.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-broker-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.core-jersey-client-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-native-kqueue-4.1.48.Final-osx-x86_64.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.yaml-snakeyaml-1.24.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2-hk2-utils-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-continuation-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.distributedlog-distributedlog-core-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.protobuf-protobuf-java-3.5.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.stats-codahale-metrics-provider-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-servlets-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.asynchttpclient-async-http-client-2.12.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_httpserver-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-cli-commons-cli-1.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-security-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.curator-curator-framework-4.0.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-resolver-dns-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.inferred-freebuilder-1.14.9.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.slf4j-jcl-over-slf4j-1.7.25.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.hamcrest-hamcrest-core-1.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.core-jersey-common-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-java-client-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-core-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.yahoo.datasketches-memory-0.8.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.sun.activation-javax.activation-1.2.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.swagger-swagger-models-1.5.21.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-auth-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-websocket-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.dropwizard.metrics-metrics-core-3.1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-http2-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.core-jersey-server-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-statelib-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-testing-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-servlet-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.squareup.okhttp-okhttp-2.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-protobuf-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-api-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-context-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-javax-websocket-client-impl-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.avro-avro-protobuf-1.9.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-netty-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.javassist-javassist-3.25.0-GA.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/net.jcip-jcip-annotations-1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/net.jodah-typetools-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-servlet-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-common-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.j2objc-j2objc-annotations-1.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-api-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-admin-original-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.swagger-swagger-core-1.5.21.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.checkerframework-checker-qual-2.0.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.xml.bind-jaxb-api-2.3.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.core-jackson-core-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2.external-aopalliance-repackaged-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-api-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.servlet-javax.servlet-api-3.1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-common-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.distributedlog-distributedlog-protocol-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-messagecrypto-bc-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-tools-framework-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_servlet-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-worker-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.opencensus-opencensus-contrib-grpc-metrics-0.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.squareup.okio-okio-1.13.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2.external-javax.inject-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.inject-jersey-hk2-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.core-jackson-annotations-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.hdrhistogram-HdrHistogram-2.1.9.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.stats-prometheus-metrics-provider-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.media-jersey-media-multipart-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-api-examples-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-codec-commons-codec-1.10.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.ws.rs-javax.ws.rs-api-2.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2-osgi-resource-locator-1.0.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.asynchttpclient-async-http-client-netty-utils-2.12.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-resolver-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-buffer-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-metadata-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-secrets-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.jctools-jctools-core-2.1.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.kubernetes-client-java-api-2.0.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.code.gson-gson-2.8.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.yahoo.datasketches-sketches-core-0.8.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-proto-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.websocket-javax.websocket-client-api-1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-server-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.annotation-javax.annotation-api-1.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2-hk2-api-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.jaxrs-jackson-jaxrs-json-provider-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.http-vertx-http-server-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-util-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.media-jersey-media-jaxb-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.httpcomponents-httpclient-4.5.5.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-server-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.swagger-swagger-annotations-1.5.21.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.validation-validation-api-1.1.0.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.module-jackson-module-jaxb-annotations-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.http-http-server-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-client-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/joda-time-joda-time-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-server-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-tcnative-boringssl-static-2.0.30.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-io-core-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-configuration-commons-configuration-1.10.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.squareup.okhttp-logging-interceptor-2.7.5.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-native-unix-common-4.1.48.Final-linux-x86_64.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-dns-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.tests-stream-storage-tests-common-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_caffeine-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.typesafe.netty-netty-reactive-streams-2.0.4.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.containers-jersey-container-servlet-core-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-bouncy-castle-bc-shaded-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-discovery-service-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.yetus-audience-annotations-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-local-runner-original-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-utils-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-proto-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.beust-jcommander-1.48.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-instance-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.protobuf-protobuf-java-util-3.5.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.zookeeper-zookeeper-jute-3.5.7.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-protobuf-lite-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.vertx-vertx-auth-common-3.4.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.avro-avro-1.9.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-io-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-socks-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.jvnet.mimepull-mimepull-1.9.6.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-proxy-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2-hk2-locator-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/jakarta.xml.bind-jakarta.xml.bind-api-2.3.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.kubernetes-client-java-proto-2.0.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/net.java.dev.jna-jna-4.2.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-service-impl-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-okhttp-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.guava-guava-25.1-jre.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.squareup.okhttp-okhttp-ws-2.7.5.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-service-api-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.github.zafarkhaja-java-semver-0.9.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-native-epoll-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.dropwizard.metrics-metrics-graphite-3.1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-handler-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-protobuf-nano-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-lang-commons-lang-2.6.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.reactivestreams-reactive-streams-1.0.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-stub-1.18.0.jar:
11:52:20.619 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.library.path=/usr/java/packages/lib/amd64:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
11:52:20.619 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.io.tmpdir=/tmp
11:52:20.619 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.compiler=<NA>
11:52:20.619 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:os.name=Linux
11:52:20.619 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:os.arch=amd64
11:52:20.619 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:os.version=5.4.0-1025-aws
11:52:20.619 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:user.name=ubuntu
11:52:20.619 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:user.home=/home/ubuntu
11:52:20.619 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:user.dir=/home/ubuntu/app/apache-pulsar-2.6.0
11:52:20.619 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:os.memory.free=2001MB
11:52:20.619 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:os.memory.max=2048MB
11:52:20.619 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:os.memory.total=2048MB
11:52:20.623 [main] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=172.31.7.191:2181,172.31.15.110:2181 sessionTimeout=30000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@29e6eb25
11:52:20.627 [main] INFO  org.apache.zookeeper.common.X509Util - Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation
11:52:20.632 [main] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 10485760 Bytes
11:52:20.638 [main] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=
11:52:20.646 [main-SendThread(172.31.7.191:2181)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server ip-172-31-7-191/172.31.7.191:2181. Will not attempt to authenticate using SASL (unknown error)
11:52:20.651 [main-SendThread(172.31.7.191:2181)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /172.31.7.191:42424, server: ip-172-31-7-191/172.31.7.191:2181
11:52:20.657 [main-SendThread(172.31.7.191:2181)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server ip-172-31-7-191/172.31.7.191:2181, sessionid = 0x10001dc648e0008, negotiated timeout = 30000
11:52:20.660 [main-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
11:52:20.691 [main] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [data/bookkeeper/journal/current] [data/bookkeeper/ledgers/current]
11:52:20.759 [main] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
11:52:20.776 [main] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from data/bookkeeper/ledgers/current/lastMark (this is okay if it is the first time starting this bookie
11:52:20.777 [main] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage
11:52:20.778 [main] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Started Db Ledger Storage
11:52:20.779 [main] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage -  - Number of directories: 1
11:52:20.779 [main] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage -  - Write cache size: 512 MB
11:52:20.779 [main] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage -  - Read Cache: 512 MB
11:52:20.782 [main] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Creating single directory db ledger storage on data/bookkeeper/ledgers/current
11:52:20.909 [main] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
11:52:20.917 [main] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.2, interval=3600000
11:52:20.917 [main] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.5, interval=86400000
11:52:20.942 [main] INFO  org.apache.bookkeeper.server.Main - Load lifecycle component : org.apache.bookkeeper.server.service.BookieService
11:52:20.978 [main] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk+null://172.31.7.191:2181;172.31.15.110:2181/ledgers : zkServers = 172.31.7.191:2181,172.31.15.110:2181, ledgersRootPath = /ledgers.
11:52:20.978 [main] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=172.31.7.191:2181,172.31.15.110:2181 sessionTimeout=30000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@58cd06cb
11:52:20.978 [main] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 10485760 Bytes
11:52:20.978 [main] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=
11:52:20.979 [main-SendThread(172.31.7.191:2181)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server ip-172-31-7-191/172.31.7.191:2181. Will not attempt to authenticate using SASL (unknown error)
11:52:20.979 [main-SendThread(172.31.7.191:2181)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /172.31.7.191:42426, server: ip-172-31-7-191/172.31.7.191:2181
11:52:20.982 [main-SendThread(172.31.7.191:2181)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server ip-172-31-7-191/172.31.7.191:2181, sessionid = 0x10001dc648e0009, negotiated timeout = 30000
11:52:20.982 [main-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
11:52:21.004 [main] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
11:52:21.023 [main] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:172.31.7.191:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
11:52:21.023 [main] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
11:52:21.026 [main] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
11:52:21.086 [main] INFO  org.apache.bookkeeper.server.Main - Load lifecycle component : org.apache.bookkeeper.server.service.AutoRecoveryService
11:52:21.091 [main] INFO  org.apache.bookkeeper.common.component.ComponentStarter - Starting component bookie-server.
11:52:21.103 [main] INFO  org.eclipse.jetty.util.log - Logging initialized @1774ms to org.eclipse.jetty.util.log.Slf4jLog
11:52:21.180 [main] INFO  org.eclipse.jetty.server.Server - jetty-9.4.20.v20190813; built: 2019-08-13T21:28:18.144Z; git: 84700530e645e812b336747464d6fbbf370c9a20; jvm 1.8.0_265-8u265-b01-0ubuntu2~18.04-b01
11:52:21.211 [main] INFO  org.eclipse.jetty.server.handler.ContextHandler - Started o.e.j.s.ServletContextHandler@4ebadd3d{/,null,AVAILABLE}
11:52:21.222 [main] INFO  org.eclipse.jetty.server.AbstractConnector - Started ServerConnector@5300f14a{HTTP/1.1,[http/1.1]}{0.0.0.0:8100}
11:52:21.222 [main] INFO  org.eclipse.jetty.server.Server - Started @1894ms
11:52:21.222 [main] INFO  org.apache.bookkeeper.stats.prometheus.PrometheusMetricsProvider - Started Prometheus stats endpoint at 0.0.0.0:8100
11:52:21.231 [main] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 1 ms.
11:52:21.244 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
11:52:21.247 [main] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
11:52:21.248 [BookieJournal-3181] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on data/bookkeeper/journal/current
11:52:21.249 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
11:52:21.251 [BookieJournal-3181] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal data/bookkeeper/journal/current/174d9b4d602.txn
11:52:21.256 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/172.31.7.191:3181
11:52:21.506 [main] INFO  org.apache.bookkeeper.common.component.ComponentStarter - Started component bookie-server.
11:52:21.524 [AuditorElector-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - AuthProvider used by the Auditor is null
11:52:21.525 [AuditorElector-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Initializing lostBookieRecoveryDelay zNode to the conif value: 0
11:52:21.526 [AuditorElector-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - I'm starting as Auditor Bookie. ID: 172.31.7.191:3181
11:52:21.529 [AuditorElector-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
11:52:21.530 [AuditorElector-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
11:52:21.530 [AuditorElector-172.31.7.191:3181] WARN  org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager - checkAllLedgersCtimeZnode is not yet available
11:52:21.530 [AuditorElector-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: -1 durationSinceLastExecutionInSecs: -1 initialDelay: 0 interval: 604800
11:52:21.530 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Starting auditBookies
11:52:21.531 [AuditorElector-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Periodic placementPolicy check disabled
11:52:21.531 [AuditorElector-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Periodic replicas check disabled
11:52:21.546 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Completed auditBookies
11:52:21.547 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Starting checkAllLedgers
11:52:21.555 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk+null://172.31.7.191:2181;172.31.15.110:2181/ledgers : zkServers = 172.31.7.191:2181,172.31.15.110:2181, ledgersRootPath = /ledgers.
11:52:21.555 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=172.31.7.191:2181,172.31.15.110:2181 sessionTimeout=30000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@442f9b18
11:52:21.555 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 10485760 Bytes
11:52:21.555 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=
11:52:21.556 [AuditorBookie-172.31.7.191:3181-SendThread(172.31.15.110:2181)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server ip-172-31-15-110/172.31.15.110:2181. Will not attempt to authenticate using SASL (unknown error)
11:52:21.556 [AuditorBookie-172.31.7.191:3181-SendThread(172.31.15.110:2181)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /172.31.7.191:35756, server: ip-172-31-15-110/172.31.15.110:2181
11:52:21.558 [AuditorBookie-172.31.7.191:3181-SendThread(172.31.15.110:2181)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server ip-172-31-15-110/172.31.15.110:2181, sessionid = 0x20001dc54bc0001, negotiated timeout = 30000
11:52:21.558 [AuditorBookie-172.31.7.191:3181-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
11:52:21.601 [AuditorBookie-172.31.7.191:3181] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
11:52:21.601 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:172.31.7.191:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
11:52:21.601 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
11:52:21.601 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
11:52:21.604 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/172.31.7.191:3181
11:52:21.733 [AuditorBookie-172.31.7.191:3181-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x20001dc54bc0001
11:52:21.733 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x20001dc54bc0001 closed
11:52:21.733 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Completed checkAllLedgers in 185 milliSeconds
11:52:23.558 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/172.31.15.110:3181
11:52:36.141 [bookie-io-1-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:52:36.141 [bookie-io-1-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x2955ed05, L:/172.31.7.191:3181 - R:/172.31.7.191:55726]
11:52:36.300 [BookieHighPriorityThread-3181-OrderedExecutor-0-0] INFO  org.apache.bookkeeper.proto.ReadEntryProcessorV3 - Ledger fence request received for ledger: 0 from address: /172.31.7.191:55726
11:52:36.363 [bookie-io-1-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x2955ed05, L:/172.31.7.191:3181 ! R:/172.31.7.191:55726]
11:53:16.110 [bookie-io-1-5] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:16.110 [bookie-io-1-4] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:16.110 [bookie-io-1-3] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:16.111 [bookie-io-1-4] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x2021660f, L:/172.31.7.191:3181 - R:/172.31.7.191:55742]
11:53:16.111 [bookie-io-1-5] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x2a8b402a, L:/172.31.7.191:3181 - R:/172.31.7.191:55756]
11:53:16.111 [bookie-io-1-3] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xaae6b3c3, L:/172.31.7.191:3181 - R:/172.31.7.191:55740]
11:53:16.112 [bookie-io-1-6] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:16.112 [bookie-io-1-6] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x8e765081, L:/172.31.7.191:3181 - R:/172.31.7.191:55736]
11:53:16.112 [bookie-io-1-8] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:16.112 [bookie-io-1-7] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:16.113 [bookie-io-1-7] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xa56a9a78, L:/172.31.7.191:3181 - R:/172.31.7.191:55738]
11:53:16.113 [bookie-io-1-10] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:16.113 [bookie-io-1-9] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:16.113 [bookie-io-1-8] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x67fdc44e, L:/172.31.7.191:3181 - R:/172.31.7.191:55764]
11:53:16.113 [bookie-io-1-10] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x554bae01, L:/172.31.7.191:3181 - R:/172.31.7.191:55768]
11:53:16.113 [bookie-io-1-9] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x17042b3c, L:/172.31.7.191:3181 - R:/172.31.7.191:55766]
11:53:16.115 [bookie-io-1-11] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:16.115 [bookie-io-1-11] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xe124988e, L:/172.31.7.191:3181 - R:/172.31.7.191:55772]
11:53:16.116 [bookie-io-1-12] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:16.116 [bookie-io-1-12] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xdcb06273, L:/172.31.7.191:3181 - R:/172.31.7.191:55776]
11:53:16.118 [bookie-io-1-13] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:16.118 [bookie-io-1-13] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xe30772c8, L:/172.31.7.191:3181 - R:/172.31.7.191:55778]
11:53:16.118 [bookie-io-1-15] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:16.117 [bookie-io-1-14] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:16.118 [bookie-io-1-15] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xf8ef73be, L:/172.31.7.191:3181 - R:/172.31.7.191:55792]
11:53:16.118 [bookie-io-1-14] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x3a919c78, L:/172.31.7.191:3181 - R:/172.31.7.191:55780]
11:53:16.119 [bookie-io-1-17] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:16.119 [bookie-io-1-17] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xabc175ba, L:/172.31.7.191:3181 - R:/172.31.7.191:55804]
11:53:16.119 [bookie-io-1-16] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:16.119 [bookie-io-1-16] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x4e3d6023, L:/172.31.7.191:3181 - R:/172.31.7.191:55796]
11:53:16.120 [bookie-io-1-18] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:16.120 [bookie-io-1-18] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x0f9c5880, L:/172.31.7.191:3181 - R:/172.31.7.191:55806]
11:53:21.249 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
11:53:21.251 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/0.log for logId 0.
11:53:21.252 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/1.log for logId 1.
11:53:34.525 [bookie-io-1-19] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:34.525 [bookie-io-1-19] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x7062830f, L:/172.31.7.191:3181 - R:/172.31.15.110:59598]
11:53:34.526 [bookie-io-1-20] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:34.526 [bookie-io-1-20] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xb037c1dc, L:/172.31.7.191:3181 - R:/172.31.15.110:59604]
11:53:34.527 [bookie-io-1-21] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:34.527 [bookie-io-1-21] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x94f92329, L:/172.31.7.191:3181 - R:/172.31.15.110:59608]
11:53:34.528 [bookie-io-1-22] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:34.529 [bookie-io-1-22] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x4408efb9, L:/172.31.7.191:3181 - R:/172.31.15.110:59612]
11:53:34.529 [bookie-io-1-24] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:34.529 [bookie-io-1-23] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:34.529 [bookie-io-1-23] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x38313c34, L:/172.31.7.191:3181 - R:/172.31.15.110:59618]
11:53:34.535 [bookie-io-1-25] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:34.535 [bookie-io-1-24] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x3cb1fd69, L:/172.31.7.191:3181 - R:/172.31.15.110:59622]
11:53:34.538 [bookie-io-1-25] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x417f2b47, L:/172.31.7.191:3181 - R:/172.31.15.110:59628]
11:53:34.539 [bookie-io-1-26] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:34.539 [bookie-io-1-26] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xafd8b400, L:/172.31.7.191:3181 - R:/172.31.15.110:59632]
11:53:34.541 [bookie-io-1-27] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:34.541 [bookie-io-1-27] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xfe0172ad, L:/172.31.7.191:3181 - R:/172.31.15.110:59638]
11:53:34.548 [bookie-io-1-28] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:34.548 [bookie-io-1-28] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x5c4cfcd4, L:/172.31.7.191:3181 - R:/172.31.15.110:59640]
11:53:34.564 [bookie-io-1-31] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:34.564 [bookie-io-1-29] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:34.563 [bookie-io-1-30] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:34.564 [bookie-io-1-31] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x3e61f49a, L:/172.31.7.191:3181 - R:/172.31.15.110:59648]
11:53:34.564 [bookie-io-1-29] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x95ee766c, L:/172.31.7.191:3181 - R:/172.31.15.110:59642]
11:53:34.564 [bookie-io-1-30] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xb07efbce, L:/172.31.7.191:3181 - R:/172.31.15.110:59646]
11:53:34.565 [bookie-io-1-1] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:34.565 [bookie-io-1-1] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x24837823, L:/172.31.7.191:3181 - R:/172.31.15.110:59654]
11:53:34.565 [bookie-io-1-32] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:34.566 [bookie-io-1-32] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x6a13e059, L:/172.31.7.191:3181 - R:/172.31.15.110:59656]
11:53:34.567 [bookie-io-1-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
11:53:34.567 [bookie-io-1-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xb6036381, L:/172.31.7.191:3181 - R:/172.31.15.110:59660]
11:53:57.563 [bookie-io-1-10] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:54:00.974 [bookie-io-1-29] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:54:05.689 [bookie-io-1-32] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:54:11.344 [bookie-io-1-18] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:54:21.261 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
11:54:21.262 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 0 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=0, logFile=data/bookkeeper/ledgers/current/0.log, ledgerIdAssigned=-1}].
11:54:21.271 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/2.log for logId 2.
11:54:22.642 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 0 to disk.
11:57:45.575 [bookie-io-1-30] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:57:58.069 [bookie-io-1-5] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:58:00.962 [BookieJournal-3181] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal data/bookkeeper/journal/current/174d9b4d603.txn
11:58:01.021 [bookie-io-1-5] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:58:03.757 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
11:58:03.758 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 1 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=1, logFile=data/bookkeeper/ledgers/current/1.log, ledgerIdAssigned=-1}].
11:58:03.767 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/3.log for logId 3.
11:58:04.867 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 1 to disk.
11:58:13.656 [bookie-io-1-9] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:58:16.406 [bookie-io-1-8] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:58:23.919 [bookie-io-1-28] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:58:23.920 [bookie-io-1-24] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:58:27.133 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
11:58:27.134 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 2 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=2, logFile=data/bookkeeper/ledgers/current/2.log, ledgerIdAssigned=-1}].
11:58:27.135 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/4.log for logId 4.
11:58:27.319 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 2 to disk.
11:58:31.165 [bookie-io-1-8] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:58:35.179 [bookie-io-1-4] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:58:39.463 [bookie-io-1-6] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:58:42.587 [BookieJournal-3181] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal data/bookkeeper/journal/current/174d9b4d604.txn
11:58:42.758 [bookie-io-1-23] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:58:43.375 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
11:58:43.375 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 3 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=3, logFile=data/bookkeeper/ledgers/current/3.log, ledgerIdAssigned=-1}].
11:58:43.382 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/5.log for logId 5.
11:58:46.149 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 3 to disk.
11:58:49.094 [bookie-io-1-17] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:58:59.998 [bookie-io-1-4] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:59:02.887 [bookie-io-1-32] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:59:07.988 [bookie-io-1-16] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:59:08.567 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
11:59:08.567 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 4 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=4, logFile=data/bookkeeper/ledgers/current/4.log, ledgerIdAssigned=-1}].
11:59:08.574 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/6.log for logId 6.
11:59:10.788 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 4 to disk.
11:59:19.477 [bookie-io-1-30] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:59:24.831 [bookie-io-1-5] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:59:24.950 [BookieJournal-3181] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal data/bookkeeper/journal/current/174d9b4d605.txn
11:59:29.763 [bookie-io-1-19] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
11:59:32.022 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
11:59:32.022 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 5 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=5, logFile=data/bookkeeper/ledgers/current/5.log, ledgerIdAssigned=-1}].
11:59:32.023 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/7.log for logId 7.
11:59:33.343 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 5 to disk.
11:59:40.677 [bookie-io-1-24] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:07:21.249 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Extracting entry log meta from entryLogId: 0
12:07:21.251 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Extracting entry log meta from entryLogId: 1
12:07:21.252 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Extracting entry log meta from entryLogId: 2
12:07:21.252 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Extracting entry log meta from entryLogId: 3
12:07:21.253 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Extracting entry log meta from entryLogId: 4
12:07:21.253 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Extracting entry log meta from entryLogId: 5
12:07:21.325 [db-storage-cleanup-10-1] INFO  org.apache.bookkeeper.bookie.storage.ldb.EntryLocationIndex - Deleting indexes for ledgers: [0, 9, 139, 13, 17, 151, 26, 155, 27, 157, 160, 34, 35, 36, 38, 39, 40, 41, 42, 43, 431, 47, 433, 434, 436, 438, 440, 441, 58, 186, 444, 189, 190, 191, 448, 449, 450, 67, 68, 69, 71, 75, 77, 85, 86, 89, 90, 92, 93, 94, 224, 98, 100, 102, 235, 236, 108, 238, 239, 240, 113, 241, 242, 243, 115, 245, 120]
12:07:21.385 [db-storage-cleanup-10-1] INFO  org.apache.bookkeeper.bookie.storage.ldb.EntryLocationIndex - Deleted indexes for 47929 entries from 67 ledgers in 0.059 seconds
12:23:08.648 [bookie-io-1-17] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:23:12.752 [bookie-io-1-18] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:23:16.055 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
12:23:16.055 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 6 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=6, logFile=data/bookkeeper/ledgers/current/6.log, ledgerIdAssigned=-1}].
12:23:16.081 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/8.log for logId 8.
12:23:16.414 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 6 to disk.
12:23:16.512 [bookie-io-1-26] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:23:24.390 [bookie-io-1-32] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:23:29.126 [BookieJournal-3181] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal data/bookkeeper/journal/current/174d9b4d606.txn
12:23:29.288 [bookie-io-1-17] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:23:33.164 [bookie-io-1-3] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:23:33.186 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
12:23:33.187 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/9.log for logId 9.
12:23:33.186 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 7 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=7, logFile=data/bookkeeper/ledgers/current/7.log, ledgerIdAssigned=-1}].
12:23:35.353 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 7 to disk.
12:23:44.091 [bookie-io-1-26] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:23:50.044 [bookie-io-1-11] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:24:00.663 [bookie-io-1-6] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:24:03.089 [bookie-io-1-17] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:24:03.256 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
12:24:03.256 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 8 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=8, logFile=data/bookkeeper/ledgers/current/8.log, ledgerIdAssigned=-1}].
12:24:03.264 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/a.log for logId 10.
12:24:06.901 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 8 to disk.
12:24:07.543 [bookie-io-1-3] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:24:11.456 [bookie-io-1-25] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:24:12.570 [BookieJournal-3181] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal data/bookkeeper/journal/current/174d9b4d607.txn
12:24:16.442 [bookie-io-1-18] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:24:21.279 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
12:24:21.279 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 9 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=9, logFile=data/bookkeeper/ledgers/current/9.log, ledgerIdAssigned=-1}].
12:24:21.280 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/b.log for logId 11.
12:24:22.867 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 9 to disk.
12:33:41.606 [bookie-io-1-6] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x8e765081, L:/172.31.7.191:3181 ! R:/172.31.7.191:55736]
12:33:41.606 [bookie-io-1-7] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xa56a9a78, L:/172.31.7.191:3181 ! R:/172.31.7.191:55738]
12:33:41.606 [bookie-io-1-16] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x4e3d6023, L:/172.31.7.191:3181 ! R:/172.31.7.191:55796]
12:33:41.606 [bookie-io-1-3] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xaae6b3c3, L:/172.31.7.191:3181 ! R:/172.31.7.191:55740]
12:33:41.607 [bookie-io-1-8] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x67fdc44e, L:/172.31.7.191:3181 ! R:/172.31.7.191:55764]
12:33:41.607 [bookie-io-1-5] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x2a8b402a, L:/172.31.7.191:3181 ! R:/172.31.7.191:55756]
12:33:41.608 [bookie-io-1-4] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x2021660f, L:/172.31.7.191:3181 ! R:/172.31.7.191:55742]
12:33:41.608 [bookie-io-1-13] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xe30772c8, L:/172.31.7.191:3181 ! R:/172.31.7.191:55778]
12:33:41.608 [bookie-io-1-12] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xdcb06273, L:/172.31.7.191:3181 ! R:/172.31.7.191:55776]
12:33:41.608 [bookie-io-1-10] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x554bae01, L:/172.31.7.191:3181 ! R:/172.31.7.191:55768]
12:33:41.609 [bookie-io-1-14] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x3a919c78, L:/172.31.7.191:3181 ! R:/172.31.7.191:55780]
12:33:41.610 [bookie-io-1-9] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x17042b3c, L:/172.31.7.191:3181 ! R:/172.31.7.191:55766]
12:33:41.610 [bookie-io-1-15] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xf8ef73be, L:/172.31.7.191:3181 ! R:/172.31.7.191:55792]
12:33:41.611 [bookie-io-1-17] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xabc175ba, L:/172.31.7.191:3181 ! R:/172.31.7.191:55804]
12:33:41.611 [bookie-io-1-11] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xe124988e, L:/172.31.7.191:3181 ! R:/172.31.7.191:55772]
12:33:41.612 [bookie-io-1-18] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x0f9c5880, L:/172.31.7.191:3181 ! R:/172.31.7.191:55806]
12:33:42.247 [component-shutdown-thread] INFO  org.apache.bookkeeper.common.component.ComponentStarter - Closing component bookie-server in shutdown hook.
12:33:42.248 [component-shutdown-thread] INFO  org.apache.bookkeeper.replication.AutoRecoveryMain - Shutting down auto recovery: 0
12:33:42.248 [component-shutdown-thread] INFO  org.apache.bookkeeper.replication.AutoRecoveryMain - Shutting down AutoRecovery
12:33:42.249 [component-shutdown-thread] INFO  org.apache.bookkeeper.replication.Auditor - Shutting down auditor
12:33:42.249 [AuditorElector-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.AuditorElector - Shutting down AuditorElector
12:33:42.249 [component-shutdown-thread] INFO  org.apache.bookkeeper.replication.ReplicationWorker - Shutting down replication worker
12:33:42.249 [component-shutdown-thread] INFO  org.apache.bookkeeper.replication.ReplicationWorker - Shutting down ReplicationWorker
12:33:42.249 [ReplicationWorker] ERROR org.apache.bookkeeper.replication.ReplicationWorker - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:611) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:998) ~[?:1.8.0_265]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1304) ~[?:1.8.0_265]
	at java.util.concurrent.CountDownLatch.await(CountDownLatch.java:231) ~[?:1.8.0_265]
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:606) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	... 4 more
12:33:42.252 [ReplicationWorker] INFO  org.apache.bookkeeper.replication.ReplicationWorker - ReplicationWorker exited loop!
12:33:42.359 [component-shutdown-thread] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10001dc648e0009 closed
12:33:42.360 [main-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10001dc648e0009
12:33:42.360 [component-shutdown-thread] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
12:33:42.360 [component-shutdown-thread] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
12:33:42.361 [bookie-io-1-24] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x3cb1fd69, L:/172.31.7.191:3181 ! R:/172.31.15.110:59622]
12:33:42.362 [bookie-io-1-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xb6036381, L:/172.31.7.191:3181 ! R:/172.31.15.110:59660]
12:33:42.361 [bookie-io-1-20] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xb037c1dc, L:/172.31.7.191:3181 ! R:/172.31.15.110:59604]
12:33:42.362 [bookie-io-1-29] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x95ee766c, L:/172.31.7.191:3181 ! R:/172.31.15.110:59642]
12:33:42.362 [bookie-io-1-1] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x24837823, L:/172.31.7.191:3181 ! R:/172.31.15.110:59654]
12:33:42.362 [bookie-io-1-28] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x5c4cfcd4, L:/172.31.7.191:3181 ! R:/172.31.15.110:59640]
12:33:42.362 [bookie-io-1-26] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xafd8b400, L:/172.31.7.191:3181 ! R:/172.31.15.110:59632]
12:33:42.362 [bookie-io-1-23] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x38313c34, L:/172.31.7.191:3181 ! R:/172.31.15.110:59618]
12:33:42.361 [bookie-io-1-25] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x417f2b47, L:/172.31.7.191:3181 ! R:/172.31.15.110:59628]
12:33:42.362 [bookie-io-1-30] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xb07efbce, L:/172.31.7.191:3181 ! R:/172.31.15.110:59646]
12:33:42.362 [bookie-io-1-22] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x4408efb9, L:/172.31.7.191:3181 ! R:/172.31.15.110:59612]
12:33:42.363 [bookie-io-1-31] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x3e61f49a, L:/172.31.7.191:3181 ! R:/172.31.15.110:59648]
12:33:42.363 [bookie-io-1-19] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x7062830f, L:/172.31.7.191:3181 ! R:/172.31.15.110:59598]
12:33:42.363 [bookie-io-1-32] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x6a13e059, L:/172.31.7.191:3181 ! R:/172.31.15.110:59656]
12:33:42.363 [bookie-io-1-27] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xfe0172ad, L:/172.31.7.191:3181 ! R:/172.31.15.110:59638]
12:33:42.363 [bookie-io-1-21] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x94f92329, L:/172.31.7.191:3181 ! R:/172.31.15.110:59608]
12:33:42.372 [component-shutdown-thread] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-3181 with exitCode 0
12:33:42.373 [component-shutdown-thread] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
12:33:42.373 [component-shutdown-thread] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
12:33:42.379 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger st12:36:16.388 [main] INFO  org.apache.bookkeeper.server.Main - Using configuration file /home/ubuntu/app/apache-pulsar-2.6.0/conf/bookkeeper.conf
12:36:16.393 [main] INFO  org.apache.bookkeeper.server.Main - Hello, I'm your bookie, listening on port 3181. Metadata service uri is zk+null://172.31.7.191:2181;172.31.15.110:2181/ledgers. Journals are in [data/bookkeeper/journal]. Ledgers are stored in data/bookkeeper/ledgers.
12:36:16.405 [main] INFO  org.apache.bookkeeper.server.Main - Load lifecycle component : org.apache.bookkeeper.server.service.StatsProviderService
12:36:16.418 [main] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "readBufferSizeBytes" : "4096",
  "statsProviderClass" : "org.apache.bookkeeper.stats.prometheus.PrometheusMetricsProvider",
  "majorCompactionThreshold" : "0.5",
  "numJournalCallbackThreads" : "8",
  "httpServerPort" : "8000",
  "lostBookieRecoveryDelay" : "0",
  "journalAlignmentSize" : "4096",
  "compactionRateByBytes" : "1000000",
  "httpServerClass" : "org.apache.bookkeeper.http.vertx.VertxHttpServer",
  "dbStorage_rocksDB_numFilesInLevel0" : "4",
  "minUsableSizeForIndexFileCreation" : "1073741824",
  "gcOverreplicatedLedgerWaitTime" : "86400000",
  "journalMaxGroupWaitMSec" : "1",
  "dbStorage_rocksDB_numLevels" : "-1",
  "dbStorage_rocksDB_bloomFilterBitsPerKey" : "10",
  "nettyMaxFrameSizeBytes" : "5253120",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage",
  "auditorPeriodicBookieCheckInterval" : "86400",
  "gcWaitTime" : "900000",
  "compactionRate" : "1000",
  "fileInfoFormatVersionToWrite" : "0",
  "entryLogFilePreallocationEnabled" : "true",
  "journalSyncData" : "true",
  "zkServers" : "[172.31.7.191:2181, 172.31.15.110:2181]",
  "compactionRateByEntries" : "1000",
  "dbStorage_rocksDB_maxSizeInLevel1MB" : "256",
  "diskCheckInterval" : "10000",
  "auditorPeriodicCheckInterval" : "604800",
  "dbStorage_rocksDB_writeBufferSizeMB" : "64",
  "autoRecoveryDaemonEnabled" : "true",
  "maxPendingAddRequestsPerThread" : "10000",
  "flushEntrylogBytes" : "268435456",
  "majorCompactionInterval" : "86400",
  "httpServerEnabled" : "false",
  "flushInterval" : "60000",
  "journalFlushWhenQueueEmpty" : "false",
  "minorCompactionInterval" : "3600",
  "dbStorage_rocksDB_blockCacheSize" : "",
  "isThrottleByBytes" : "false",
  "numAddWorkerThreads" : "0",
  "dbStorage_rocksDB_sstSizeInMB" : "64",
  "journalDirectory" : "data/bookkeeper/journal",
  "journalWriteBufferSizeKB" : "64",
  "diskUsageThreshold" : "0.95",
  "openFileLimit" : "0",
  "prometheusStatsHttpPort" : "8100",
  "zkLedgersRootPath" : "/ledgers",
  "journalMaxSizeMB" : "2048",
  "journalAdaptiveGroupWrites" : "true",
  "openLedgerRereplicationGracePeriod" : "30",
  "ledgerDirectories" : "data/bookkeeper/ledgers",
  "zkTimeout" : "30000",
  "dbStorage_rocksDB_blockSize" : "65536",
  "journalMaxBackups" : "5",
  "maxPendingReadRequestsPerThread" : "2500",
  "useHostNameAsBookieID" : "false",
  "rereplicationEntryBatchSize" : "100",
  "allowLoopback" : "false",
  "readOnlyModeEnabled" : "true",
  "journalRemoveFromPageCache" : "true",
  "dbStorage_readAheadCacheMaxSizeMb" : "",
  "zkEnableSecurity" : "false",
  "numHighPriorityWorkerThreads" : "8",
  "dbStorage_readAheadCacheBatchSize" : "1000",
  "journalFormatVersionToWrite" : "5",
  "writeBufferSizeBytes" : "65536",
  "bookiePort" : "3181",
  "dbStorage_writeCacheMaxSizeMb" : "",
  "pageLimit" : "0",
  "logSizeLimit" : "1073741824",
  "advertisedAddress" : "172.31.7.191",
  "bookieDeathWatchInterval" : "1000",
  "numReadWorkerThreads" : "8",
  "minorCompactionThreshold" : "0.2",
  "serverTcpNoDelay" : "true",
  "journalBufferedWritesThreshold" : "524288",
  "compactionMaxOutstandingRequests" : "100000",
  "journalPreAllocSizeMB" : "16"
}
12:36:16.755 [main] INFO  org.apache.bookkeeper.meta.MetadataDrivers - BookKeeper metadata driver manager initialized
12:36:16.755 [main] INFO  org.apache.bookkeeper.meta.MetadataDrivers - BookKeeper metadata driver manager initialized
12:36:16.755 [main] INFO  org.apache.bookkeeper.meta.MetadataDrivers - BookKeeper metadata driver manager initialized
12:36:16.762 [main] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk+null://172.31.7.191:2181;172.31.15.110:2181/ledgers : zkServers = 172.31.7.191:2181,172.31.15.110:2181, ledgersRootPath = /ledgers.
12:36:16.766 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:zookeeper.version=3.5.7-f0fdd52973d373ffd9c86b81d99842dc2c7f660e, built on 02/10/2020 11:30 GMT
12:36:16.766 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:host.name=ip-172-31-7-191
12:36:16.766 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.version=1.8.0_265
12:36:16.766 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.vendor=Private Build
12:36:16.766 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.home=/usr/lib/jvm/java-8-openjdk-amd64/jre
12:36:16.767 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.class.path=/home/ubuntu/app/apache-pulsar-2.6.0/conf:::/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-http-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-auth-sasl-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.commons-commons-lang3-3.6.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-managed-ledger-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.dataformat-jackson-dataformat-yaml-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.commons-commons-collections4-4.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.slf4j-slf4j-api-1.7.25.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.commons-commons-compress-1.19.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-cpu-affinity-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_hotspot-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-client-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.api.grpc-proto-google-common-protos-1.12.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-xml-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.jaxrs-jackson-jaxrs-base-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.vertx-vertx-web-3.4.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-original-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.core-jackson-databind-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.slf4j-jul-to-slf4j-1.7.25.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.jsonwebtoken-jjwt-jackson-0.11.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_jetty-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.airlift-aircompressor-0.16.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-all-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.logging.log4j-log4j-slf4j-impl-2.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-io-commons-io-2.5.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-tools-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.distributedlog-distributedlog-common-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.auth-google-auth-library-credentials-0.9.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.distributedlog-distributedlog-core-4.10.0-tests.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-common-allocator-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.protobuf.nano-protobuf-javanano-3.0.0-alpha-5.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-common-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.checkerframework-checker-compat-qual-2.5.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.jsonwebtoken-jjwt-impl-0.11.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/log4j-log4j-1.2.17.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-circe-checksum-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-java-client-base-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.dropwizard.metrics-metrics-jvm-3.1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-logging-commons-logging-1.1.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-testclient-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.vertx-vertx-core-3.4.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-broker-auth-sasl-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.kubernetes-client-java-2.0.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.carrotsearch-hppc-0.7.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-proto-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.curator-curator-recipes-4.0.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_log4j2-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-broker-common-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-transaction-common-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.ext-jersey-entity-filtering-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-common-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.stats-bookkeeper-stats-api-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-api-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-proxy-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.media-jersey-media-json-jackson-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_common-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.aspectj-aspectjweaver-1.9.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-collections-commons-collections-3.2.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.logging.log4j-log4j-api-2.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-transaction-coordinator-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-http-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.opencensus-opencensus-api-0.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.httpcomponents-httpcore-4.4.9.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.aspectj-aspectjrt-1.9.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.containers-jersey-container-servlet-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.curator-curator-client-4.0.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.inject-javax.inject-1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.rocksdb-rocksdbjni-5.13.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-handler-proxy-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.errorprone-error_prone_annotations-2.1.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.jsonwebtoken-jjwt-api-0.11.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-zookeeper-utils-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.codehaus.mojo-animal-sniffer-annotations-1.14.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.module-jackson-module-jsonSchema-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.code.findbugs-jsr305-3.0.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-common-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-runtime-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-protobuf-shaded-2.1.0-incubating.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus.jmx-collector-0.12.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.logging.log4j-log4j-web-2.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/jakarta.activation-jakarta.activation-api-1.2.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.logging.log4j-log4j-core-2.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.github.ben-manes.caffeine-caffeine-2.6.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-broker-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.core-jersey-client-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-native-kqueue-4.1.48.Final-osx-x86_64.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.yaml-snakeyaml-1.24.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2-hk2-utils-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-continuation-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.distributedlog-distributedlog-core-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.protobuf-protobuf-java-3.5.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.stats-codahale-metrics-provider-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-servlets-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.asynchttpclient-async-http-client-2.12.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_httpserver-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-cli-commons-cli-1.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-security-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.curator-curator-framework-4.0.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-resolver-dns-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.inferred-freebuilder-1.14.9.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.slf4j-jcl-over-slf4j-1.7.25.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.hamcrest-hamcrest-core-1.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.core-jersey-common-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-java-client-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-core-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.yahoo.datasketches-memory-0.8.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.sun.activation-javax.activation-1.2.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.swagger-swagger-models-1.5.21.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-auth-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-websocket-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.dropwizard.metrics-metrics-core-3.1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-http2-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.core-jersey-server-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-statelib-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-testing-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-servlet-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.squareup.okhttp-okhttp-2.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-protobuf-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-api-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-context-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-javax-websocket-client-impl-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.avro-avro-protobuf-1.9.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-netty-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.javassist-javassist-3.25.0-GA.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/net.jcip-jcip-annotations-1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/net.jodah-typetools-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-servlet-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-common-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.j2objc-j2objc-annotations-1.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-api-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-admin-original-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.swagger-swagger-core-1.5.21.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.checkerframework-checker-qual-2.0.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.xml.bind-jaxb-api-2.3.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.core-jackson-core-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2.external-aopalliance-repackaged-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-api-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.servlet-javax.servlet-api-3.1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-common-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.distributedlog-distributedlog-protocol-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-messagecrypto-bc-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-tools-framework-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_servlet-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-worker-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.opencensus-opencensus-contrib-grpc-metrics-0.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.squareup.okio-okio-1.13.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2.external-javax.inject-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.inject-jersey-hk2-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.core-jackson-annotations-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.hdrhistogram-HdrHistogram-2.1.9.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.stats-prometheus-metrics-provider-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.media-jersey-media-multipart-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-api-examples-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-codec-commons-codec-1.10.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.ws.rs-javax.ws.rs-api-2.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2-osgi-resource-locator-1.0.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.asynchttpclient-async-http-client-netty-utils-2.12.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-resolver-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-buffer-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-metadata-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-secrets-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.jctools-jctools-core-2.1.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.kubernetes-client-java-api-2.0.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.code.gson-gson-2.8.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.yahoo.datasketches-sketches-core-0.8.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-proto-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.websocket-javax.websocket-client-api-1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-server-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.annotation-javax.annotation-api-1.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2-hk2-api-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.jaxrs-jackson-jaxrs-json-provider-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.http-vertx-http-server-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-util-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.media-jersey-media-jaxb-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.httpcomponents-httpclient-4.5.5.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-server-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.swagger-swagger-annotations-1.5.21.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.validation-validation-api-1.1.0.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.module-jackson-module-jaxb-annotations-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.http-http-server-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-client-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/joda-time-joda-time-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-server-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-tcnative-boringssl-static-2.0.30.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-io-core-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-configuration-commons-configuration-1.10.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.squareup.okhttp-logging-interceptor-2.7.5.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-native-unix-common-4.1.48.Final-linux-x86_64.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-dns-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.tests-stream-storage-tests-common-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_caffeine-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.typesafe.netty-netty-reactive-streams-2.0.4.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.containers-jersey-container-servlet-core-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-bouncy-castle-bc-shaded-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-discovery-service-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.yetus-audience-annotations-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-local-runner-original-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-utils-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-proto-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.beust-jcommander-1.48.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-instance-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.protobuf-protobuf-java-util-3.5.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.zookeeper-zookeeper-jute-3.5.7.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-protobuf-lite-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.vertx-vertx-auth-common-3.4.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.avro-avro-1.9.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-io-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-socks-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.jvnet.mimepull-mimepull-1.9.6.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-proxy-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2-hk2-locator-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/jakarta.xml.bind-jakarta.xml.bind-api-2.3.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.kubernetes-client-java-proto-2.0.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/net.java.dev.jna-jna-4.2.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-service-impl-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-okhttp-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.guava-guava-25.1-jre.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.squareup.okhttp-okhttp-ws-2.7.5.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-service-api-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.github.zafarkhaja-java-semver-0.9.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-native-epoll-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.dropwizard.metrics-metrics-graphite-3.1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-handler-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-protobuf-nano-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-lang-commons-lang-2.6.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.reactivestreams-reactive-streams-1.0.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-stub-1.18.0.jar:
12:36:16.768 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.library.path=/usr/java/packages/lib/amd64:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
12:36:16.768 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.io.tmpdir=/tmp
12:36:16.768 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.compiler=<NA>
12:36:16.768 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:os.name=Linux
12:36:16.768 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:os.arch=amd64
12:36:16.768 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:os.version=5.4.0-1025-aws
12:36:16.768 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:user.name=ubuntu
12:36:16.768 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:user.home=/home/ubuntu
12:36:16.768 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:user.dir=/home/ubuntu/app/apache-pulsar-2.6.0
12:36:16.768 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:os.memory.free=2000MB
12:36:16.768 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:os.memory.max=2048MB
12:36:16.768 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:os.memory.total=2048MB
12:36:16.772 [main] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=172.31.7.191:2181,172.31.15.110:2181 sessionTimeout=30000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@29e6eb25
12:36:16.775 [main] INFO  org.apache.zookeeper.common.X509Util - Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation
12:36:16.780 [main] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 10485760 Bytes
12:36:16.785 [main] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=
12:36:16.791 [main-SendThread(172.31.15.110:2181)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server ip-172-31-15-110/172.31.15.110:2181. Will not attempt to authenticate using SASL (unknown error)
12:36:16.794 [main-SendThread(172.31.15.110:2181)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /172.31.7.191:36124, server: ip-172-31-15-110/172.31.15.110:2181
12:36:16.800 [main-SendThread(172.31.15.110:2181)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server ip-172-31-15-110/172.31.15.110:2181, sessionid = 0x2000204f3a00003, negotiated timeout = 30000
12:36:16.803 [main-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
12:36:16.830 [main] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [data/bookkeeper/journal/current] [data/bookkeeper/ledgers/current]
12:36:16.894 [main] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
12:36:16.909 [main] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from data/bookkeeper/ledgers/current/lastMark (this is okay if it is the first time starting this bookie
12:36:16.910 [main] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage
12:36:16.911 [main] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Started Db Ledger Storage
12:36:16.911 [main] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage -  - Number of directories: 1
12:36:16.911 [main] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage -  - Write cache size: 512 MB
12:36:16.911 [main] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage -  - Read Cache: 512 MB
12:36:16.914 [main] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Creating single directory db ledger storage on data/bookkeeper/ledgers/current
12:36:17.037 [main] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
12:36:17.044 [main] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.2, interval=3600000
12:36:17.044 [main] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.5, interval=86400000
12:36:17.067 [main] INFO  org.apache.bookkeeper.server.Main - Load lifecycle component : org.apache.bookkeeper.server.service.BookieService
12:36:17.098 [main] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk+null://172.31.7.191:2181;172.31.15.110:2181/ledgers : zkServers = 172.31.7.191:2181,172.31.15.110:2181, ledgersRootPath = /ledgers.
12:36:17.098 [main] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=172.31.7.191:2181,172.31.15.110:2181 sessionTimeout=30000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@58cd06cb
12:36:17.098 [main] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 10485760 Bytes
12:36:17.098 [main] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=
12:36:17.099 [main-SendThread(172.31.15.110:2181)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server ip-172-31-15-110/172.31.15.110:2181. Will not attempt to authenticate using SASL (unknown error)
12:36:17.099 [main-SendThread(172.31.15.110:2181)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /172.31.7.191:36126, server: ip-172-31-15-110/172.31.15.110:2181
12:36:17.101 [main-SendThread(172.31.15.110:2181)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server ip-172-31-15-110/172.31.15.110:2181, sessionid = 0x2000204f3a00004, negotiated timeout = 30000
12:36:17.101 [main-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
12:36:17.121 [main] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
12:36:17.139 [main] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:172.31.7.191:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
12:36:17.139 [main] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
12:36:17.142 [main] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
12:36:17.158 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/172.31.15.110:3181
12:36:17.189 [main] INFO  org.apache.bookkeeper.server.Main - Load lifecycle component : org.apache.bookkeeper.server.service.AutoRecoveryService
12:36:17.194 [main] INFO  org.apache.bookkeeper.common.component.ComponentStarter - Starting component bookie-server.
12:36:17.206 [main] INFO  org.eclipse.jetty.util.log - Logging initialized @1806ms to org.eclipse.jetty.util.log.Slf4jLog
12:36:17.281 [main] INFO  org.eclipse.jetty.server.Server - jetty-9.4.20.v20190813; built: 2019-08-13T21:28:18.144Z; git: 84700530e645e812b336747464d6fbbf370c9a20; jvm 1.8.0_265-8u265-b01-0ubuntu2~18.04-b01
12:36:17.312 [main] INFO  org.eclipse.jetty.server.handler.ContextHandler - Started o.e.j.s.ServletContextHandler@4ebadd3d{/,null,AVAILABLE}
12:36:17.323 [main] INFO  org.eclipse.jetty.server.AbstractConnector - Started ServerConnector@5300f14a{HTTP/1.1,[http/1.1]}{0.0.0.0:8100}
12:36:17.323 [main] INFO  org.eclipse.jetty.server.Server - Started @1923ms
12:36:17.323 [main] INFO  org.apache.bookkeeper.stats.prometheus.PrometheusMetricsProvider - Started Prometheus stats endpoint at 0.0.0.0:8100
12:36:17.331 [main] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 1 ms.
12:36:17.345 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
12:36:17.348 [main] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
12:36:17.349 [BookieJournal-3181] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on data/bookkeeper/journal/current
12:36:17.349 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
12:36:17.352 [BookieJournal-3181] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal data/bookkeeper/journal/current/174d9dd0f46.txn
12:36:17.354 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/172.31.7.191:3181
12:36:17.606 [main] INFO  org.apache.bookkeeper.common.component.ComponentStarter - Started component bookie-server.
12:36:29.435 [component-shutdown-thread] INFO  org.apache.bookkeeper.common.component.ComponentStarter - Closing component bookie-server in shutdown hook.
12:36:29.436 [component-shutdown-thread] INFO  org.apache.bookkeeper.replication.AutoRecoveryMain - Shutting down auto recovery: 0
12:36:29.436 [component-shutdown-thread] INFO  org.apache.bookkeeper.replication.AutoRecoveryMain - Shutting down AutoRecovery
12:36:29.436 [component-shutdown-thread] INFO  org.apache.bookkeeper.replication.ReplicationWorker - Shutting down replication worker
12:36:29.436 [AuditorElector-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.AuditorElector - Shutting down AuditorElector
12:36:29.436 [component-shutdown-thread] INFO  org.apache.bookkeeper.replication.ReplicationWorker - Shutting down ReplicationWorker
12:36:29.437 [ReplicationWorker] ERROR org.apache.bookkeeper.replication.ReplicationWorker - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:611) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:998) ~[?:1.8.0_265]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1304) ~[?:1.8.0_265]
	at java.util.concurrent.CountDownLatch.await(CountDownLatch.java:231) ~[?:1.8.0_265]
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:606) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	... 4 more
12:36:29.440 [ReplicationWorker] INFO  org.apache.bookkeeper.replication.ReplicationWorker - ReplicationWorker exited loop!
12:36:29.558 [main-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x2000204f3a00004
12:36:29.558 [component-shutdown-thread] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x2000204f3a00004 closed
12:36:29.559 [component-shutdown-thread] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
12:36:29.559 [component-shutdown-thread] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
12:36:29.572 [component-shutdown-thread] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-3181 with exitCode 0
12:36:29.572 [component-shutdown-thread] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
12:36:29.572 [component-shutdown-thread] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
12:36:29.579 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
12:36:29.581 [component-shutdown-thread] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
12:36:29.581 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
12:36:29.581 [BookieJournal-3181] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
12:36:29.583 [BookieJournal-3181] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
12:36:29.583 [component-shutdown-thread] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
12:36:29.583 [Bookie-3181] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
12:36:29.589 [component-shutdown-thread] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
12:36:29.589 [component-shutdown-thread] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
12:36:29.589 [component-shutdown-thread] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
12:36:29.590 [component-shutdown-thread] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
12:36:29.607 [AutoRecoveryDeathWatcher-3181] INFO  org.apache.bookkeeper.replication.AutoRecoveryMain - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
12:36:29.608 [AutoRecoveryDeathWatcher-3181] ERROR org.apache.bookkeeper.common.component.ComponentStarter - Triggered exceptionHandler of Component: bookie-server because of Exception in Thread: Thread[AutoRecoveryDeathWatcher-3181,5,main]
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
12:36:29.693 [main-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x2000204f3a00003
12:36:29.693 [component-shutdown-thread] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x2000204f3a00003 closed
12:36:29.698 [component-shutdown-thread] INFO  org.eclipse.jetty.server.AbstractConnector - Stopped ServerConnector@5300f14a{HTTP/1.1,[http/1.1]}{0.0.0.0:8100}
12:36:29.699 [component-shutdown-thread] INFO  org.eclipse.jetty.server.handler.ContextHandler - Stopped o.e.j.s.ServletContextHandler@4ebadd3d{/,null,UNAVAILABLE}
12:36:29.700 [component-shutdown-thread] INFO12:39:25.178 [main] INFO  org.apache.bookkeeper.server.Main - Using configuration file /home/ubuntu/app/apache-pulsar-2.6.0/conf/bookkeeper.conf
12:39:25.183 [main] INFO  org.apache.bookkeeper.server.Main - Hello, I'm your bookie, listening on port 3181. Metadata service uri is zk+null://172.31.7.191:2181;172.31.15.110:2181/ledgers. Journals are in [data/bookkeeper/journal]. Ledgers are stored in data/bookkeeper/ledgers.
12:39:25.196 [main] INFO  org.apache.bookkeeper.server.Main - Load lifecycle component : org.apache.bookkeeper.server.service.StatsProviderService
12:39:25.209 [main] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "readBufferSizeBytes" : "4096",
  "statsProviderClass" : "org.apache.bookkeeper.stats.prometheus.PrometheusMetricsProvider",
  "majorCompactionThreshold" : "0.5",
  "numJournalCallbackThreads" : "8",
  "httpServerPort" : "8000",
  "lostBookieRecoveryDelay" : "0",
  "journalAlignmentSize" : "4096",
  "compactionRateByBytes" : "1000000",
  "httpServerClass" : "org.apache.bookkeeper.http.vertx.VertxHttpServer",
  "dbStorage_rocksDB_numFilesInLevel0" : "4",
  "minUsableSizeForIndexFileCreation" : "1073741824",
  "gcOverreplicatedLedgerWaitTime" : "86400000",
  "journalMaxGroupWaitMSec" : "1",
  "dbStorage_rocksDB_numLevels" : "-1",
  "dbStorage_rocksDB_bloomFilterBitsPerKey" : "10",
  "nettyMaxFrameSizeBytes" : "5253120",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage",
  "auditorPeriodicBookieCheckInterval" : "86400",
  "gcWaitTime" : "900000",
  "compactionRate" : "1000",
  "fileInfoFormatVersionToWrite" : "0",
  "entryLogFilePreallocationEnabled" : "true",
  "journalSyncData" : "true",
  "zkServers" : "[172.31.7.191:2181, 172.31.15.110:2181]",
  "compactionRateByEntries" : "1000",
  "dbStorage_rocksDB_maxSizeInLevel1MB" : "256",
  "diskCheckInterval" : "10000",
  "auditorPeriodicCheckInterval" : "604800",
  "dbStorage_rocksDB_writeBufferSizeMB" : "64",
  "autoRecoveryDaemonEnabled" : "true",
  "maxPendingAddRequestsPerThread" : "10000",
  "flushEntrylogBytes" : "268435456",
  "majorCompactionInterval" : "86400",
  "httpServerEnabled" : "false",
  "flushInterval" : "60000",
  "journalFlushWhenQueueEmpty" : "false",
  "minorCompactionInterval" : "3600",
  "dbStorage_rocksDB_blockCacheSize" : "",
  "isThrottleByBytes" : "false",
  "numAddWorkerThreads" : "0",
  "dbStorage_rocksDB_sstSizeInMB" : "64",
  "journalDirectory" : "data/bookkeeper/journal",
  "journalWriteBufferSizeKB" : "64",
  "diskUsageThreshold" : "0.95",
  "openFileLimit" : "0",
  "prometheusStatsHttpPort" : "8100",
  "zkLedgersRootPath" : "/ledgers",
  "journalMaxSizeMB" : "2048",
  "journalAdaptiveGroupWrites" : "true",
  "openLedgerRereplicationGracePeriod" : "30",
  "ledgerDirectories" : "data/bookkeeper/ledgers",
  "zkTimeout" : "30000",
  "dbStorage_rocksDB_blockSize" : "65536",
  "journalMaxBackups" : "5",
  "maxPendingReadRequestsPerThread" : "2500",
  "useHostNameAsBookieID" : "false",
  "rereplicationEntryBatchSize" : "100",
  "allowLoopback" : "false",
  "readOnlyModeEnabled" : "true",
  "journalRemoveFromPageCache" : "true",
  "dbStorage_readAheadCacheMaxSizeMb" : "",
  "zkEnableSecurity" : "false",
  "numHighPriorityWorkerThreads" : "8",
  "dbStorage_readAheadCacheBatchSize" : "1000",
  "journalFormatVersionToWrite" : "5",
  "writeBufferSizeBytes" : "65536",
  "bookiePort" : "3181",
  "dbStorage_writeCacheMaxSizeMb" : "",
  "pageLimit" : "0",
  "logSizeLimit" : "1073741824",
  "advertisedAddress" : "172.31.7.191",
  "bookieDeathWatchInterval" : "1000",
  "numReadWorkerThreads" : "8",
  "minorCompactionThreshold" : "0.2",
  "serverTcpNoDelay" : "true",
  "journalBufferedWritesThreshold" : "524288",
  "compactionMaxOutstandingRequests" : "100000",
  "journalPreAllocSizeMB" : "16"
}
12:39:25.560 [main] INFO  org.apache.bookkeeper.meta.MetadataDrivers - BookKeeper metadata driver manager initialized
12:39:25.560 [main] INFO  org.apache.bookkeeper.meta.MetadataDrivers - BookKeeper metadata driver manager initialized
12:39:25.560 [main] INFO  org.apache.bookkeeper.meta.MetadataDrivers - BookKeeper metadata driver manager initialized
12:39:25.567 [main] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk+null://172.31.7.191:2181;172.31.15.110:2181/ledgers : zkServers = 172.31.7.191:2181,172.31.15.110:2181, ledgersRootPath = /ledgers.
12:39:25.571 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:zookeeper.version=3.5.7-f0fdd52973d373ffd9c86b81d99842dc2c7f660e, built on 02/10/2020 11:30 GMT
12:39:25.571 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:host.name=ip-172-31-7-191
12:39:25.571 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.version=1.8.0_265
12:39:25.571 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.vendor=Private Build
12:39:25.571 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.home=/usr/lib/jvm/java-8-openjdk-amd64/jre
12:39:25.571 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.class.path=/home/ubuntu/app/apache-pulsar-2.6.0/conf:::/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-http-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-auth-sasl-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.commons-commons-lang3-3.6.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-managed-ledger-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.dataformat-jackson-dataformat-yaml-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.commons-commons-collections4-4.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.slf4j-slf4j-api-1.7.25.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.commons-commons-compress-1.19.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-cpu-affinity-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_hotspot-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-client-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.api.grpc-proto-google-common-protos-1.12.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-xml-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.jaxrs-jackson-jaxrs-base-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.vertx-vertx-web-3.4.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-original-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.core-jackson-databind-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.slf4j-jul-to-slf4j-1.7.25.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.jsonwebtoken-jjwt-jackson-0.11.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_jetty-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.airlift-aircompressor-0.16.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-all-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.logging.log4j-log4j-slf4j-impl-2.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-io-commons-io-2.5.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-tools-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.distributedlog-distributedlog-common-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.auth-google-auth-library-credentials-0.9.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.distributedlog-distributedlog-core-4.10.0-tests.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-common-allocator-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.protobuf.nano-protobuf-javanano-3.0.0-alpha-5.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-common-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.checkerframework-checker-compat-qual-2.5.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.jsonwebtoken-jjwt-impl-0.11.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/log4j-log4j-1.2.17.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-circe-checksum-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-java-client-base-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.dropwizard.metrics-metrics-jvm-3.1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-logging-commons-logging-1.1.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-testclient-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.vertx-vertx-core-3.4.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-broker-auth-sasl-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.kubernetes-client-java-2.0.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.carrotsearch-hppc-0.7.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-proto-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.curator-curator-recipes-4.0.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_log4j2-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-broker-common-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-transaction-common-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.ext-jersey-entity-filtering-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-common-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.stats-bookkeeper-stats-api-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-api-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-proxy-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.media-jersey-media-json-jackson-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_common-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.aspectj-aspectjweaver-1.9.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-collections-commons-collections-3.2.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.logging.log4j-log4j-api-2.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-transaction-coordinator-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-http-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.opencensus-opencensus-api-0.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.httpcomponents-httpcore-4.4.9.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.aspectj-aspectjrt-1.9.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.containers-jersey-container-servlet-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.curator-curator-client-4.0.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.inject-javax.inject-1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.rocksdb-rocksdbjni-5.13.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-handler-proxy-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.errorprone-error_prone_annotations-2.1.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.jsonwebtoken-jjwt-api-0.11.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-zookeeper-utils-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.codehaus.mojo-animal-sniffer-annotations-1.14.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.module-jackson-module-jsonSchema-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.code.findbugs-jsr305-3.0.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-common-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-runtime-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-protobuf-shaded-2.1.0-incubating.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus.jmx-collector-0.12.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.logging.log4j-log4j-web-2.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/jakarta.activation-jakarta.activation-api-1.2.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.logging.log4j-log4j-core-2.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.github.ben-manes.caffeine-caffeine-2.6.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-broker-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.core-jersey-client-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-native-kqueue-4.1.48.Final-osx-x86_64.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.yaml-snakeyaml-1.24.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2-hk2-utils-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-continuation-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.distributedlog-distributedlog-core-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.protobuf-protobuf-java-3.5.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.stats-codahale-metrics-provider-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-servlets-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.asynchttpclient-async-http-client-2.12.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_httpserver-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-cli-commons-cli-1.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-security-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.curator-curator-framework-4.0.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-resolver-dns-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.inferred-freebuilder-1.14.9.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.slf4j-jcl-over-slf4j-1.7.25.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.hamcrest-hamcrest-core-1.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.core-jersey-common-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-java-client-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-core-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.yahoo.datasketches-memory-0.8.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.sun.activation-javax.activation-1.2.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.swagger-swagger-models-1.5.21.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-auth-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-websocket-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.dropwizard.metrics-metrics-core-3.1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-http2-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.core-jersey-server-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-statelib-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-testing-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-servlet-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.squareup.okhttp-okhttp-2.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-protobuf-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-api-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-context-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-javax-websocket-client-impl-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.avro-avro-protobuf-1.9.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-netty-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.javassist-javassist-3.25.0-GA.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/net.jcip-jcip-annotations-1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/net.jodah-typetools-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-servlet-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-common-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.j2objc-j2objc-annotations-1.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-api-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-admin-original-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.swagger-swagger-core-1.5.21.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.checkerframework-checker-qual-2.0.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.xml.bind-jaxb-api-2.3.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.core-jackson-core-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2.external-aopalliance-repackaged-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-api-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.servlet-javax.servlet-api-3.1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-common-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.distributedlog-distributedlog-protocol-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-messagecrypto-bc-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-tools-framework-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_servlet-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-worker-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.opencensus-opencensus-contrib-grpc-metrics-0.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.squareup.okio-okio-1.13.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2.external-javax.inject-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.inject-jersey-hk2-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.core-jackson-annotations-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.hdrhistogram-HdrHistogram-2.1.9.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.stats-prometheus-metrics-provider-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.media-jersey-media-multipart-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-api-examples-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-codec-commons-codec-1.10.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.ws.rs-javax.ws.rs-api-2.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2-osgi-resource-locator-1.0.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.asynchttpclient-async-http-client-netty-utils-2.12.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-resolver-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-buffer-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-metadata-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-secrets-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.jctools-jctools-core-2.1.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.kubernetes-client-java-api-2.0.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.code.gson-gson-2.8.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.yahoo.datasketches-sketches-core-0.8.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-proto-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.websocket-javax.websocket-client-api-1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-server-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.annotation-javax.annotation-api-1.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2-hk2-api-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.jaxrs-jackson-jaxrs-json-provider-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.http-vertx-http-server-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-util-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.media-jersey-media-jaxb-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.httpcomponents-httpclient-4.5.5.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-server-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.swagger-swagger-annotations-1.5.21.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.validation-validation-api-1.1.0.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.module-jackson-module-jaxb-annotations-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.http-http-server-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-client-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/joda-time-joda-time-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-server-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-tcnative-boringssl-static-2.0.30.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-io-core-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-configuration-commons-configuration-1.10.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.squareup.okhttp-logging-interceptor-2.7.5.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-native-unix-common-4.1.48.Final-linux-x86_64.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-dns-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.tests-stream-storage-tests-common-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_caffeine-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.typesafe.netty-netty-reactive-streams-2.0.4.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.containers-jersey-container-servlet-core-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-bouncy-castle-bc-shaded-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-discovery-service-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.yetus-audience-annotations-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-local-runner-original-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-utils-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-proto-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.beust-jcommander-1.48.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-instance-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.protobuf-protobuf-java-util-3.5.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.zookeeper-zookeeper-jute-3.5.7.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-protobuf-lite-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.vertx-vertx-auth-common-3.4.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.avro-avro-1.9.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-io-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-socks-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.jvnet.mimepull-mimepull-1.9.6.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-proxy-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2-hk2-locator-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/jakarta.xml.bind-jakarta.xml.bind-api-2.3.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.kubernetes-client-java-pro12:41:17.905 [main] INFO  org.apache.bookkeeper.server.Main - Using configuration file /home/ubuntu/app/apache-pulsar-2.6.0/conf/bookkeeper.conf
12:41:17.909 [main] INFO  org.apache.bookkeeper.server.Main - Hello, I'm your bookie, listening on port 3181. Metadata service uri is zk+null://172.31.7.191:2181;172.31.15.110:2181/ledgers. Journals are in [data/bookkeeper/journal]. Ledgers are stored in data/bookkeeper/ledgers.
12:41:17.922 [main] INFO  org.apache.bookkeeper.server.Main - Load lifecycle component : org.apache.bookkeeper.server.service.StatsProviderService
12:41:17.935 [main] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "readBufferSizeBytes" : "4096",
  "statsProviderClass" : "org.apache.bookkeeper.stats.prometheus.PrometheusMetricsProvider",
  "majorCompactionThreshold" : "0.5",
  "numJournalCallbackThreads" : "8",
  "httpServerPort" : "8000",
  "lostBookieRecoveryDelay" : "0",
  "journalAlignmentSize" : "4096",
  "compactionRateByBytes" : "1000000",
  "httpServerClass" : "org.apache.bookkeeper.http.vertx.VertxHttpServer",
  "dbStorage_rocksDB_numFilesInLevel0" : "4",
  "minUsableSizeForIndexFileCreation" : "1073741824",
  "gcOverreplicatedLedgerWaitTime" : "86400000",
  "journalMaxGroupWaitMSec" : "1",
  "dbStorage_rocksDB_numLevels" : "-1",
  "dbStorage_rocksDB_bloomFilterBitsPerKey" : "10",
  "nettyMaxFrameSizeBytes" : "5253120",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage",
  "auditorPeriodicBookieCheckInterval" : "86400",
  "gcWaitTime" : "900000",
  "compactionRate" : "1000",
  "fileInfoFormatVersionToWrite" : "0",
  "entryLogFilePreallocationEnabled" : "true",
  "journalSyncData" : "true",
  "zkServers" : "[172.31.7.191:2181, 172.31.15.110:2181]",
  "compactionRateByEntries" : "1000",
  "dbStorage_rocksDB_maxSizeInLevel1MB" : "256",
  "diskCheckInterval" : "10000",
  "auditorPeriodicCheckInterval" : "604800",
  "dbStorage_rocksDB_writeBufferSizeMB" : "64",
  "autoRecoveryDaemonEnabled" : "true",
  "maxPendingAddRequestsPerThread" : "10000",
  "flushEntrylogBytes" : "268435456",
  "majorCompactionInterval" : "86400",
  "httpServerEnabled" : "false",
  "flushInterval" : "60000",
  "journalFlushWhenQueueEmpty" : "false",
  "minorCompactionInterval" : "3600",
  "dbStorage_rocksDB_blockCacheSize" : "",
  "isThrottleByBytes" : "false",
  "numAddWorkerThreads" : "0",
  "dbStorage_rocksDB_sstSizeInMB" : "64",
  "journalDirectory" : "data/bookkeeper/journal",
  "journalWriteBufferSizeKB" : "64",
  "diskUsageThreshold" : "0.95",
  "openFileLimit" : "0",
  "prometheusStatsHttpPort" : "8100",
  "zkLedgersRootPath" : "/ledgers",
  "journalMaxSizeMB" : "2048",
  "journalAdaptiveGroupWrites" : "true",
  "openLedgerRereplicationGracePeriod" : "30",
  "ledgerDirectories" : "data/bookkeeper/ledgers",
  "zkTimeout" : "30000",
  "dbStorage_rocksDB_blockSize" : "65536",
  "journalMaxBackups" : "5",
  "maxPendingReadRequestsPerThread" : "2500",
  "useHostNameAsBookieID" : "false",
  "rereplicationEntryBatchSize" : "100",
  "allowLoopback" : "false",
  "readOnlyModeEnabled" : "true",
  "journalRemoveFromPageCache" : "true",
  "dbStorage_readAheadCacheMaxSizeMb" : "",
  "zkEnableSecurity" : "false",
  "numHighPriorityWorkerThreads" : "8",
  "dbStorage_readAheadCacheBatchSize" : "1000",
  "journalFormatVersionToWrite" : "5",
  "writeBufferSizeBytes" : "65536",
  "bookiePort" : "3181",
  "dbStorage_writeCacheMaxSizeMb" : "",
  "pageLimit" : "0",
  "logSizeLimit" : "1073741824",
  "advertisedAddress" : "172.31.7.191",
  "bookieDeathWatchInterval" : "1000",
  "numReadWorkerThreads" : "8",
  "minorCompactionThreshold" : "0.2",
  "serverTcpNoDelay" : "true",
  "journalBufferedWritesThreshold" : "524288",
  "compactionMaxOutstandingRequests" : "100000",
  "journalPreAllocSizeMB" : "16"
}
12:41:18.321 [main] INFO  org.apache.bookkeeper.meta.MetadataDrivers - BookKeeper metadata driver manager initialized
12:41:18.321 [main] INFO  org.apache.bookkeeper.meta.MetadataDrivers - BookKeeper metadata driver manager initialized
12:41:18.321 [main] INFO  org.apache.bookkeeper.meta.MetadataDrivers - BookKeeper metadata driver manager initialized
12:41:18.329 [main] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk+null://172.31.7.191:2181;172.31.15.110:2181/ledgers : zkServers = 172.31.7.191:2181,172.31.15.110:2181, ledgersRootPath = /ledgers.
12:41:18.333 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:zookeeper.version=3.5.7-f0fdd52973d373ffd9c86b81d99842dc2c7f660e, built on 02/10/2020 11:30 GMT
12:41:18.333 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:host.name=ip-172-31-7-191
12:41:18.333 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.version=1.8.0_265
12:41:18.333 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.vendor=Private Build
12:41:18.333 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.home=/usr/lib/jvm/java-8-openjdk-amd64/jre
12:41:18.333 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.class.path=/home/ubuntu/app/apache-pulsar-2.6.0/conf:::/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-http-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-auth-sasl-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.commons-commons-lang3-3.6.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-managed-ledger-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.dataformat-jackson-dataformat-yaml-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.commons-commons-collections4-4.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.slf4j-slf4j-api-1.7.25.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.commons-commons-compress-1.19.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-cpu-affinity-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_hotspot-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-client-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.api.grpc-proto-google-common-protos-1.12.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-xml-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.jaxrs-jackson-jaxrs-base-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.vertx-vertx-web-3.4.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-original-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.core-jackson-databind-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.slf4j-jul-to-slf4j-1.7.25.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.jsonwebtoken-jjwt-jackson-0.11.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_jetty-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.airlift-aircompressor-0.16.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-all-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.logging.log4j-log4j-slf4j-impl-2.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-io-commons-io-2.5.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-tools-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.distributedlog-distributedlog-common-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.auth-google-auth-library-credentials-0.9.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.distributedlog-distributedlog-core-4.10.0-tests.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-common-allocator-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.protobuf.nano-protobuf-javanano-3.0.0-alpha-5.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-common-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.checkerframework-checker-compat-qual-2.5.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.jsonwebtoken-jjwt-impl-0.11.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/log4j-log4j-1.2.17.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-circe-checksum-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-java-client-base-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.dropwizard.metrics-metrics-jvm-3.1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-logging-commons-logging-1.1.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-testclient-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.vertx-vertx-core-3.4.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-broker-auth-sasl-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.kubernetes-client-java-2.0.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.carrotsearch-hppc-0.7.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-proto-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.curator-curator-recipes-4.0.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_log4j2-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-broker-common-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-transaction-common-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.ext-jersey-entity-filtering-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-common-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.stats-bookkeeper-stats-api-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-api-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-proxy-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.media-jersey-media-json-jackson-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_common-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.aspectj-aspectjweaver-1.9.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-collections-commons-collections-3.2.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.logging.log4j-log4j-api-2.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-transaction-coordinator-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-http-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.opencensus-opencensus-api-0.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.httpcomponents-httpcore-4.4.9.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.aspectj-aspectjrt-1.9.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.containers-jersey-container-servlet-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.curator-curator-client-4.0.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.inject-javax.inject-1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.rocksdb-rocksdbjni-5.13.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-handler-proxy-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.errorprone-error_prone_annotations-2.1.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.jsonwebtoken-jjwt-api-0.11.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-zookeeper-utils-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.codehaus.mojo-animal-sniffer-annotations-1.14.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.module-jackson-module-jsonSchema-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.code.findbugs-jsr305-3.0.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-common-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-runtime-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-protobuf-shaded-2.1.0-incubating.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus.jmx-collector-0.12.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.logging.log4j-log4j-web-2.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/jakarta.activation-jakarta.activation-api-1.2.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.logging.log4j-log4j-core-2.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.github.ben-manes.caffeine-caffeine-2.6.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-broker-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.core-jersey-client-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-native-kqueue-4.1.48.Final-osx-x86_64.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.yaml-snakeyaml-1.24.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2-hk2-utils-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-continuation-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.distributedlog-distributedlog-core-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.protobuf-protobuf-java-3.5.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.stats-codahale-metrics-provider-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-servlets-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.asynchttpclient-async-http-client-2.12.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_httpserver-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-cli-commons-cli-1.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-security-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.curator-curator-framework-4.0.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-resolver-dns-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.inferred-freebuilder-1.14.9.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.slf4j-jcl-over-slf4j-1.7.25.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.hamcrest-hamcrest-core-1.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.core-jersey-common-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-java-client-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-core-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.yahoo.datasketches-memory-0.8.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.sun.activation-javax.activation-1.2.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.swagger-swagger-models-1.5.21.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-auth-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-websocket-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.dropwizard.metrics-metrics-core-3.1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-http2-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.core-jersey-server-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-statelib-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-testing-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-servlet-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.squareup.okhttp-okhttp-2.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-protobuf-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-api-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-context-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-javax-websocket-client-impl-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.avro-avro-protobuf-1.9.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-netty-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.javassist-javassist-3.25.0-GA.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/net.jcip-jcip-annotations-1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/net.jodah-typetools-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-servlet-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-common-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.j2objc-j2objc-annotations-1.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-api-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-admin-original-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.swagger-swagger-core-1.5.21.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.checkerframework-checker-qual-2.0.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.xml.bind-jaxb-api-2.3.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.core-jackson-core-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2.external-aopalliance-repackaged-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-api-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.servlet-javax.servlet-api-3.1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-common-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.distributedlog-distributedlog-protocol-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-messagecrypto-bc-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-tools-framework-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_servlet-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-worker-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.opencensus-opencensus-contrib-grpc-metrics-0.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.squareup.okio-okio-1.13.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2.external-javax.inject-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.inject-jersey-hk2-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.core-jackson-annotations-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.hdrhistogram-HdrHistogram-2.1.9.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.stats-prometheus-metrics-provider-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.media-jersey-media-multipart-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-api-examples-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-codec-commons-codec-1.10.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.ws.rs-javax.ws.rs-api-2.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2-osgi-resource-locator-1.0.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.asynchttpclient-async-http-client-netty-utils-2.12.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-resolver-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-buffer-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-metadata-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-secrets-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.jctools-jctools-core-2.1.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.kubernetes-client-java-api-2.0.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.code.gson-gson-2.8.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.yahoo.datasketches-sketches-core-0.8.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-proto-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.websocket-javax.websocket-client-api-1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-server-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.annotation-javax.annotation-api-1.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2-hk2-api-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.jaxrs-jackson-jaxrs-json-provider-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.http-vertx-http-server-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-util-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.media-jersey-media-jaxb-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.httpcomponents-httpclient-4.5.5.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-server-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.swagger-swagger-annotations-1.5.21.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.validation-validation-api-1.1.0.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.module-jackson-module-jaxb-annotations-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.http-http-server-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-client-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/joda-time-joda-time-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-server-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-tcnative-boringssl-static-2.0.30.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-io-core-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-configuration-commons-configuration-1.10.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.squareup.okhttp-logging-interceptor-2.7.5.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-native-unix-common-4.1.48.Final-linux-x86_64.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-dns-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.tests-stream-storage-tests-common-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_caffeine-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.typesafe.netty-netty-reactive-streams-2.0.4.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.containers-jersey-container-servlet-core-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-bouncy-castle-bc-shaded-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-discovery-service-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.yetus-audience-annotations-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-local-runner-original-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-utils-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-proto-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.beust-jcommander-1.48.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-instance-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.protobuf-protobuf-java-util-3.5.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.zookeeper-zookeeper-jute-3.5.7.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-protobuf-lite-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.vertx-vertx-auth-common-3.4.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.avro-avro-1.9.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-io-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-socks-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.jvnet.mimepull-mimepull-1.9.6.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-proxy-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2-hk2-locator-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/jakarta.xml.bind-jakarta.xml.bind-api-2.3.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.kubernetes-client-java-pro12:44:15.736 [main] INFO  org.apache.bookkeeper.server.Main - Using configuration file /home/ubuntu/app/apache-pulsar-2.6.0/conf/bookkeeper.conf
12:44:15.740 [main] INFO  org.apache.bookkeeper.server.Main - Hello, I'm your bookie, listening on port 3181. Metadata service uri is zk+null://172.31.7.191:2181;172.31.15.110:2181/ledgers. Journals are in [data/bookkeeper/journal]. Ledgers are stored in data/bookkeeper/ledgers.
12:44:15.752 [main] INFO  org.apache.bookkeeper.server.Main - Load lifecycle component : org.apache.bookkeeper.server.service.StatsProviderService
12:44:15.765 [main] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "readBufferSizeBytes" : "4096",
  "statsProviderClass" : "org.apache.bookkeeper.stats.prometheus.PrometheusMetricsProvider",
  "majorCompactionThreshold" : "0.5",
  "numJournalCallbackThreads" : "8",
  "httpServerPort" : "8000",
  "lostBookieRecoveryDelay" : "0",
  "journalAlignmentSize" : "4096",
  "compactionRateByBytes" : "1000000",
  "httpServerClass" : "org.apache.bookkeeper.http.vertx.VertxHttpServer",
  "dbStorage_rocksDB_numFilesInLevel0" : "4",
  "minUsableSizeForIndexFileCreation" : "1073741824",
  "gcOverreplicatedLedgerWaitTime" : "86400000",
  "journalMaxGroupWaitMSec" : "1",
  "dbStorage_rocksDB_numLevels" : "-1",
  "dbStorage_rocksDB_bloomFilterBitsPerKey" : "10",
  "nettyMaxFrameSizeBytes" : "5253120",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage",
  "auditorPeriodicBookieCheckInterval" : "86400",
  "gcWaitTime" : "900000",
  "compactionRate" : "1000",
  "fileInfoFormatVersionToWrite" : "0",
  "entryLogFilePreallocationEnabled" : "true",
  "journalSyncData" : "true",
  "zkServers" : "[172.31.7.191:2181, 172.31.15.110:2181]",
  "compactionRateByEntries" : "1000",
  "dbStorage_rocksDB_maxSizeInLevel1MB" : "256",
  "diskCheckInterval" : "10000",
  "auditorPeriodicCheckInterval" : "604800",
  "dbStorage_rocksDB_writeBufferSizeMB" : "64",
  "autoRecoveryDaemonEnabled" : "true",
  "maxPendingAddRequestsPerThread" : "10000",
  "flushEntrylogBytes" : "268435456",
  "majorCompactionInterval" : "86400",
  "httpServerEnabled" : "false",
  "flushInterval" : "60000",
  "journalFlushWhenQueueEmpty" : "false",
  "minorCompactionInterval" : "3600",
  "dbStorage_rocksDB_blockCacheSize" : "",
  "isThrottleByBytes" : "false",
  "numAddWorkerThreads" : "0",
  "dbStorage_rocksDB_sstSizeInMB" : "64",
  "journalDirectory" : "data/bookkeeper/journal",
  "journalWriteBufferSizeKB" : "64",
  "diskUsageThreshold" : "0.95",
  "openFileLimit" : "0",
  "prometheusStatsHttpPort" : "8100",
  "zkLedgersRootPath" : "/ledgers",
  "journalMaxSizeMB" : "2048",
  "journalAdaptiveGroupWrites" : "true",
  "openLedgerRereplicationGracePeriod" : "30",
  "ledgerDirectories" : "data/bookkeeper/ledgers",
  "zkTimeout" : "30000",
  "dbStorage_rocksDB_blockSize" : "65536",
  "journalMaxBackups" : "5",
  "maxPendingReadRequestsPerThread" : "2500",
  "useHostNameAsBookieID" : "false",
  "rereplicationEntryBatchSize" : "100",
  "allowLoopback" : "false",
  "readOnlyModeEnabled" : "true",
  "journalRemoveFromPageCache" : "true",
  "dbStorage_readAheadCacheMaxSizeMb" : "",
  "zkEnableSecurity" : "false",
  "numHighPriorityWorkerThreads" : "8",
  "dbStorage_readAheadCacheBatchSize" : "1000",
  "journalFormatVersionToWrite" : "5",
  "writeBufferSizeBytes" : "65536",
  "bookiePort" : "3181",
  "dbStorage_writeCacheMaxSizeMb" : "",
  "pageLimit" : "0",
  "logSizeLimit" : "1073741824",
  "advertisedAddress" : "172.31.7.191",
  "bookieDeathWatchInterval" : "1000",
  "numReadWorkerThreads" : "8",
  "minorCompactionThreshold" : "0.2",
  "serverTcpNoDelay" : "true",
  "journalBufferedWritesThreshold" : "524288",
  "compactionMaxOutstandingRequests" : "100000",
  "journalPreAllocSizeMB" : "16"
}
12:44:16.149 [main] INFO  org.apache.bookkeeper.meta.MetadataDrivers - BookKeeper metadata driver manager initialized
12:44:16.149 [main] INFO  org.apache.bookkeeper.meta.MetadataDrivers - BookKeeper metadata driver manager initialized
12:44:16.149 [main] INFO  org.apache.bookkeeper.meta.MetadataDrivers - BookKeeper metadata driver manager initialized
12:44:16.156 [main] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk+null://172.31.7.191:2181;172.31.15.110:2181/ledgers : zkServers = 172.31.7.191:2181,172.31.15.110:2181, ledgersRootPath = /ledgers.
12:44:16.160 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:zookeeper.version=3.5.7-f0fdd52973d373ffd9c86b81d99842dc2c7f660e, built on 02/10/2020 11:30 GMT
12:44:16.160 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:host.name=ip-172-31-7-191
12:44:16.161 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.version=1.8.0_265
12:44:16.161 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.vendor=Private Build
12:44:16.161 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.home=/usr/lib/jvm/java-8-openjdk-amd64/jre
12:44:16.161 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.class.path=/home/ubuntu/app/apache-pulsar-2.6.0/conf:::/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-http-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-auth-sasl-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.commons-commons-lang3-3.6.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-managed-ledger-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.dataformat-jackson-dataformat-yaml-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.commons-commons-collections4-4.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.slf4j-slf4j-api-1.7.25.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.commons-commons-compress-1.19.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-cpu-affinity-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_hotspot-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-client-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.api.grpc-proto-google-common-protos-1.12.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-xml-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.jaxrs-jackson-jaxrs-base-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.vertx-vertx-web-3.4.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-original-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.core-jackson-databind-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.slf4j-jul-to-slf4j-1.7.25.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.jsonwebtoken-jjwt-jackson-0.11.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_jetty-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.airlift-aircompressor-0.16.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-all-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.logging.log4j-log4j-slf4j-impl-2.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-io-commons-io-2.5.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-tools-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.distributedlog-distributedlog-common-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.auth-google-auth-library-credentials-0.9.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.distributedlog-distributedlog-core-4.10.0-tests.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-common-allocator-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.protobuf.nano-protobuf-javanano-3.0.0-alpha-5.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-common-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.checkerframework-checker-compat-qual-2.5.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.jsonwebtoken-jjwt-impl-0.11.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/log4j-log4j-1.2.17.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-circe-checksum-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-java-client-base-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.dropwizard.metrics-metrics-jvm-3.1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-logging-commons-logging-1.1.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-testclient-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.vertx-vertx-core-3.4.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-broker-auth-sasl-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.kubernetes-client-java-2.0.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.carrotsearch-hppc-0.7.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-proto-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.curator-curator-recipes-4.0.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_log4j2-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-broker-common-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-transaction-common-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.ext-jersey-entity-filtering-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-common-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.stats-bookkeeper-stats-api-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-api-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-proxy-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.media-jersey-media-json-jackson-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_common-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.aspectj-aspectjweaver-1.9.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-collections-commons-collections-3.2.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.logging.log4j-log4j-api-2.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-transaction-coordinator-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-http-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.opencensus-opencensus-api-0.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.httpcomponents-httpcore-4.4.9.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.aspectj-aspectjrt-1.9.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.containers-jersey-container-servlet-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.curator-curator-client-4.0.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.inject-javax.inject-1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.rocksdb-rocksdbjni-5.13.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-handler-proxy-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.errorprone-error_prone_annotations-2.1.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.jsonwebtoken-jjwt-api-0.11.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-zookeeper-utils-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.codehaus.mojo-animal-sniffer-annotations-1.14.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.module-jackson-module-jsonSchema-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.code.findbugs-jsr305-3.0.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-common-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-runtime-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-protobuf-shaded-2.1.0-incubating.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus.jmx-collector-0.12.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.logging.log4j-log4j-web-2.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/jakarta.activation-jakarta.activation-api-1.2.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.logging.log4j-log4j-core-2.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.github.ben-manes.caffeine-caffeine-2.6.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-broker-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.core-jersey-client-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-native-kqueue-4.1.48.Final-osx-x86_64.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.yaml-snakeyaml-1.24.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2-hk2-utils-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-continuation-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.distributedlog-distributedlog-core-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.protobuf-protobuf-java-3.5.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.stats-codahale-metrics-provider-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-servlets-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.asynchttpclient-async-http-client-2.12.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_httpserver-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-cli-commons-cli-1.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-security-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.curator-curator-framework-4.0.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-resolver-dns-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.inferred-freebuilder-1.14.9.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.slf4j-jcl-over-slf4j-1.7.25.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.hamcrest-hamcrest-core-1.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.core-jersey-common-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-java-client-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-core-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.yahoo.datasketches-memory-0.8.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.sun.activation-javax.activation-1.2.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.swagger-swagger-models-1.5.21.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-auth-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-websocket-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.dropwizard.metrics-metrics-core-3.1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-http2-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.core-jersey-server-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-statelib-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-testing-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-servlet-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.squareup.okhttp-okhttp-2.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-protobuf-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-api-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-context-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-javax-websocket-client-impl-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.avro-avro-protobuf-1.9.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-netty-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.javassist-javassist-3.25.0-GA.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/net.jcip-jcip-annotations-1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/net.jodah-typetools-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-servlet-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-common-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.j2objc-j2objc-annotations-1.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-api-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-admin-original-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.swagger-swagger-core-1.5.21.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.checkerframework-checker-qual-2.0.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.xml.bind-jaxb-api-2.3.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.core-jackson-core-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2.external-aopalliance-repackaged-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-api-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.servlet-javax.servlet-api-3.1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-common-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.distributedlog-distributedlog-protocol-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-client-messagecrypto-bc-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-tools-framework-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_servlet-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-worker-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.opencensus-opencensus-contrib-grpc-metrics-0.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.squareup.okio-okio-1.13.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2.external-javax.inject-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.inject-jersey-hk2-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.core-jackson-annotations-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.hdrhistogram-HdrHistogram-2.1.9.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.stats-prometheus-metrics-provider-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.media-jersey-media-multipart-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-api-examples-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-codec-commons-codec-1.10.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.ws.rs-javax.ws.rs-api-2.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2-osgi-resource-locator-1.0.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.asynchttpclient-async-http-client-netty-utils-2.12.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-resolver-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-buffer-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-metadata-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-secrets-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.jctools-jctools-core-2.1.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.kubernetes-client-java-api-2.0.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.code.gson-gson-2.8.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.yahoo.datasketches-sketches-core-0.8.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-proto-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.websocket-javax.websocket-client-api-1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-server-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.annotation-javax.annotation-api-1.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2-hk2-api-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.jaxrs-jackson-jaxrs-json-provider-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.http-vertx-http-server-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-util-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.media-jersey-media-jaxb-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.httpcomponents-httpclient-4.5.5.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-server-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.swagger-swagger-annotations-1.5.21.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/javax.validation-validation-api-1.1.0.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.fasterxml.jackson.module-jackson-module-jaxb-annotations-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.http-http-server-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty.websocket-websocket-client-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/joda-time-joda-time-2.10.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-server-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-tcnative-boringssl-static-2.0.30.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-io-core-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-configuration-commons-configuration-1.10.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.squareup.okhttp-logging-interceptor-2.7.5.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-native-unix-common-4.1.48.Final-linux-x86_64.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-dns-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper.tests-stream-storage-tests-common-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.prometheus-simpleclient_caffeine-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.typesafe.netty-netty-reactive-streams-2.0.4.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.jersey.containers-jersey-container-servlet-core-2.27.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-bouncy-castle-bc-shaded-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-discovery-service-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.yetus-audience-annotations-0.5.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-local-runner-original-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-utils-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-bookkeeper-proto-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.beust-jcommander-1.48.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-functions-instance-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.protobuf-protobuf-java-util-3.5.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.zookeeper-zookeeper-jute-3.5.7.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-protobuf-lite-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.vertx-vertx-auth-common-3.4.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.avro-avro-1.9.1.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.eclipse.jetty-jetty-io-9.4.20.v20190813.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-codec-socks-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.jvnet.mimepull-mimepull-1.9.6.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.pulsar-pulsar-proxy-2.6.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.glassfish.hk2-hk2-locator-2.5.0-b42.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/jakarta.xml.bind-jakarta.xml.bind-api-2.3.2.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.kubernetes-client-java-proto-2.0.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/net.java.dev.jna-jna-4.2.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-service-impl-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-okhttp-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.google.guava-guava-25.1-jre.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.squareup.okhttp-okhttp-ws-2.7.5.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.apache.bookkeeper-stream-storage-service-api-4.10.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/com.github.zafarkhaja-java-semver-0.9.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-transport-native-epoll-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.dropwizard.metrics-metrics-graphite-3.1.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.netty-netty-handler-4.1.48.Final.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-protobuf-nano-1.18.0.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/commons-lang-commons-lang-2.6.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/org.reactivestreams-reactive-streams-1.0.3.jar:/home/ubuntu/app/apache-pulsar-2.6.0/lib/io.grpc-grpc-stub-1.18.0.jar:
12:44:16.162 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.library.path=/usr/java/packages/lib/amd64:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
12:44:16.163 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.io.tmpdir=/tmp
12:44:16.163 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:java.compiler=<NA>
12:44:16.163 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:os.name=Linux
12:44:16.163 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:os.arch=amd64
12:44:16.163 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:os.version=5.4.0-1025-aws
12:44:16.163 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:user.name=ubuntu
12:44:16.163 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:user.home=/home/ubuntu
12:44:16.163 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:user.dir=/home/ubuntu/app/apache-pulsar-2.6.0
12:44:16.163 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:os.memory.free=2000MB
12:44:16.163 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:os.memory.max=2048MB
12:44:16.163 [main] INFO  org.apache.zookeeper.ZooKeeper - Client environment:os.memory.total=2048MB
12:44:16.167 [main] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=172.31.7.191:2181,172.31.15.110:2181 sessionTimeout=30000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@29e6eb25
12:44:16.171 [main] INFO  org.apache.zookeeper.common.X509Util - Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation
12:44:16.176 [main] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 10485760 Bytes
12:44:16.181 [main] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=
12:44:16.187 [main-SendThread(172.31.7.191:2181)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server ip-172-31-7-191/172.31.7.191:2181. Will not attempt to authenticate using SASL (unknown error)
12:44:16.191 [main-SendThread(172.31.7.191:2181)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /172.31.7.191:43000, server: ip-172-31-7-191/172.31.7.191:2181
12:44:16.197 [main-SendThread(172.31.7.191:2181)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server ip-172-31-7-191/172.31.7.191:2181, sessionid = 0x100020c20d80005, negotiated timeout = 30000
12:44:16.200 [main-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
12:44:16.228 [main] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [data/bookkeeper/journal/current] [data/bookkeeper/ledgers/current]
12:44:16.294 [main] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
12:44:16.310 [main] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from data/bookkeeper/ledgers/current/lastMark (this is okay if it is the first time starting this bookie
12:44:16.311 [main] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage
12:44:16.313 [main] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Started Db Ledger Storage
12:44:16.313 [main] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage -  - Number of directories: 1
12:44:16.313 [main] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage -  - Write cache size: 512 MB
12:44:16.313 [main] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage -  - Read Cache: 512 MB
12:44:16.315 [main] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Creating single directory db ledger storage on data/bookkeeper/ledgers/current
12:44:16.438 [main] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
12:44:16.445 [main] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.2, interval=3600000
12:44:16.446 [main] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.5, interval=86400000
12:44:16.468 [main] INFO  org.apache.bookkeeper.server.Main - Load lifecycle component : org.apache.bookkeeper.server.service.BookieService
12:44:16.500 [main] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk+null://172.31.7.191:2181;172.31.15.110:2181/ledgers : zkServers = 172.31.7.191:2181,172.31.15.110:2181, ledgersRootPath = /ledgers.
12:44:16.500 [main] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=172.31.7.191:2181,172.31.15.110:2181 sessionTimeout=30000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@58cd06cb
12:44:16.500 [main] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 10485760 Bytes
12:44:16.500 [main] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=
12:44:16.507 [main-SendThread(172.31.15.110:2181)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server ip-172-31-15-110/172.31.15.110:2181. Will not attempt to authenticate using SASL (unknown error)
12:44:16.507 [main-SendThread(172.31.15.110:2181)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /172.31.7.191:36330, server: ip-172-31-15-110/172.31.15.110:2181
12:44:16.510 [main-SendThread(172.31.15.110:2181)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server ip-172-31-15-110/172.31.15.110:2181, sessionid = 0x200020c11060002, negotiated timeout = 30000
12:44:16.510 [main-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
12:44:16.531 [main] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
12:44:16.549 [main] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:172.31.7.191:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
12:44:16.549 [main] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
12:44:16.552 [main] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
12:44:16.609 [main] INFO  org.apache.bookkeeper.server.Main - Load lifecycle component : org.apache.bookkeeper.server.service.AutoRecoveryService
12:44:16.614 [main] INFO  org.apache.bookkeeper.common.component.ComponentStarter - Starting component bookie-server.
12:44:16.627 [main] INFO  org.eclipse.jetty.util.log - Logging initialized @1844ms to org.eclipse.jetty.util.log.Slf4jLog
12:44:16.709 [main] INFO  org.eclipse.jetty.server.Server - jetty-9.4.20.v20190813; built: 2019-08-13T21:28:18.144Z; git: 84700530e645e812b336747464d6fbbf370c9a20; jvm 1.8.0_265-8u265-b01-0ubuntu2~18.04-b01
12:44:16.739 [main] INFO  org.eclipse.jetty.server.handler.ContextHandler - Started o.e.j.s.ServletContextHandler@4ebadd3d{/,null,AVAILABLE}
12:44:16.749 [main] INFO  org.eclipse.jetty.server.AbstractConnector - Started ServerConnector@5300f14a{HTTP/1.1,[http/1.1]}{0.0.0.0:8100}
12:44:16.749 [main] INFO  org.eclipse.jetty.server.Server - Started @1968ms
12:44:16.749 [main] INFO  org.apache.bookkeeper.stats.prometheus.PrometheusMetricsProvider - Started Prometheus stats endpoint at 0.0.0.0:8100
12:44:16.758 [main] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 1 ms.
12:44:16.770 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
12:44:16.773 [main] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
12:44:16.774 [BookieJournal-3181] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on data/bookkeeper/journal/current
12:44:16.775 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
12:44:16.777 [BookieJournal-3181] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal data/bookkeeper/journal/current/174d9e46007.txn
12:44:16.781 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/172.31.7.191:3181
12:44:17.032 [main] INFO  org.apache.bookkeeper.common.component.ComponentStarter - Started component bookie-server.
12:44:17.049 [AuditorElector-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - AuthProvider used by the Auditor is null
12:44:17.051 [AuditorElector-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Initializing lostBookieRecoveryDelay zNode to the conif value: 0
12:44:17.052 [AuditorElector-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - I'm starting as Auditor Bookie. ID: 172.31.7.191:3181
12:44:17.055 [AuditorElector-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
12:44:17.055 [AuditorElector-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
12:44:17.055 [AuditorElector-172.31.7.191:3181] WARN  org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager - checkAllLedgersCtimeZnode is not yet available
12:44:17.055 [AuditorElector-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: -1 durationSinceLastExecutionInSecs: -1 initialDelay: 0 interval: 604800
12:44:17.056 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Starting auditBookies
12:44:17.056 [AuditorElector-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Periodic placementPolicy check disabled
12:44:17.056 [AuditorElector-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Periodic replicas check disabled
12:44:17.070 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Completed auditBookies
12:44:17.070 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Starting checkAllLedgers
12:44:17.077 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk+null://172.31.7.191:2181;172.31.15.110:2181/ledgers : zkServers = 172.31.7.191:2181,172.31.15.110:2181, ledgersRootPath = /ledgers.
12:44:17.077 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=172.31.7.191:2181,172.31.15.110:2181 sessionTimeout=30000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@74037f60
12:44:17.078 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 10485760 Bytes
12:44:17.078 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=
12:44:17.078 [AuditorBookie-172.31.7.191:3181-SendThread(172.31.15.110:2181)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server ip-172-31-15-110/172.31.15.110:2181. Will not attempt to authenticate using SASL (unknown error)
12:44:17.079 [AuditorBookie-172.31.7.191:3181-SendThread(172.31.15.110:2181)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /172.31.7.191:36332, server: ip-172-31-15-110/172.31.15.110:2181
12:44:17.081 [AuditorBookie-172.31.7.191:3181-SendThread(172.31.15.110:2181)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server ip-172-31-15-110/172.31.15.110:2181, sessionid = 0x200020c11060003, negotiated timeout = 30000
12:44:17.081 [AuditorBookie-172.31.7.191:3181-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
12:44:17.105 [AuditorBookie-172.31.7.191:3181] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
12:44:17.106 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:172.31.7.191:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
12:44:17.106 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
12:44:17.106 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
12:44:17.107 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/172.31.7.191:3181
12:44:17.234 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x200020c11060003 closed
12:44:17.234 [AuditorBookie-172.31.7.191:3181-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x200020c11060003
12:44:17.234 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Completed checkAllLedgers in 164 milliSeconds
12:44:30.435 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/172.31.15.110:3181
12:44:41.770 [bookie-io-1-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:44:41.771 [bookie-io-1-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x42b85ec0, L:/172.31.7.191:3181 - R:/172.31.7.191:56302]
12:44:41.921 [BookieHighPriorityThread-3181-OrderedExecutor-0-0] INFO  org.apache.bookkeeper.proto.ReadEntryProcessorV3 - Ledger fence request received for ledger: 0 from address: /172.31.7.191:56302
12:44:41.983 [bookie-io-1-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x42b85ec0, L:/172.31.7.191:3181 ! R:/172.31.7.191:56302]
12:45:16.775 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
12:45:16.777 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/0.log for logId 0.
12:45:16.779 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/1.log for logId 1.
12:45:46.417 [bookie-io-1-3] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:46.417 [bookie-io-1-3] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x7e87f887, L:/172.31.7.191:3181 - R:/172.31.15.110:60770]
12:45:46.417 [bookie-io-1-4] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:46.417 [bookie-io-1-4] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xecf58d8a, L:/172.31.7.191:3181 - R:/172.31.15.110:60780]
12:45:46.419 [bookie-io-1-7] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:46.419 [bookie-io-1-9] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:46.419 [bookie-io-1-6] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:46.419 [bookie-io-1-8] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:46.418 [bookie-io-1-5] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:46.419 [bookie-io-1-8] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xddb516f7, L:/172.31.7.191:3181 - R:/172.31.15.110:60796]
12:45:46.419 [bookie-io-1-7] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xdd189032, L:/172.31.7.191:3181 - R:/172.31.15.110:60798]
12:45:46.419 [bookie-io-1-6] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x476edd80, L:/172.31.7.191:3181 - R:/172.31.15.110:60792]
12:45:46.419 [bookie-io-1-5] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xfe175e85, L:/172.31.7.191:3181 - R:/172.31.15.110:60782]
12:45:46.419 [bookie-io-1-9] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x80d1717f, L:/172.31.7.191:3181 - R:/172.31.15.110:60804]
12:45:46.420 [bookie-io-1-10] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:46.420 [bookie-io-1-10] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x4033e7ad, L:/172.31.7.191:3181 - R:/172.31.15.110:60806]
12:45:46.421 [bookie-io-1-13] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:46.420 [bookie-io-1-12] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:46.420 [bookie-io-1-11] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:46.421 [bookie-io-1-13] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xa9b70b90, L:/172.31.7.191:3181 - R:/172.31.15.110:60812]
12:45:46.421 [bookie-io-1-11] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xa175c05a, L:/172.31.7.191:3181 - R:/172.31.15.110:60814]
12:45:46.421 [bookie-io-1-12] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xe58a0c3c, L:/172.31.7.191:3181 - R:/172.31.15.110:60810]
12:45:46.422 [bookie-io-1-14] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:46.422 [bookie-io-1-14] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xc43fed99, L:/172.31.7.191:3181 - R:/172.31.15.110:60816]
12:45:46.422 [bookie-io-1-16] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:46.422 [bookie-io-1-16] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x8608673e, L:/172.31.7.191:3181 - R:/172.31.15.110:60822]
12:45:46.423 [bookie-io-1-17] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:46.423 [bookie-io-1-17] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x167fcae1, L:/172.31.7.191:3181 - R:/172.31.15.110:60824]
12:45:46.423 [bookie-io-1-15] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:46.424 [bookie-io-1-15] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x7a77ad3c, L:/172.31.7.191:3181 - R:/172.31.15.110:60820]
12:45:46.424 [bookie-io-1-18] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:46.424 [bookie-io-1-18] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x827766d7, L:/172.31.7.191:3181 - R:/172.31.15.110:60828]
12:45:54.411 [bookie-io-1-19] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:54.411 [bookie-io-1-19] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x1f6bee89, L:/172.31.7.191:3181 - R:/172.31.7.191:56322]
12:45:54.414 [bookie-io-1-20] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:54.414 [bookie-io-1-21] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:54.415 [bookie-io-1-20] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x16c886e0, L:/172.31.7.191:3181 - R:/172.31.7.191:56330]
12:45:54.415 [bookie-io-1-21] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xe93628b2, L:/172.31.7.191:3181 - R:/172.31.7.191:56332]
12:45:54.417 [bookie-io-1-22] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:54.417 [bookie-io-1-23] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:54.418 [bookie-io-1-22] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x8d83458a, L:/172.31.7.191:3181 - R:/172.31.7.191:56336]
12:45:54.418 [bookie-io-1-23] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xc6cec679, L:/172.31.7.191:3181 - R:/172.31.7.191:56342]
12:45:54.422 [bookie-io-1-25] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:54.423 [bookie-io-1-25] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x90245e2f, L:/172.31.7.191:3181 - R:/172.31.7.191:56356]
12:45:54.425 [bookie-io-1-29] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:54.425 [bookie-io-1-30] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:54.425 [bookie-io-1-27] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:54.425 [bookie-io-1-24] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:54.422 [bookie-io-1-26] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:54.426 [bookie-io-1-29] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xe448ef12, L:/172.31.7.191:3181 - R:/172.31.7.191:56372]
12:45:54.426 [bookie-io-1-24] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x303f2cb7, L:/172.31.7.191:3181 - R:/172.31.7.191:56346]
12:45:54.426 [bookie-io-1-30] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x36f57bca, L:/172.31.7.191:3181 - R:/172.31.7.191:56374]
12:45:54.426 [bookie-io-1-26] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xe9c1c950, L:/172.31.7.191:3181 - R:/172.31.7.191:56358]
12:45:54.426 [bookie-io-1-27] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x1d3732f2, L:/172.31.7.191:3181 - R:/172.31.7.191:56366]
12:45:54.426 [bookie-io-1-28] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:54.426 [bookie-io-1-28] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xbbebcd5d, L:/172.31.7.191:3181 - R:/172.31.7.191:56368]
12:45:54.431 [bookie-io-1-1] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:54.431 [bookie-io-1-1] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xea8932a1, L:/172.31.7.191:3181 - R:/172.31.7.191:56382]
12:45:54.431 [bookie-io-1-31] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:54.432 [bookie-io-1-32] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:54.432 [bookie-io-1-31] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xb6e8f0a6, L:/172.31.7.191:3181 - R:/172.31.7.191:56378]
12:45:54.432 [bookie-io-1-32] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x25b38260, L:/172.31.7.191:3181 - R:/172.31.7.191:56380]
12:45:54.432 [bookie-io-1-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
12:45:54.432 [bookie-io-1-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xd3fe3013, L:/172.31.7.191:3181 - R:/172.31.7.191:56384]
12:46:19.021 [bookie-io-1-22] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:46:30.504 [bookie-io-1-6] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:46:35.377 [bookie-io-1-28] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:46:37.991 [bookie-io-1-3] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:46:40.383 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
12:46:40.385 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 0 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=0, logFile=data/bookkeeper/ledgers/current/0.log, ledgerIdAssigned=-1}].
12:46:40.386 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/2.log for logId 2.
12:46:41.427 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 0 to disk.
12:46:43.069 [bookie-io-1-3] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:46:54.294 [bookie-io-1-7] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:46:57.349 [bookie-io-1-22] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:46:59.832 [BookieJournal-3181] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal data/bookkeeper/journal/current/174d9e46008.txn
12:47:02.968 [bookie-io-1-10] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:47:04.354 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
12:47:04.355 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 1 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=1, logFile=data/bookkeeper/ledgers/current/1.log, ledgerIdAssigned=-1}].
12:47:04.355 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/3.log for logId 3.
12:47:05.607 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 1 to disk.
12:47:07.301 [bookie-io-1-5] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:47:10.751 [bookie-io-1-7] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:47:14.932 [bookie-io-1-6] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:47:20.559 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
12:47:20.560 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 2 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=2, logFile=data/bookkeeper/ledgers/current/2.log, ledgerIdAssigned=-1}].
12:47:20.561 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/4.log for logId 4.
12:47:21.331 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 2 to disk.
12:47:22.596 [bookie-io-1-10] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:47:32.342 [bookie-io-1-17] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:47:37.395 [bookie-io-1-25] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:47:39.772 [BookieJournal-3181] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal data/bookkeeper/journal/current/174d9e46009.txn
12:47:43.841 [bookie-io-1-17] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:47:45.003 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
12:47:45.003 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 3 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=3, logFile=data/bookkeeper/ledgers/current/3.log, ledgerIdAssigned=-1}].
12:47:45.005 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/5.log for logId 5.
12:47:45.767 [db-storage-9-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 3 to disk.
12:47:48.679 [bookie-io-1-5] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:47:55.354 [bookie-io-1-13] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:47:59.983 [bookie-io-1-7] INFO  org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage - Write cache is full, triggering flush
12:53:16.829 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
12:53:16.829 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Flushing entry logger 4 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=4, logFile=data/bookkeeper/ledgers/current/4.log, ledgerIdAssigned=-1}].
12:53:16.830 [pool-5-thread-1] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file data/bookkeeper/ledgers/current/6.log for logId 6.
12:53:16.836 [SyncThread-7-1] INFO  org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog - Synced entry logger 4 to disk.
12:59:16.774 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Extracting entry log meta from entryLogId: 0
12:59:16.788 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Extracting entry log meta from entryLogId: 1
12:59:16.789 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Extracting entry log meta from entryLogId: 2
12:59:16.790 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Extracting entry log meta from entryLogId: 3
12:59:16.790 [GarbageCollectorThread-11-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Extracting entry log meta from entryLogId: 4
12:59:16.862 [db-storage-cleanup-10-1] INFO  org.apache.bookkeeper.bookie.storage.ldb.EntryLocationIndex - Deleting indexes for ledgers: [0, 128, 68, 69, 133, 70, 8, 9, 10, 14, 18, 406, 407, 410, 91, 412, 413, 31, 415, 416, 33, 99, 105, 43, 45, 110, 50, 51, 60]
12:59:16.871 [db-storage-cleanup-10-1] INFO  org.apache.bookkeeper.bookie.storage.ldb.EntryLocationIndex - Deleted indexes for 5111 entries from 29 ledgers in 0.009 seconds
13:29:58.694 [bookie-io-1-9] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x80d1717f, L:/172.31.7.191:3181 ! R:/172.31.15.110:60804]
13:29:58.694 [bookie-io-1-4] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xecf58d8a, L:/172.31.7.191:3181 ! R:/172.31.15.110:60780]
13:29:58.694 [bookie-io-1-13] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xa9b70b90, L:/172.31.7.191:3181 ! R:/172.31.15.110:60812]
13:29:58.694 [bookie-io-1-12] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xe58a0c3c, L:/172.31.7.191:3181 ! R:/172.31.15.110:60810]
13:29:58.695 [bookie-io-1-15] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x7a77ad3c, L:/172.31.7.191:3181 ! R:/172.31.15.110:60820]
13:29:58.695 [bookie-io-1-18] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x827766d7, L:/172.31.7.191:3181 ! R:/172.31.15.110:60828]
13:29:58.695 [bookie-io-1-6] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x476edd80, L:/172.31.7.191:3181 ! R:/172.31.15.110:60792]
13:29:58.695 [bookie-io-1-17] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x167fcae1, L:/172.31.7.191:3181 ! R:/172.31.15.110:60824]
13:29:58.696 [bookie-io-1-5] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xfe175e85, L:/172.31.7.191:3181 ! R:/172.31.15.110:60782]
13:29:58.696 [bookie-io-1-7] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xdd189032, L:/172.31.7.191:3181 ! R:/172.31.15.110:60798]
13:29:58.696 [bookie-io-1-16] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x8608673e, L:/172.31.7.191:3181 ! R:/172.31.15.110:60822]
13:29:58.697 [bookie-io-1-3] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x7e87f887, L:/172.31.7.191:3181 ! R:/172.31.15.110:60770]
13:29:58.697 [bookie-io-1-14] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xc43fed99, L:/172.31.7.191:3181 ! R:/172.31.15.110:60816]
13:29:58.697 [bookie-io-1-8] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xddb516f7, L:/172.31.7.191:3181 ! R:/172.31.15.110:60796]
13:29:58.697 [bookie-io-1-11] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xa175c05a, L:/172.31.7.191:3181 ! R:/172.31.15.110:60814]
13:29:58.698 [bookie-io-1-10] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x4033e7ad, L:/172.31.7.191:3181 ! R:/172.31.15.110:60806]
13:29:59.771 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Removing a node: /default-rack/172.31.15.110:3181
13:29:59.772 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Starting auditBookies
13:29:59.992 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Following are the failed bookies: [172.31.15.110:3181], and searching its ledgers for re-replication
13:29:59.994 [AuditorBookie-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.Auditor - Following ledgers: [2, 4, 5, 6, 7, 11, 12, 13, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 32, 34, 35, 36, 37, 38, 39, 40, 41, 42, 44, 46, 47, 48, 49, 52, 53, 54, 55, 56, 57, 58, 59, 61, 62, 63, 64, 65, 66, 67, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 92, 93, 94, 95, 96, 97, 98, 100, 101, 102, 103, 104, 106, 107, 108, 109, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 129, 130, 131, 132, 134, 135, 137, 138, 139, 140, 142, 145, 154, 156, 157, 158, 159, 160, 163, 164, 166, 168, 171, 172, 174, 175, 176, 177, 178, 184, 185, 186, 187, 192, 197, 198, 201, 202, 205, 206, 207, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 226, 231, 234, 236, 238, 241, 244, 251, 254, 255, 260, 269, 270, 271, 272, 273, 275, 279, 281, 285, 288, 291, 297, 298, 299, 300, 302, 304, 307, 311, 315, 317, 319, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 334, 335, 339, 341, 342, 343, 344, 345, 346, 347, 348, 349, 364, 365, 366, 367, 368, 370, 372, 373, 375, 376, 377, 378, 380, 381, 384, 388, 390, 392, 393, 397, 398, 399, 408, 409, 411, 414, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435] of bookie: [172.31.15.110:3181] are identified as underreplicated
13:30:00.054 [bookie-io-1-3] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
13:30:00.054 [bookie-io-1-3] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xb9b45d11, L:/172.31.7.191:3181 - R:/172.31.7.191:56482]
13:30:00.055 [bookkeeper-io-16-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: [id: 0x8bc236b9, L:/172.31.7.191:56482 - R:172.31.7.191/172.31.7.191:3181]
13:30:00.055 [bookkeeper-io-16-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 172.31.7.191:3181
13:30:00.055 [bookkeeper-io-16-1] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xccf468da, L:/172.31.7.191:59984]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: /172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.064 [bookkeeper-io-16-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0x8bc236b9, L:/172.31.7.191:56482 - R:172.31.7.191/172.31.7.191:3181] authenticated as BookKeeperPrincipal{ANONYMOUS}
13:30:00.088 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.088 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.088 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.088 [ReplicationWorker] WARN  org.apache.bookkeeper.replication.ReplicationWorker - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1012) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1061) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.090 [bookkeeper-io-16-3] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x33072636, L:/172.31.7.191:59988]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.095 [ReplicationWorker] ERROR org.apache.bookkeeper.replication.ReplicationWorker - ReplicationWorker failed to replicate Ledger : 2 for 0 number of times, so deferring the ledger lock release by 9375 msecs
13:30:00.107 [bookkeeper-io-16-4] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xd94e8c74, L:/172.31.7.191:59990]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.112 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.113 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.113 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.113 [ReplicationWorker] WARN  org.apache.bookkeeper.replication.ReplicationWorker - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1012) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1061) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.117 [bookkeeper-io-16-5] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x98daa85d, L:/172.31.7.191:59992]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.118 [ReplicationWorker] ERROR org.apache.bookkeeper.replication.ReplicationWorker - ReplicationWorker failed to replicate Ledger : 29 for 0 number of times, so deferring the ledger lock release by 9375 msecs
13:30:00.126 [bookkeeper-io-16-6] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xc30e5b05, L:/172.31.7.191:59994]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.131 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.132 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.132 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.132 [ReplicationWorker] WARN  org.apache.bookkeeper.replication.ReplicationWorker - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1012) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1061) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.135 [bookkeeper-io-16-7] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x1d836862, L:/172.31.7.191:59996]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.137 [ReplicationWorker] ERROR org.apache.bookkeeper.replication.ReplicationWorker - ReplicationWorker failed to replicate Ledger : 41 for 0 number of times, so deferring the ledger lock release by 9375 msecs
13:30:00.146 [bookkeeper-io-16-8] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xf416636d, L:/172.31.7.191:59998]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.150 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.150 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.150 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.150 [ReplicationWorker] WARN  org.apache.bookkeeper.replication.ReplicationWorker - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1012) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1061) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.152 [bookkeeper-io-16-9] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x389c7c67, L:/172.31.7.191:60000]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.153 [ReplicationWorker] ERROR org.apache.bookkeeper.replication.ReplicationWorker - ReplicationWorker failed to replicate Ledger : 40 for 0 number of times, so deferring the ledger lock release by 9375 msecs
13:30:00.164 [bookkeeper-io-16-10] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x077c6398, L:/172.31.7.191:60002]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.169 [BookKeeperClientWorker-OrderedExecutor-0-0] INFO  com.scurrilous.circe.checksum.Crc32cIntChecksum - SSE4.2 CRC32C provider initialized
13:30:00.172 [bookkeeper-io-16-11] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x3b925ff4, L:/172.31.7.191:60004]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.184 [bookkeeper-io-16-12] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x9451f60e, L:/172.31.7.191:60006]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.186 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.186 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.186 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.186 [ReplicationWorker] WARN  org.apache.bookkeeper.replication.ReplicationWorker - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1012) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1061) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.188 [bookkeeper-io-16-13] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x68f73ade, L:/172.31.7.191:60008]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.188 [ReplicationWorker] ERROR org.apache.bookkeeper.replication.ReplicationWorker - ReplicationWorker failed to replicate Ledger : 55 for 0 number of times, so deferring the ledger lock release by 9375 msecs
13:30:00.196 [bookkeeper-io-16-14] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x1ea11f37, L:/172.31.7.191:60010]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.198 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.198 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.198 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.198 [ReplicationWorker] WARN  org.apache.bookkeeper.replication.ReplicationWorker - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1012) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1061) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.199 [bookkeeper-io-16-15] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xc5dd963e, L:/172.31.7.191:60012]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.200 [ReplicationWorker] ERROR org.apache.bookkeeper.replication.ReplicationWorker - ReplicationWorker failed to replicate Ledger : 26 for 0 number of times, so deferring the ledger lock release by 9375 msecs
13:30:00.209 [bookkeeper-io-16-16] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x2c549ba5, L:/172.31.7.191:60014]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.211 [PendingReplicationTimer] WARN  org.apache.bookkeeper.replication.ReplicationWorker - Missing bookie(s) from last segment. Opening Ledger32 for Recovery.
13:30:00.211 [bookkeeper-io-16-17] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xe8c83a0b, L:/172.31.7.191:60016]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.212 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.212 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.212 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.212 [ReplicationWorker] WARN  org.apache.bookkeeper.replication.ReplicationWorker - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1012) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1061) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.214 [bookkeeper-io-16-18] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x68b002ce, L:/172.31.7.191:60018]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.215 [ReplicationWorker] ERROR org.apache.bookkeeper.replication.ReplicationWorker - ReplicationWorker failed to replicate Ledger : 12 for 0 number of times, so deferring the ledger lock release by 9375 msecs
13:30:00.225 [bookkeeper-io-16-19] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x1d798ceb, L:/172.31.7.191:60020]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.225 [BookKeeperClientWorker-OrderedExecutor-4-0] ERROR org.apache.bookkeeper.client.ReadLastConfirmedOp - While readLastConfirmed ledger: 4 did not hear success responses from all quorums
13:30:00.226 [ReplicationWorker] INFO  org.apache.bookkeeper.replication.ReplicationWorker - BKReadException while rereplicating ledger 4. Enough Bookies might not have available So, no harm to continue
13:30:00.227 [BookieHighPriorityThread-3181-OrderedExecutor-0-0] INFO  org.apache.bookkeeper.proto.ReadEntryProcessorV3 - Ledger fence request received for ledger: 32 from address: /172.31.7.191:56482
13:30:00.228 [bookkeeper-io-16-20] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xe6d606ea, L:/172.31.7.191:60022]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.236 [bookkeeper-io-16-21] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x1c3df127, L:/172.31.7.191:60024]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.239 [bookkeeper-io-16-22] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x7b974360, L:/172.31.7.191:60026]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.243 [bookkeeper-io-16-23] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xacf35c26, L:/172.31.7.191:60028]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.247 [BookKeeperClientWorker-OrderedExecutor-0-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L32 E8718 from bookie: 172.31.15.110:3181
13:30:00.247 [bookkeeper-io-16-24] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x48affdc0, L:/172.31.7.191:60030]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.249 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (32, 8717): Bookie handle is not available
13:30:00.249 [bookkeeper-io-16-25] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xa651edc1, L:/172.31.7.191:60032]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.253 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.253 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.253 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.253 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.253 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.253 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.253 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 32
13:30:00.253 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L32 E8717
13:30:00.253 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8718 while recovering ledger: 32
13:30:00.254 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L32 E8718
13:30:00.254 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8719 while recovering ledger: 32
13:30:00.254 [PendingReplicationTimer] ERROR org.apache.bookkeeper.replication.ReplicationWorker - BKException while fencing the ledger 32 for rereplication of postponed ledgers
org.apache.bookkeeper.client.BKException$BKLedgerRecoveryException: Error while recovering ledger
	at org.apache.bookkeeper.client.SyncCallbackUtils.finish(SyncCallbackUtils.java:83) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.SyncCallbackUtils$SyncOpenCallback.openComplete(SyncCallbackUtils.java:157) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp.openComplete(LedgerOpenOp.java:232) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:201) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:193) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.util.OrderedGenericCallback.operationComplete(OrderedGenericCallback.java:62) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookkeeperInternalCallbacks$TimedGenericCallback.operationComplete(BookkeeperInternalCallbacks.java:189) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.lambda$recover$5(ReadOnlyLedgerHandle.java:295) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990) ~[?:1.8.0_265]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.submitCallback(LedgerRecoveryOp.java:136) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.addComplete(LedgerRecoveryOp.java:217) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.AsyncCallback$AddCallback.addCompleteWithLatency(AsyncCallback.java:91) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.submitCallback(PendingAddOp.java:430) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1784) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1769) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleUnrecoverableErrorDuringAdd(ReadOnlyLedgerHandle.java:244) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleBookieFailure(ReadOnlyLedgerHandle.java:236) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:377) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:292) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) ~[org.apache.bookkeeper-bookkeeper-common-4.10.0.jar:4.10.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_265]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_265]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) ~[?:1.8.0_265]
13:30:00.259 [bookkeeper-io-16-26] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x31626def, L:/172.31.7.191:60034]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.261 [bookkeeper-io-16-27] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x93f2d928, L:/172.31.7.191:60036]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.269 [bookkeeper-io-16-28] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x5c6be2a4, L:/172.31.7.191:60038]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.271 [PendingReplicationTimer] WARN  org.apache.bookkeeper.replication.ReplicationWorker - Missing bookie(s) from last segment. Opening Ledger28 for Recovery.
13:30:00.272 [bookkeeper-io-16-29] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x0c95df65, L:/172.31.7.191:60040]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.272 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.272 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.272 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.272 [ReplicationWorker] WARN  org.apache.bookkeeper.replication.ReplicationWorker - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1012) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1061) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.273 [bookkeeper-io-16-30] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x482f1735, L:/172.31.7.191:60042]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.274 [ReplicationWorker] ERROR org.apache.bookkeeper.replication.ReplicationWorker - ReplicationWorker failed to replicate Ledger : 13 for 0 number of times, so deferring the ledger lock release by 9375 msecs
13:30:00.274 [BookieHighPriorityThread-3181-OrderedExecutor-4-0] INFO  org.apache.bookkeeper.proto.ReadEntryProcessorV3 - Ledger fence request received for ledger: 28 from address: /172.31.7.191:56482
13:30:00.275 [bookkeeper-io-16-31] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xc863369d, L:/172.31.7.191:60044]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.280 [bookkeeper-io-16-32] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x86ecee78, L:/172.31.7.191:60046]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.281 [BookKeeperClientWorker-OrderedExecutor-12-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L28 E8719 from bookie: 172.31.15.110:3181
13:30:00.281 [BookKeeperClientWorker-OrderedExecutor-12-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (28, 8718): Bookie handle is not available
13:30:00.281 [BookKeeperClientWorker-OrderedExecutor-12-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.281 [BookKeeperClientWorker-OrderedExecutor-12-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.281 [BookKeeperClientWorker-OrderedExecutor-12-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.281 [BookKeeperClientWorker-OrderedExecutor-12-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.281 [BookKeeperClientWorker-OrderedExecutor-12-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.281 [BookKeeperClientWorker-OrderedExecutor-12-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.282 [BookKeeperClientWorker-OrderedExecutor-12-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 28
13:30:00.282 [BookKeeperClientWorker-OrderedExecutor-12-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L28 E8718
13:30:00.282 [BookKeeperClientWorker-OrderedExecutor-12-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8719 while recovering ledger: 28
13:30:00.282 [PendingReplicationTimer] ERROR org.apache.bookkeeper.replication.ReplicationWorker - BKException while fencing the ledger 28 for rereplication of postponed ledgers
org.apache.bookkeeper.client.BKException$BKLedgerRecoveryException: Error while recovering ledger
	at org.apache.bookkeeper.client.SyncCallbackUtils.finish(SyncCallbackUtils.java:83) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.SyncCallbackUtils$SyncOpenCallback.openComplete(SyncCallbackUtils.java:157) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp.openComplete(LedgerOpenOp.java:232) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:201) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:193) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.util.OrderedGenericCallback.operationComplete(OrderedGenericCallback.java:62) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookkeeperInternalCallbacks$TimedGenericCallback.operationComplete(BookkeeperInternalCallbacks.java:189) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.lambda$recover$5(ReadOnlyLedgerHandle.java:295) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990) ~[?:1.8.0_265]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.submitCallback(LedgerRecoveryOp.java:136) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.addComplete(LedgerRecoveryOp.java:217) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.AsyncCallback$AddCallback.addCompleteWithLatency(AsyncCallback.java:91) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.submitCallback(PendingAddOp.java:430) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1784) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1769) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleUnrecoverableErrorDuringAdd(ReadOnlyLedgerHandle.java:244) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleBookieFailure(ReadOnlyLedgerHandle.java:236) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:377) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:292) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) ~[org.apache.bookkeeper-bookkeeper-common-4.10.0.jar:4.10.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_265]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_265]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) ~[?:1.8.0_265]
13:30:00.283 [bookkeeper-io-16-1] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x9b00bd63, L:/172.31.7.191:60048]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.285 [BookKeeperClientWorker-OrderedExecutor-12-0] WARN  org.apache.bookkeeper.client.LedgerRecoveryOp - Successfully read entry 8719 for ledger 28, but readDone is already false
13:30:00.285 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.286 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.286 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.286 [ReplicationWorker] WARN  org.apache.bookkeeper.replication.ReplicationWorker - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1012) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1061) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.286 [bookkeeper-io-16-2] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x22338626, L:/172.31.7.191:60050]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.287 [PendingReplicationTimer] WARN  org.apache.bookkeeper.replication.ReplicationWorker - Missing bookie(s) from last segment. Opening Ledger63 for Recovery.
13:30:00.287 [bookkeeper-io-16-3] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xe8ca1f1a, L:/172.31.7.191:60052]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.288 [ReplicationWorker] ERROR org.apache.bookkeeper.replication.ReplicationWorker - ReplicationWorker failed to replicate Ledger : 64 for 0 number of times, so deferring the ledger lock release by 9375 msecs
13:30:00.290 [BookieHighPriorityThread-3181-OrderedExecutor-7-0] INFO  org.apache.bookkeeper.proto.ReadEntryProcessorV3 - Ledger fence request received for ledger: 63 from address: /172.31.7.191:56482
13:30:00.291 [bookkeeper-io-16-4] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x00e1820f, L:/172.31.7.191:60054]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.295 [ReplicationWorker] INFO  org.apache.bookkeeper.replication.ReplicationWorker - Ledger replicated successfully. ledger id is: 5
13:30:00.297 [bookkeeper-io-16-5] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x1e8b2984, L:/172.31.7.191:60056]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.299 [BookKeeperClientWorker-OrderedExecutor-15-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L63 E8717 from bookie: 172.31.15.110:3181
13:30:00.299 [bookkeeper-io-16-6] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x5c48d359, L:/172.31.7.191:60058]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.299 [BookKeeperClientWorker-OrderedExecutor-15-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (63, 8716): Bookie handle is not available
13:30:00.300 [BookKeeperClientWorker-OrderedExecutor-15-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.300 [BookKeeperClientWorker-OrderedExecutor-15-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.300 [BookKeeperClientWorker-OrderedExecutor-15-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.300 [BookKeeperClientWorker-OrderedExecutor-15-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.300 [BookKeeperClientWorker-OrderedExecutor-15-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.300 [BookKeeperClientWorker-OrderedExecutor-15-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.300 [BookKeeperClientWorker-OrderedExecutor-15-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 63
13:30:00.300 [BookKeeperClientWorker-OrderedExecutor-15-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L63 E8716
13:30:00.300 [BookKeeperClientWorker-OrderedExecutor-15-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8717 while recovering ledger: 63
13:30:00.300 [BookKeeperClientWorker-OrderedExecutor-15-0] WARN  org.apache.bookkeeper.client.LedgerRecoveryOp - Successfully read entry 8717 for ledger 63, but readDone is already false
13:30:00.300 [PendingReplicationTimer] ERROR org.apache.bookkeeper.replication.ReplicationWorker - BKException while fencing the ledger 63 for rereplication of postponed ledgers
org.apache.bookkeeper.client.BKException$BKLedgerRecoveryException: Error while recovering ledger
	at org.apache.bookkeeper.client.SyncCallbackUtils.finish(SyncCallbackUtils.java:83) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.SyncCallbackUtils$SyncOpenCallback.openComplete(SyncCallbackUtils.java:157) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp.openComplete(LedgerOpenOp.java:232) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:201) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:193) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.util.OrderedGenericCallback.operationComplete(OrderedGenericCallback.java:62) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookkeeperInternalCallbacks$TimedGenericCallback.operationComplete(BookkeeperInternalCallbacks.java:189) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.lambda$recover$5(ReadOnlyLedgerHandle.java:295) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990) ~[?:1.8.0_265]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.submitCallback(LedgerRecoveryOp.java:136) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.addComplete(LedgerRecoveryOp.java:217) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.AsyncCallback$AddCallback.addCompleteWithLatency(AsyncCallback.java:91) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.submitCallback(PendingAddOp.java:430) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1784) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1769) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleUnrecoverableErrorDuringAdd(ReadOnlyLedgerHandle.java:244) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleBookieFailure(ReadOnlyLedgerHandle.java:236) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:377) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:292) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) ~[org.apache.bookkeeper-bookkeeper-common-4.10.0.jar:4.10.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_265]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_265]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) ~[?:1.8.0_265]
13:30:00.304 [bookkeeper-io-16-7] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x7063d772, L:/172.31.7.191:60060]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.305 [PendingReplicationTimer] WARN  org.apache.bookkeeper.replication.ReplicationWorker - Missing bookie(s) from last segment. Opening Ledger30 for Recovery.
13:30:00.311 [BookieHighPriorityThread-3181-OrderedExecutor-6-0] INFO  org.apache.bookkeeper.proto.ReadEntryProcessorV3 - Ledger fence request received for ledger: 30 from address: /172.31.7.191:56482
13:30:00.311 [bookkeeper-io-16-8] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xc6d53e0f, L:/172.31.7.191:60062]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.313 [bookkeeper-io-16-9] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x764671d7, L:/172.31.7.191:60064]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.316 [bookkeeper-io-16-10] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x775180e0, L:/172.31.7.191:60066]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.317 [BookKeeperClientWorker-OrderedExecutor-14-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L30 E8717 from bookie: 172.31.15.110:3181
13:30:00.318 [bookkeeper-io-16-11] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x586246c9, L:/172.31.7.191:60068]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.319 [BookKeeperClientWorker-OrderedExecutor-14-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (30, 8717): Bookie handle is not available
13:30:00.319 [bookkeeper-io-16-12] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x750925a1, L:/172.31.7.191:60070]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.319 [BookKeeperClientWorker-OrderedExecutor-14-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.319 [BookKeeperClientWorker-OrderedExecutor-14-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.319 [BookKeeperClientWorker-OrderedExecutor-14-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.320 [BookKeeperClientWorker-OrderedExecutor-14-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.320 [BookKeeperClientWorker-OrderedExecutor-14-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.320 [BookKeeperClientWorker-OrderedExecutor-14-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.320 [BookKeeperClientWorker-OrderedExecutor-14-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 30
13:30:00.320 [BookKeeperClientWorker-OrderedExecutor-14-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L30 E8717
13:30:00.320 [BookKeeperClientWorker-OrderedExecutor-14-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8718 while recovering ledger: 30
13:30:00.320 [BookKeeperClientWorker-OrderedExecutor-14-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L30 E8718
13:30:00.320 [BookKeeperClientWorker-OrderedExecutor-14-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8719 while recovering ledger: 30
13:30:00.320 [BookKeeperClientWorker-OrderedExecutor-14-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L30 E8719 from bookie: 172.31.15.110:3181
13:30:00.320 [BookKeeperClientWorker-OrderedExecutor-14-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (30, 8718): Bookie handle is not available
13:30:00.321 [BookKeeperClientWorker-OrderedExecutor-14-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.321 [BookKeeperClientWorker-OrderedExecutor-14-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.320 [PendingReplicationTimer] ERROR org.apache.bookkeeper.replication.ReplicationWorker - BKException while fencing the ledger 30 for rereplication of postponed ledgers
org.apache.bookkeeper.client.BKException$BKLedgerRecoveryException: Error while recovering ledger
	at org.apache.bookkeeper.client.SyncCallbackUtils.finish(SyncCallbackUtils.java:83) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.SyncCallbackUtils$SyncOpenCallback.openComplete(SyncCallbackUtils.java:157) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp.openComplete(LedgerOpenOp.java:232) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:201) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:193) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.util.OrderedGenericCallback.operationComplete(OrderedGenericCallback.java:62) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookkeeperInternalCallbacks$TimedGenericCallback.operationComplete(BookkeeperInternalCallbacks.java:189) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.lambda$recover$5(ReadOnlyLedgerHandle.java:295) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990) ~[?:1.8.0_265]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.submitCallback(LedgerRecoveryOp.java:136) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.addComplete(LedgerRecoveryOp.java:217) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.AsyncCallback$AddCallback.addCompleteWithLatency(AsyncCallback.java:91) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.submitCallback(PendingAddOp.java:430) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1784) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1769) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleUnrecoverableErrorDuringAdd(ReadOnlyLedgerHandle.java:244) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleBookieFailure(ReadOnlyLedgerHandle.java:236) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:377) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:292) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) ~[org.apache.bookkeeper-bookkeeper-common-4.10.0.jar:4.10.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_265]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_265]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) ~[?:1.8.0_265]
13:30:00.321 [BookKeeperClientWorker-OrderedExecutor-14-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.321 [BookKeeperClientWorker-OrderedExecutor-14-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.321 [BookKeeperClientWorker-OrderedExecutor-14-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.321 [BookKeeperClientWorker-OrderedExecutor-14-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.321 [BookKeeperClientWorker-OrderedExecutor-14-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 30
13:30:00.322 [bookkeeper-io-16-13] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x4d1b9ca4, L:/172.31.7.191:60072]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.324 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.324 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.324 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.324 [ReplicationWorker] WARN  org.apache.bookkeeper.replication.ReplicationWorker - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1012) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1061) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.325 [bookkeeper-io-16-14] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xf472bc71, L:/172.31.7.191:60074]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.325 [ReplicationWorker] ERROR org.apache.bookkeeper.replication.ReplicationWorker - ReplicationWorker failed to replicate Ledger : 16 for 0 number of times, so deferring the ledger lock release by 9375 msecs
13:30:00.331 [bookkeeper-io-16-15] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x726793ed, L:/172.31.7.191:60076]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.333 [bookkeeper-io-16-16] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xbbac30a2, L:/172.31.7.191:60078]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.342 [bookkeeper-io-16-17] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x22394454, L:/172.31.7.191:60080]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.344 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.344 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.344 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.344 [ReplicationWorker] WARN  org.apache.bookkeeper.replication.ReplicationWorker - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1012) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1061) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.345 [bookkeeper-io-16-18] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xc0b2a352, L:/172.31.7.191:60082]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.345 [ReplicationWorker] ERROR org.apache.bookkeeper.replication.ReplicationWorker - ReplicationWorker failed to replicate Ledger : 97 for 0 number of times, so deferring the ledger lock release by 9375 msecs
13:30:00.346 [bookkeeper-io-16-19] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x851f3301, L:/172.31.7.191:60084]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.348 [PendingReplicationTimer] WARN  org.apache.bookkeeper.replication.ReplicationWorker - Missing bookie(s) from last segment. Opening Ledger20 for Recovery.
13:30:00.351 [BookieHighPriorityThread-3181-OrderedExecutor-4-0] INFO  org.apache.bookkeeper.proto.ReadEntryProcessorV3 - Ledger fence request received for ledger: 20 from address: /172.31.7.191:56482
13:30:00.351 [bookkeeper-io-16-20] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xd09887fd, L:/172.31.7.191:60086]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.352 [bookkeeper-io-16-21] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x6741d3f1, L:/172.31.7.191:60088]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.355 [bookkeeper-io-16-22] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x2931f7b7, L:/172.31.7.191:60090]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.356 [BookKeeperClientWorker-OrderedExecutor-4-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L20 E8721 from bookie: 172.31.15.110:3181
13:30:00.357 [bookkeeper-io-16-23] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xb34a8d52, L:/172.31.7.191:60092]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.358 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (20, 8721): Bookie handle is not available
13:30:00.358 [bookkeeper-io-16-24] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x58fb51bb, L:/172.31.7.191:60094]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.358 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.358 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.358 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.358 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.358 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.358 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.358 [BookKeeperClientWorker-OrderedExecutor-4-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 20
13:30:00.358 [BookKeeperClientWorker-OrderedExecutor-4-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L20 E8721
13:30:00.358 [BookKeeperClientWorker-OrderedExecutor-4-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8722 while recovering ledger: 20
13:30:00.358 [BookKeeperClientWorker-OrderedExecutor-4-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L20 E8722
13:30:00.358 [BookKeeperClientWorker-OrderedExecutor-4-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8723 while recovering ledger: 20
13:30:00.358 [BookKeeperClientWorker-OrderedExecutor-4-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L20 E8723 from bookie: 172.31.15.110:3181
13:30:00.359 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (20, 8722): Bookie handle is not available
13:30:00.359 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.358 [PendingReplicationTimer] ERROR org.apache.bookkeeper.replication.ReplicationWorker - BKException while fencing the ledger 20 for rereplication of postponed ledgers
org.apache.bookkeeper.client.BKException$BKLedgerRecoveryException: Error while recovering ledger
	at org.apache.bookkeeper.client.SyncCallbackUtils.finish(SyncCallbackUtils.java:83) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.SyncCallbackUtils$SyncOpenCallback.openComplete(SyncCallbackUtils.java:157) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp.openComplete(LedgerOpenOp.java:232) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:201) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:193) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.util.OrderedGenericCallback.operationComplete(OrderedGenericCallback.java:62) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookkeeperInternalCallbacks$TimedGenericCallback.operationComplete(BookkeeperInternalCallbacks.java:189) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.lambda$recover$5(ReadOnlyLedgerHandle.java:295) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990) ~[?:1.8.0_265]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.submitCallback(LedgerRecoveryOp.java:136) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.addComplete(LedgerRecoveryOp.java:217) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.AsyncCallback$AddCallback.addCompleteWithLatency(AsyncCallback.java:91) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.submitCallback(PendingAddOp.java:430) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1784) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1769) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleUnrecoverableErrorDuringAdd(ReadOnlyLedgerHandle.java:244) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleBookieFailure(ReadOnlyLedgerHandle.java:236) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:377) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:292) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) ~[org.apache.bookkeeper-bookkeeper-common-4.10.0.jar:4.10.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_265]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_265]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) ~[?:1.8.0_265]
13:30:00.359 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.359 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.359 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.359 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.359 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.359 [BookKeeperClientWorker-OrderedExecutor-4-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 20
13:30:00.361 [bookkeeper-io-16-25] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xa439efaf, L:/172.31.7.191:60096]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.363 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.363 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.363 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.363 [ReplicationWorker] WARN  org.apache.bookkeeper.replication.ReplicationWorker - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1012) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1061) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.364 [bookkeeper-io-16-26] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x4bd854ff, L:/172.31.7.191:60098]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.364 [ReplicationWorker] ERROR org.apache.bookkeeper.replication.ReplicationWorker - ReplicationWorker failed to replicate Ledger : 89 for 0 number of times, so deferring the ledger lock release by 9375 msecs
13:30:00.367 [bookkeeper-io-16-27] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x5aa67651, L:/172.31.7.191:60100]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.369 [PendingReplicationTimer] WARN  org.apache.bookkeeper.replication.ReplicationWorker - Missing bookie(s) from last segment. Opening Ledger77 for Recovery.
13:30:00.370 [bookkeeper-io-16-28] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x1f626cff, L:/172.31.7.191:60102]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.372 [BookieHighPriorityThread-3181-OrderedExecutor-5-0] INFO  org.apache.bookkeeper.proto.ReadEntryProcessorV3 - Ledger fence request received for ledger: 77 from address: /172.31.7.191:56482
13:30:00.372 [bookkeeper-io-16-29] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x7d265d39, L:/172.31.7.191:60104]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.373 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.373 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.373 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.373 [ReplicationWorker] WARN  org.apache.bookkeeper.replication.ReplicationWorker - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1012) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1061) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.374 [bookkeeper-io-16-30] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xc1a43a66, L:/172.31.7.191:60106]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.374 [ReplicationWorker] ERROR org.apache.bookkeeper.replication.ReplicationWorker - ReplicationWorker failed to replicate Ledger : 22 for 0 number of times, so deferring the ledger lock release by 9375 msecs
13:30:00.376 [bookkeeper-io-16-31] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xe3e4d8a5, L:/172.31.7.191:60108]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.377 [BookKeeperClientWorker-OrderedExecutor-13-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L77 E8958 from bookie: 172.31.15.110:3181
13:30:00.378 [bookkeeper-io-16-32] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x58c6a78c, L:/172.31.7.191:60110]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.378 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (77, 8958): Bookie handle is not available
13:30:00.378 [bookkeeper-io-16-1] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x27e0585b, L:/172.31.7.191:60112]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.379 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.379 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.379 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.379 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.379 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.379 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.379 [BookKeeperClientWorker-OrderedExecutor-13-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 77
13:30:00.379 [BookKeeperClientWorker-OrderedExecutor-13-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L77 E8958
13:30:00.379 [BookKeeperClientWorker-OrderedExecutor-13-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8959 while recovering ledger: 77
13:30:00.379 [BookKeeperClientWorker-OrderedExecutor-13-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L77 E8959
13:30:00.379 [BookKeeperClientWorker-OrderedExecutor-13-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8960 while recovering ledger: 77
13:30:00.379 [BookKeeperClientWorker-OrderedExecutor-13-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L77 E8960 from bookie: 172.31.15.110:3181
13:30:00.379 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (77, 8959): Bookie handle is not available
13:30:00.379 [PendingReplicationTimer] ERROR org.apache.bookkeeper.replication.ReplicationWorker - BKException while fencing the ledger 77 for rereplication of postponed ledgers
org.apache.bookkeeper.client.BKException$BKLedgerRecoveryException: Error while recovering ledger
	at org.apache.bookkeeper.client.SyncCallbackUtils.finish(SyncCallbackUtils.java:83) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.SyncCallbackUtils$SyncOpenCallback.openComplete(SyncCallbackUtils.java:157) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp.openComplete(LedgerOpenOp.java:232) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:201) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:193) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.util.OrderedGenericCallback.operationComplete(OrderedGenericCallback.java:62) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookkeeperInternalCallbacks$TimedGenericCallback.operationComplete(BookkeeperInternalCallbacks.java:189) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.lambda$recover$5(ReadOnlyLedgerHandle.java:295) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990) ~[?:1.8.0_265]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.submitCallback(LedgerRecoveryOp.java:136) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.addComplete(LedgerRecoveryOp.java:217) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.AsyncCallback$AddCallback.addCompleteWithLatency(AsyncCallback.java:91) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.submitCallback(PendingAddOp.java:430) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1784) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1769) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleUnrecoverableErrorDuringAdd(ReadOnlyLedgerHandle.java:244) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleBookieFailure(ReadOnlyLedgerHandle.java:236) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:377) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:292) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) ~[org.apache.bookkeeper-bookkeeper-common-4.10.0.jar:4.10.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_265]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_265]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) ~[?:1.8.0_265]
13:30:00.380 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.380 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.380 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.380 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.380 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.380 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.380 [BookKeeperClientWorker-OrderedExecutor-13-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 77
13:30:00.383 [bookkeeper-io-16-2] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xeae62ee2, L:/172.31.7.191:60114]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.385 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.385 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.385 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.385 [ReplicationWorker] WARN  org.apache.bookkeeper.replication.ReplicationWorker - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1012) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1061) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.385 [bookkeeper-io-16-3] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xe90beae2, L:/172.31.7.191:60116]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.387 [PendingReplicationTimer] WARN  org.apache.bookkeeper.replication.ReplicationWorker - Missing bookie(s) from last segment. Opening Ledger36 for Recovery.
13:30:00.386 [bookkeeper-io-16-4] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x5ff9da78, L:/172.31.7.191:60118]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.387 [ReplicationWorker] ERROR org.apache.bookkeeper.replication.ReplicationWorker - ReplicationWorker failed to replicate Ledger : 27 for 0 number of times, so deferring the ledger lock release by 9375 msecs
13:30:00.389 [BookieHighPriorityThread-3181-OrderedExecutor-4-0] INFO  org.apache.bookkeeper.proto.ReadEntryProcessorV3 - Ledger fence request received for ledger: 36 from address: /172.31.7.191:56482
13:30:00.390 [bookkeeper-io-16-5] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x11171ba4, L:/172.31.7.191:60120]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.394 [bookkeeper-io-16-6] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x8eb0473d, L:/172.31.7.191:60122]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.395 [BookKeeperClientWorker-OrderedExecutor-4-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L36 E8721 from bookie: 172.31.15.110:3181
13:30:00.395 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (36, 8720): Bookie handle is not available
13:30:00.395 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.395 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.395 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.395 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.395 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.395 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.395 [BookKeeperClientWorker-OrderedExecutor-4-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 36
13:30:00.395 [BookKeeperClientWorker-OrderedExecutor-4-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L36 E8720
13:30:00.395 [BookKeeperClientWorker-OrderedExecutor-4-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8721 while recovering ledger: 36
13:30:00.396 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.LedgerRecoveryOp - Successfully read entry 8721 for ledger 36, but readDone is already false
13:30:00.396 [bookkeeper-io-16-7] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x7744a391, L:/172.31.7.191:60124]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.395 [PendingReplicationTimer] ERROR org.apache.bookkeeper.replication.ReplicationWorker - BKException while fencing the ledger 36 for rereplication of postponed ledgers
org.apache.bookkeeper.client.BKException$BKLedgerRecoveryException: Error while recovering ledger
	at org.apache.bookkeeper.client.SyncCallbackUtils.finish(SyncCallbackUtils.java:83) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.SyncCallbackUtils$SyncOpenCallback.openComplete(SyncCallbackUtils.java:157) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp.openComplete(LedgerOpenOp.java:232) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:201) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:193) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.util.OrderedGenericCallback.operationComplete(OrderedGenericCallback.java:62) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookkeeperInternalCallbacks$TimedGenericCallback.operationComplete(BookkeeperInternalCallbacks.java:189) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.lambda$recover$5(ReadOnlyLedgerHandle.java:295) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990) ~[?:1.8.0_265]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.submitCallback(LedgerRecoveryOp.java:136) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.addComplete(LedgerRecoveryOp.java:217) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.AsyncCallback$AddCallback.addCompleteWithLatency(AsyncCallback.java:91) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.submitCallback(PendingAddOp.java:430) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1784) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1769) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleUnrecoverableErrorDuringAdd(ReadOnlyLedgerHandle.java:244) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleBookieFailure(ReadOnlyLedgerHandle.java:236) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:377) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:292) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) ~[org.apache.bookkeeper-bookkeeper-common-4.10.0.jar:4.10.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_265]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_265]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) ~[?:1.8.0_265]
13:30:00.397 [bookkeeper-io-16-8] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xeaca1245, L:/172.31.7.191:60126]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.405 [bookkeeper-io-16-9] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xce552c36, L:/172.31.7.191:60128]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.407 [bookkeeper-io-16-10] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x06a2a7fe, L:/172.31.7.191:60130]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.416 [bookkeeper-io-16-11] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x76f2f803, L:/172.31.7.191:60132]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.417 [bookkeeper-io-16-12] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x7d8ec408, L:/172.31.7.191:60134]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.426 [bookkeeper-io-16-13] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xc6e2e9cc, L:/172.31.7.191:60136]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.429 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.429 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.429 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.429 [ReplicationWorker] WARN  org.apache.bookkeeper.replication.ReplicationWorker - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1012) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1061) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.429 [bookkeeper-io-16-14] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xfa586ec8, L:/172.31.7.191:60138]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.430 [ReplicationWorker] ERROR org.apache.bookkeeper.replication.ReplicationWorker - ReplicationWorker failed to replicate Ledger : 103 for 0 number of times, so deferring the ledger lock release by 9375 msecs
13:30:00.430 [bookkeeper-io-16-15] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x0334f3c7, L:/172.31.7.191:60140]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.431 [PendingReplicationTimer] WARN  org.apache.bookkeeper.replication.ReplicationWorker - Missing bookie(s) from last segment. Opening Ledger71 for Recovery.
13:30:00.434 [BookieHighPriorityThread-3181-OrderedExecutor-7-0] INFO  org.apache.bookkeeper.proto.ReadEntryProcessorV3 - Ledger fence request received for ledger: 71 from address: /172.31.7.191:56482
13:30:00.435 [bookkeeper-io-16-16] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xdd1775a1, L:/172.31.7.191:60142]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.436 [bookkeeper-io-16-17] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x89fa1cfe, L:/172.31.7.191:60144]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.439 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.439 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.439 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.439 [ReplicationWorker] WARN  org.apache.bookkeeper.replication.ReplicationWorker - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1012) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1061) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.439 [bookkeeper-io-16-18] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xb4fcfedc, L:/172.31.7.191:60146]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.440 [BookKeeperClientWorker-OrderedExecutor-7-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L71 E8955 from bookie: 172.31.15.110:3181
13:30:00.440 [BookKeeperClientWorker-OrderedExecutor-7-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (71, 8954): Bookie handle is not available
13:30:00.440 [BookKeeperClientWorker-OrderedExecutor-7-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.440 [BookKeeperClientWorker-OrderedExecutor-7-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.440 [BookKeeperClientWorker-OrderedExecutor-7-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.440 [bookkeeper-io-16-19] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xf0d82e6e, L:/172.31.7.191:60148]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.440 [BookKeeperClientWorker-OrderedExecutor-7-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.440 [BookKeeperClientWorker-OrderedExecutor-7-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.440 [BookKeeperClientWorker-OrderedExecutor-7-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.440 [BookKeeperClientWorker-OrderedExecutor-7-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 71
13:30:00.441 [BookKeeperClientWorker-OrderedExecutor-7-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L71 E8954
13:30:00.441 [ReplicationWorker] ERROR org.apache.bookkeeper.replication.ReplicationWorker - ReplicationWorker failed to replicate Ledger : 115 for 0 number of times, so deferring the ledger lock release by 9375 msecs
13:30:00.441 [BookKeeperClientWorker-OrderedExecutor-7-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8955 while recovering ledger: 71
13:30:00.441 [BookKeeperClientWorker-OrderedExecutor-7-0] WARN  org.apache.bookkeeper.client.LedgerRecoveryOp - Successfully read entry 8955 for ledger 71, but readDone is already false
13:30:00.441 [PendingReplicationTimer] ERROR org.apache.bookkeeper.replication.ReplicationWorker - BKException while fencing the ledger 71 for rereplication of postponed ledgers
org.apache.bookkeeper.client.BKException$BKLedgerRecoveryException: Error while recovering ledger
	at org.apache.bookkeeper.client.SyncCallbackUtils.finish(SyncCallbackUtils.java:83) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.SyncCallbackUtils$SyncOpenCallback.openComplete(SyncCallbackUtils.java:157) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp.openComplete(LedgerOpenOp.java:232) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:201) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:193) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.util.OrderedGenericCallback.operationComplete(OrderedGenericCallback.java:62) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookkeeperInternalCallbacks$TimedGenericCallback.operationComplete(BookkeeperInternalCallbacks.java:189) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.lambda$recover$5(ReadOnlyLedgerHandle.java:295) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990) ~[?:1.8.0_265]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.submitCallback(LedgerRecoveryOp.java:136) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.addComplete(LedgerRecoveryOp.java:217) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.AsyncCallback$AddCallback.addCompleteWithLatency(AsyncCallback.java:91) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.submitCallback(PendingAddOp.java:430) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1784) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1769) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleUnrecoverableErrorDuringAdd(ReadOnlyLedgerHandle.java:244) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleBookieFailure(ReadOnlyLedgerHandle.java:236) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:377) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:292) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) ~[org.apache.bookkeeper-bookkeeper-common-4.10.0.jar:4.10.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_265]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_265]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) ~[?:1.8.0_265]
13:30:00.445 [bookkeeper-io-16-20] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x946af501, L:/172.31.7.191:60150]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.446 [PendingReplicationTimer] WARN  org.apache.bookkeeper.replication.ReplicationWorker - Missing bookie(s) from last segment. Opening Ledger117 for Recovery.
13:30:00.449 [bookkeeper-io-16-21] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x30b9b0b1, L:/172.31.7.191:60152]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.450 [BookieHighPriorityThread-3181-OrderedExecutor-5-0] INFO  org.apache.bookkeeper.proto.ReadEntryProcessorV3 - Ledger fence request received for ledger: 117 from address: /172.31.7.191:56482
13:30:00.451 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.451 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.452 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.451 [bookkeeper-io-16-22] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xc7952706, L:/172.31.7.191:60154]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.452 [ReplicationWorker] WARN  org.apache.bookkeeper.replication.ReplicationWorker - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1012) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1061) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.452 [bookkeeper-io-16-23] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x5018d67f, L:/172.31.7.191:60156]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.453 [ReplicationWorker] ERROR org.apache.bookkeeper.replication.ReplicationWorker - ReplicationWorker failed to replicate Ledger : 101 for 0 number of times, so deferring the ledger lock release by 9375 msecs
13:30:00.455 [bookkeeper-io-16-24] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x0279bdf5, L:/172.31.7.191:60158]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.455 [BookKeeperClientWorker-OrderedExecutor-5-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L117 E8965 from bookie: 172.31.15.110:3181
13:30:00.456 [bookkeeper-io-16-25] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xc6408f16, L:/172.31.7.191:60160]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.457 [bookkeeper-io-16-26] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x3d966061, L:/172.31.7.191:60162]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.457 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (117, 8965): Bookie handle is not available
13:30:00.458 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.458 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.458 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.458 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.458 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.458 [bookkeeper-io-16-27] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x6db7455a, L:/172.31.7.191:60164]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.459 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.459 [BookKeeperClientWorker-OrderedExecutor-5-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 117
13:30:00.459 [BookKeeperClientWorker-OrderedExecutor-5-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L117 E8965
13:30:00.459 [BookKeeperClientWorker-OrderedExecutor-5-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8966 while recovering ledger: 117
13:30:00.459 [BookKeeperClientWorker-OrderedExecutor-5-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L117 E8966
13:30:00.459 [BookKeeperClientWorker-OrderedExecutor-5-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8967 while recovering ledger: 117
13:30:00.459 [BookKeeperClientWorker-OrderedExecutor-5-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L117 E8967 from bookie: 172.31.15.110:3181
13:30:00.459 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (117, 8966): Bookie handle is not available
13:30:00.460 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.460 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.460 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.459 [PendingReplicationTimer] ERROR org.apache.bookkeeper.replication.ReplicationWorker - BKException while fencing the ledger 117 for rereplication of postponed ledgers
org.apache.bookkeeper.client.BKException$BKLedgerRecoveryException: Error while recovering ledger
	at org.apache.bookkeeper.client.SyncCallbackUtils.finish(SyncCallbackUtils.java:83) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.SyncCallbackUtils$SyncOpenCallback.openComplete(SyncCallbackUtils.java:157) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp.openComplete(LedgerOpenOp.java:232) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:201) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:193) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.util.OrderedGenericCallback.operationComplete(OrderedGenericCallback.java:62) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookkeeperInternalCallbacks$TimedGenericCallback.operationComplete(BookkeeperInternalCallbacks.java:189) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.lambda$recover$5(ReadOnlyLedgerHandle.java:295) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990) ~[?:1.8.0_265]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.submitCallback(LedgerRecoveryOp.java:136) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.addComplete(LedgerRecoveryOp.java:217) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.AsyncCallback$AddCallback.addCompleteWithLatency(AsyncCallback.java:91) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.submitCallback(PendingAddOp.java:430) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1784) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1769) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleUnrecoverableErrorDuringAdd(ReadOnlyLedgerHandle.java:244) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleBookieFailure(ReadOnlyLedgerHandle.java:236) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:377) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:292) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) ~[org.apache.bookkeeper-bookkeeper-common-4.10.0.jar:4.10.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_265]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_265]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) ~[?:1.8.0_265]
13:30:00.460 [bookkeeper-io-16-28] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x23f1b7f3, L:/172.31.7.191:60166]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.460 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.460 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.460 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.460 [BookKeeperClientWorker-OrderedExecutor-5-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 117
13:30:00.463 [bookkeeper-io-16-29] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xf6c185e7, L:/172.31.7.191:60168]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.464 [PendingReplicationTimer] WARN  org.apache.bookkeeper.replication.ReplicationWorker - Missing bookie(s) from last segment. Opening Ledger126 for Recovery.
13:30:00.467 [bookkeeper-io-16-30] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x7f24fb8e, L:/172.31.7.191:60170]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.467 [BookieHighPriorityThread-3181-OrderedExecutor-6-0] INFO  org.apache.bookkeeper.proto.ReadEntryProcessorV3 - Ledger fence request received for ledger: 126 from address: /172.31.7.191:56482
13:30:00.467 [bookkeeper-io-16-31] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x2ad4272c, L:/172.31.7.191:60172]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.472 [bookkeeper-io-16-32] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x327db6a4, L:/172.31.7.191:60174]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.472 [BookKeeperClientWorker-OrderedExecutor-14-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L126 E8954 from bookie: 172.31.15.110:3181
13:30:00.474 [bookkeeper-io-16-1] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x05e60623, L:/172.31.7.191:60176]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.474 [BookKeeperClientWorker-OrderedExecutor-14-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (126, 8954): Bookie handle is not available
13:30:00.474 [BookKeeperClientWorker-OrderedExecutor-14-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.474 [BookKeeperClientWorker-OrderedExecutor-14-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.474 [BookKeeperClientWorker-OrderedExecutor-14-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.474 [BookKeeperClientWorker-OrderedExecutor-14-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.475 [BookKeeperClientWorker-OrderedExecutor-14-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.475 [BookKeeperClientWorker-OrderedExecutor-14-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.475 [BookKeeperClientWorker-OrderedExecutor-14-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 126
13:30:00.475 [BookKeeperClientWorker-OrderedExecutor-14-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L126 E8954
13:30:00.475 [BookKeeperClientWorker-OrderedExecutor-14-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8955 while recovering ledger: 126
13:30:00.474 [bookkeeper-io-16-2] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xc54e36e0, L:/172.31.7.191:60178]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.475 [BookKeeperClientWorker-OrderedExecutor-14-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L126 E8955
13:30:00.475 [BookKeeperClientWorker-OrderedExecutor-14-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8956 while recovering ledger: 126
13:30:00.475 [BookKeeperClientWorker-OrderedExecutor-14-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L126 E8956 from bookie: 172.31.15.110:3181
13:30:00.475 [BookKeeperClientWorker-OrderedExecutor-14-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (126, 8955): Bookie handle is not available
13:30:00.475 [BookKeeperClientWorker-OrderedExecutor-14-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.475 [BookKeeperClientWorker-OrderedExecutor-14-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.475 [PendingReplicationTimer] ERROR org.apache.bookkeeper.replication.ReplicationWorker - BKException while fencing the ledger 126 for rereplication of postponed ledgers
org.apache.bookkeeper.client.BKException$BKLedgerRecoveryException: Error while recovering ledger
	at org.apache.bookkeeper.client.SyncCallbackUtils.finish(SyncCallbackUtils.java:83) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.SyncCallbackUtils$SyncOpenCallback.openComplete(SyncCallbackUtils.java:157) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp.openComplete(LedgerOpenOp.java:232) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:201) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:193) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.util.OrderedGenericCallback.operationComplete(OrderedGenericCallback.java:62) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookkeeperInternalCallbacks$TimedGenericCallback.operationComplete(BookkeeperInternalCallbacks.java:189) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.lambda$recover$5(ReadOnlyLedgerHandle.java:295) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990) ~[?:1.8.0_265]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.submitCallback(LedgerRecoveryOp.java:136) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.addComplete(LedgerRecoveryOp.java:217) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.AsyncCallback$AddCallback.addCompleteWithLatency(AsyncCallback.java:91) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.submitCallback(PendingAddOp.java:430) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1784) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1769) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleUnrecoverableErrorDuringAdd(ReadOnlyLedgerHandle.java:244) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleBookieFailure(ReadOnlyLedgerHandle.java:236) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:377) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:292) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) ~[org.apache.bookkeeper-bookkeeper-common-4.10.0.jar:4.10.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_265]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_265]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) ~[?:1.8.0_265]
13:30:00.475 [BookKeeperClientWorker-OrderedExecutor-14-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.475 [BookKeeperClientWorker-OrderedExecutor-14-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.476 [BookKeeperClientWorker-OrderedExecutor-14-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.476 [BookKeeperClientWorker-OrderedExecutor-14-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.476 [BookKeeperClientWorker-OrderedExecutor-14-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 126
13:30:00.476 [bookkeeper-io-16-3] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x273768f8, L:/172.31.7.191:60180]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.477 [bookkeeper-io-16-4] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x09531a97, L:/172.31.7.191:60182]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.483 [bookkeeper-io-16-5] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x137162e4, L:/172.31.7.191:60184]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.485 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.485 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.485 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.485 [ReplicationWorker] WARN  org.apache.bookkeeper.replication.ReplicationWorker - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1012) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1061) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.486 [bookkeeper-io-16-6] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xdcc6332c, L:/172.31.7.191:60186]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.486 [ReplicationWorker] ERROR org.apache.bookkeeper.replication.ReplicationWorker - ReplicationWorker failed to replicate Ledger : 87 for 0 number of times, so deferring the ledger lock release by 9375 msecs
13:30:00.492 [bookkeeper-io-16-7] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xf11dac9d, L:/172.31.7.191:60188]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.492 [PendingReplicationTimer] WARN  org.apache.bookkeeper.replication.ReplicationWorker - Missing bookie(s) from last segment. Opening Ledger77 for Recovery.
13:30:00.492 [bookkeeper-io-16-8] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x68317d5d, L:/172.31.7.191:60190]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.493 [bookkeeper-io-16-9] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x28dc1016, L:/172.31.7.191:60192]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.494 [BookieHighPriorityThread-3181-OrderedExecutor-5-0] INFO  org.apache.bookkeeper.proto.ReadEntryProcessorV3 - Ledger fence request received for ledger: 77 from address: /172.31.7.191:56482
13:30:00.494 [bookkeeper-io-16-10] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xdacfdcee, L:/172.31.7.191:60194]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.494 [bookkeeper-io-16-11] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x0f17bf8e, L:/172.31.7.191:60196]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.494 [BookKeeperClientWorker-OrderedExecutor-13-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L77 E8958 from bookie: 172.31.15.110:3181
13:30:00.495 [bookkeeper-io-16-12] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x59f77aa5, L:/172.31.7.191:60198]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.496 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (77, 8958): Bookie handle is not available
13:30:00.496 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.496 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.496 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.496 [bookkeeper-io-16-13] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x52935658, L:/172.31.7.191:60200]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.496 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.496 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.496 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.496 [BookKeeperClientWorker-OrderedExecutor-13-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 77
13:30:00.496 [BookKeeperClientWorker-OrderedExecutor-13-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L77 E8958
13:30:00.496 [BookKeeperClientWorker-OrderedExecutor-13-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8959 while recovering ledger: 77
13:30:00.496 [BookKeeperClientWorker-OrderedExecutor-13-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L77 E8959
13:30:00.496 [BookKeeperClientWorker-OrderedExecutor-13-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8960 while recovering ledger: 77
13:30:00.496 [BookKeeperClientWorker-OrderedExecutor-13-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L77 E8960 from bookie: 172.31.15.110:3181
13:30:00.496 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (77, 8959): Bookie handle is not available
13:30:00.497 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.497 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.497 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.497 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.497 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.497 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.497 [BookKeeperClientWorker-OrderedExecutor-13-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 77
13:30:00.496 [PendingReplicationTimer] ERROR org.apache.bookkeeper.replication.ReplicationWorker - BKException while fencing the ledger 77 for rereplication of postponed ledgers
org.apache.bookkeeper.client.BKException$BKLedgerRecoveryException: Error while recovering ledger
	at org.apache.bookkeeper.client.SyncCallbackUtils.finish(SyncCallbackUtils.java:83) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.SyncCallbackUtils$SyncOpenCallback.openComplete(SyncCallbackUtils.java:157) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp.openComplete(LedgerOpenOp.java:232) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:201) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:193) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.util.OrderedGenericCallback.operationComplete(OrderedGenericCallback.java:62) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookkeeperInternalCallbacks$TimedGenericCallback.operationComplete(BookkeeperInternalCallbacks.java:189) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.lambda$recover$5(ReadOnlyLedgerHandle.java:295) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990) ~[?:1.8.0_265]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.submitCallback(LedgerRecoveryOp.java:136) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.addComplete(LedgerRecoveryOp.java:217) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.AsyncCallback$AddCallback.addCompleteWithLatency(AsyncCallback.java:91) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.submitCallback(PendingAddOp.java:430) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1784) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1769) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleUnrecoverableErrorDuringAdd(ReadOnlyLedgerHandle.java:244) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleBookieFailure(ReadOnlyLedgerHandle.java:236) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:377) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:292) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) ~[org.apache.bookkeeper-bookkeeper-common-4.10.0.jar:4.10.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_265]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_265]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) ~[?:1.8.0_265]
13:30:00.500 [bookkeeper-io-16-14] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xf823fdf9, L:/172.31.7.191:60202]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.501 [PendingReplicationTimer] WARN  org.apache.bookkeeper.replication.ReplicationWorker - Missing bookie(s) from last segment. Opening Ledger20 for Recovery.
13:30:00.501 [bookkeeper-io-16-15] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xecb0cd3f, L:/172.31.7.191:60204]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.502 [bookkeeper-io-16-16] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xab72ff77, L:/172.31.7.191:60206]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.503 [BookieHighPriorityThread-3181-OrderedExecutor-4-0] INFO  org.apache.bookkeeper.proto.ReadEntryProcessorV3 - Ledger fence request received for ledger: 20 from address: /172.31.7.191:56482
13:30:00.503 [bookkeeper-io-16-17] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x4035741f, L:/172.31.7.191:60208]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.504 [bookkeeper-io-16-18] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xa2fcba04, L:/172.31.7.191:60210]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.504 [BookKeeperClientWorker-OrderedExecutor-4-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L20 E8721 from bookie: 172.31.15.110:3181
13:30:00.505 [bookkeeper-io-16-19] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xb7e5ddde, L:/172.31.7.191:60212]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.505 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (20, 8721): Bookie handle is not available
13:30:00.505 [bookkeeper-io-16-20] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x593c4cc8, L:/172.31.7.191:60214]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.505 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.506 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.506 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.506 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.506 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.506 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.506 [BookKeeperClientWorker-OrderedExecutor-4-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 20
13:30:00.506 [BookKeeperClientWorker-OrderedExecutor-4-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L20 E8721
13:30:00.506 [BookKeeperClientWorker-OrderedExecutor-4-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8722 while recovering ledger: 20
13:30:00.506 [BookKeeperClientWorker-OrderedExecutor-4-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L20 E8722
13:30:00.506 [BookKeeperClientWorker-OrderedExecutor-4-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8723 while recovering ledger: 20
13:30:00.506 [BookKeeperClientWorker-OrderedExecutor-4-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L20 E8723 from bookie: 172.31.15.110:3181
13:30:00.506 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (20, 8722): Bookie handle is not available
13:30:00.506 [PendingReplicationTimer] ERROR org.apache.bookkeeper.replication.ReplicationWorker - BKException while fencing the ledger 20 for rereplication of postponed ledgers
org.apache.bookkeeper.client.BKException$BKLedgerRecoveryException: Error while recovering ledger
	at org.apache.bookkeeper.client.SyncCallbackUtils.finish(SyncCallbackUtils.java:83) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.SyncCallbackUtils$SyncOpenCallback.openComplete(SyncCallbackUtils.java:157) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp.openComplete(LedgerOpenOp.java:232) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:201) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:193) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.util.OrderedGenericCallback.operationComplete(OrderedGenericCallback.java:62) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookkeeperInternalCallbacks$TimedGenericCallback.operationComplete(BookkeeperInternalCallbacks.java:189) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.lambda$recover$5(ReadOnlyLedgerHandle.java:295) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990) ~[?:1.8.0_265]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.submitCallback(LedgerRecoveryOp.java:136) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.addComplete(LedgerRecoveryOp.java:217) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.AsyncCallback$AddCallback.addCompleteWithLatency(AsyncCallback.java:91) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.submitCallback(PendingAddOp.java:430) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1784) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1769) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleUnrecoverableErrorDuringAdd(ReadOnlyLedgerHandle.java:244) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleBookieFailure(ReadOnlyLedgerHandle.java:236) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:377) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:292) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) ~[org.apache.bookkeeper-bookkeeper-common-4.10.0.jar:4.10.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_265]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_265]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) ~[?:1.8.0_265]
13:30:00.507 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.507 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.507 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.507 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.507 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.507 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.507 [BookKeeperClientWorker-OrderedExecutor-4-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 20
13:30:00.507 [bookkeeper-io-16-21] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x852f94d0, L:/172.31.7.191:60216]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.508 [bookkeeper-io-16-22] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x5193df58, L:/172.31.7.191:60218]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.510 [bookkeeper-io-16-23] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xeb2c555b, L:/172.31.7.191:60220]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.510 [PendingReplicationTimer] WARN  org.apache.bookkeeper.replication.ReplicationWorker - Missing bookie(s) from last segment. Opening Ledger21 for Recovery.
13:30:00.513 [BookieHighPriorityThread-3181-OrderedExecutor-5-0] INFO  org.apache.bookkeeper.proto.ReadEntryProcessorV3 - Ledger fence request received for ledger: 21 from address: /172.31.7.191:56482
13:30:00.513 [bookkeeper-io-16-24] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x471fc0f5, L:/172.31.7.191:60222]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.515 [bookkeeper-io-16-25] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x1b2417de, L:/172.31.7.191:60224]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.516 [bookkeeper-io-16-26] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x94006569, L:/172.31.7.191:60226]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.517 [bookkeeper-io-16-27] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x62e29b20, L:/172.31.7.191:60228]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.517 [BookKeeperClientWorker-OrderedExecutor-5-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L21 E8719 from bookie: 172.31.15.110:3181
13:30:00.518 [bookkeeper-io-16-28] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xe540ef3b, L:/172.31.7.191:60230]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.519 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (21, 8719): Bookie handle is not available
13:30:00.519 [bookkeeper-io-16-29] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xea5a5610, L:/172.31.7.191:60232]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.519 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.519 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.519 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.519 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.519 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.519 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.519 [BookKeeperClientWorker-OrderedExecutor-5-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 21
13:30:00.519 [BookKeeperClientWorker-OrderedExecutor-5-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L21 E8719
13:30:00.519 [BookKeeperClientWorker-OrderedExecutor-5-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8720 while recovering ledger: 21
13:30:00.519 [BookKeeperClientWorker-OrderedExecutor-5-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L21 E8720
13:30:00.519 [BookKeeperClientWorker-OrderedExecutor-5-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8721 while recovering ledger: 21
13:30:00.519 [BookKeeperClientWorker-OrderedExecutor-5-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L21 E8721 from bookie: 172.31.15.110:3181
13:30:00.520 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (21, 8720): Bookie handle is not available
13:30:00.520 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.520 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.519 [PendingReplicationTimer] ERROR org.apache.bookkeeper.replication.ReplicationWorker - BKException while fencing the ledger 21 for rereplication of postponed ledgers
org.apache.bookkeeper.client.BKException$BKLedgerRecoveryException: Error while recovering ledger
	at org.apache.bookkeeper.client.SyncCallbackUtils.finish(SyncCallbackUtils.java:83) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.SyncCallbackUtils$SyncOpenCallback.openComplete(SyncCallbackUtils.java:157) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp.openComplete(LedgerOpenOp.java:232) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:201) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:193) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.util.OrderedGenericCallback.operationComplete(OrderedGenericCallback.java:62) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookkeeperInternalCallbacks$TimedGenericCallback.operationComplete(BookkeeperInternalCallbacks.java:189) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.lambda$recover$5(ReadOnlyLedgerHandle.java:295) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990) ~[?:1.8.0_265]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.submitCallback(LedgerRecoveryOp.java:136) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.addComplete(LedgerRecoveryOp.java:217) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.AsyncCallback$AddCallback.addCompleteWithLatency(AsyncCallback.java:91) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.submitCallback(PendingAddOp.java:430) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1784) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1769) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleUnrecoverableErrorDuringAdd(ReadOnlyLedgerHandle.java:244) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleBookieFailure(ReadOnlyLedgerHandle.java:236) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:377) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:292) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) ~[org.apache.bookkeeper-bookkeeper-common-4.10.0.jar:4.10.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_265]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_265]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) ~[?:1.8.0_265]
13:30:00.520 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.520 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.520 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.520 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.520 [BookKeeperClientWorker-OrderedExecutor-5-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 21
13:30:00.525 [bookkeeper-io-16-30] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x27f39ebb, L:/172.31.7.191:60234]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.526 [bookkeeper-io-16-31] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x419fa3a7, L:/172.31.7.191:60236]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.526 [PendingReplicationTimer] WARN  org.apache.bookkeeper.replication.ReplicationWorker - Missing bookie(s) from last segment. Opening Ledger57 for Recovery.
13:30:00.526 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.526 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.526 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.526 [ReplicationWorker] WARN  org.apache.bookkeeper.replication.ReplicationWorker - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1012) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1061) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.527 [bookkeeper-io-16-32] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x1234b177, L:/172.31.7.191:60238]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.528 [ReplicationWorker] ERROR org.apache.bookkeeper.replication.ReplicationWorker - ReplicationWorker failed to replicate Ledger : 54 for 0 number of times, so deferring the ledger lock release by 9375 msecs
13:30:00.531 [BookieHighPriorityThread-3181-OrderedExecutor-1-0] INFO  org.apache.bookkeeper.proto.ReadEntryProcessorV3 - Ledger fence request received for ledger: 57 from address: /172.31.7.191:56482
13:30:00.531 [bookkeeper-io-16-1] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x09314488, L:/172.31.7.191:60240]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.536 [bookkeeper-io-16-2] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x5158c7b7, L:/172.31.7.191:60242]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.536 [BookKeeperClientWorker-OrderedExecutor-9-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L57 E8717 from bookie: 172.31.15.110:3181
13:30:00.536 [bookkeeper-io-16-3] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x4ab5d71a, L:/172.31.7.191:60244]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.537 [bookkeeper-io-16-4] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x23c192f7, L:/172.31.7.191:60246]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.538 [BookKeeperClientWorker-OrderedExecutor-9-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (57, 8717): Bookie handle is not available
13:30:00.538 [bookkeeper-io-16-5] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x848f7272, L:/172.31.7.191:60248]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.538 [BookKeeperClientWorker-OrderedExecutor-9-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.538 [BookKeeperClientWorker-OrderedExecutor-9-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.538 [BookKeeperClientWorker-OrderedExecutor-9-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.538 [BookKeeperClientWorker-OrderedExecutor-9-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.538 [BookKeeperClientWorker-OrderedExecutor-9-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.538 [BookKeeperClientWorker-OrderedExecutor-9-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.538 [BookKeeperClientWorker-OrderedExecutor-9-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 57
13:30:00.538 [BookKeeperClientWorker-OrderedExecutor-9-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L57 E8717
13:30:00.538 [BookKeeperClientWorker-OrderedExecutor-9-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8718 while recovering ledger: 57
13:30:00.538 [BookKeeperClientWorker-OrderedExecutor-9-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L57 E8718
13:30:00.538 [BookKeeperClientWorker-OrderedExecutor-9-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8719 while recovering ledger: 57
13:30:00.538 [BookKeeperClientWorker-OrderedExecutor-9-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L57 E8719 from bookie: 172.31.15.110:3181
13:30:00.538 [BookKeeperClientWorker-OrderedExecutor-9-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (57, 8718): Bookie handle is not available
13:30:00.539 [BookKeeperClientWorker-OrderedExecutor-9-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.539 [BookKeeperClientWorker-OrderedExecutor-9-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.538 [PendingReplicationTimer] ERROR org.apache.bookkeeper.replication.ReplicationWorker - BKException while fencing the ledger 57 for rereplication of postponed ledgers
org.apache.bookkeeper.client.BKException$BKLedgerRecoveryException: Error while recovering ledger
	at org.apache.bookkeeper.client.SyncCallbackUtils.finish(SyncCallbackUtils.java:83) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.SyncCallbackUtils$SyncOpenCallback.openComplete(SyncCallbackUtils.java:157) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp.openComplete(LedgerOpenOp.java:232) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:201) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:193) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.util.OrderedGenericCallback.operationComplete(OrderedGenericCallback.java:62) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookkeeperInternalCallbacks$TimedGenericCallback.operationComplete(BookkeeperInternalCallbacks.java:189) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.lambda$recover$5(ReadOnlyLedgerHandle.java:295) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990) ~[?:1.8.0_265]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.submitCallback(LedgerRecoveryOp.java:136) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.addComplete(LedgerRecoveryOp.java:217) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.AsyncCallback$AddCallback.addCompleteWithLatency(AsyncCallback.java:91) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.submitCallback(PendingAddOp.java:430) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1784) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1769) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleUnrecoverableErrorDuringAdd(ReadOnlyLedgerHandle.java:244) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleBookieFailure(ReadOnlyLedgerHandle.java:236) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:377) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:292) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) ~[org.apache.bookkeeper-bookkeeper-common-4.10.0.jar:4.10.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_265]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_265]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) ~[?:1.8.0_265]
13:30:00.539 [BookKeeperClientWorker-OrderedExecutor-9-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.539 [BookKeeperClientWorker-OrderedExecutor-9-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.539 [BookKeeperClientWorker-OrderedExecutor-9-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.539 [BookKeeperClientWorker-OrderedExecutor-9-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.539 [BookKeeperClientWorker-OrderedExecutor-9-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 57
13:30:00.541 [bookkeeper-io-16-6] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x2b4b5540, L:/172.31.7.191:60250]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.542 [PendingReplicationTimer] WARN  org.apache.bookkeeper.replication.ReplicationWorker - Missing bookie(s) from last segment. Opening Ledger157 for Recovery.
13:30:00.543 [bookkeeper-io-16-7] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xec7f00ec, L:/172.31.7.191:60252]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.545 [BookieHighPriorityThread-3181-OrderedExecutor-5-0] INFO  org.apache.bookkeeper.proto.ReadEntryProcessorV3 - Ledger fence request received for ledger: 157 from address: /172.31.7.191:56482
13:30:00.545 [bookkeeper-io-16-8] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x1db67606, L:/172.31.7.191:60254]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.546 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.546 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.546 [ReplicationWorker] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.546 [ReplicationWorker] WARN  org.apache.bookkeeper.replication.ReplicationWorker - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1012) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1061) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.547 [bookkeeper-io-16-9] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x62e5d6cd, L:/172.31.7.191:60256]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.547 [ReplicationWorker] ERROR org.apache.bookkeeper.replication.ReplicationWorker - ReplicationWorker failed to replicate Ledger : 107 for 0 number of times, so deferring the ledger lock release by 9375 msecs
13:30:00.550 [bookkeeper-io-16-10] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x069dd2b3, L:/172.31.7.191:60258]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.550 [BookKeeperClientWorker-OrderedExecutor-13-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L157 E98 from bookie: 172.31.15.110:3181
13:30:00.551 [bookkeeper-io-16-11] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x068ff08a, L:/172.31.7.191:60260]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.552 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (157, 98): Bookie handle is not available
13:30:00.552 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.552 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.552 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.552 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.552 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.552 [BookKeeperClientWorker-OrderedExecutor-13-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.552 [BookKeeperClientWorker-OrderedExecutor-13-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 157
13:30:00.552 [BookKeeperClientWorker-OrderedExecutor-13-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L157 E98
13:30:00.552 [BookKeeperClientWorker-OrderedExecutor-13-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 99 while recovering ledger: 157
13:30:00.552 [PendingReplicationTimer] ERROR org.apache.bookkeeper.replication.ReplicationWorker - BKException while fencing the ledger 157 for rereplication of postponed ledgers
org.apache.bookkeeper.client.BKException$BKLedgerRecoveryException: Error while recovering ledger
	at org.apache.bookkeeper.client.SyncCallbackUtils.finish(SyncCallbackUtils.java:83) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.SyncCallbackUtils$SyncOpenCallback.openComplete(SyncCallbackUtils.java:157) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp.openComplete(LedgerOpenOp.java:232) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:201) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:193) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.util.OrderedGenericCallback.operationComplete(OrderedGenericCallback.java:62) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookkeeperInternalCallbacks$TimedGenericCallback.operationComplete(BookkeeperInternalCallbacks.java:189) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.lambda$recover$5(ReadOnlyLedgerHandle.java:295) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990) ~[?:1.8.0_265]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.submitCallback(LedgerRecoveryOp.java:136) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.addComplete(LedgerRecoveryOp.java:217) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.AsyncCallback$AddCallback.addCompleteWithLatency(AsyncCallback.java:91) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.submitCallback(PendingAddOp.java:430) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1784) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1769) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleUnrecoverableErrorDuringAdd(ReadOnlyLedgerHandle.java:244) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleBookieFailure(ReadOnlyLedgerHandle.java:236) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:377) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:292) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) ~[org.apache.bookkeeper-bookkeeper-common-4.10.0.jar:4.10.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_265]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_265]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) ~[?:1.8.0_265]
13:30:00.554 [bookkeeper-io-16-12] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x2ada140e, L:/172.31.7.191:60262]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.555 [bookkeeper-io-16-13] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xa5b2c918, L:/172.31.7.191:60264]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.557 [bookkeeper-io-16-14] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xdcbd72ea, L:/172.31.7.191:60266]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.559 [PendingReplicationTimer] WARN  org.apache.bookkeeper.replication.ReplicationWorker - Missing bookie(s) from last segment. Opening Ledger71 for Recovery.
13:30:00.560 [BookieHighPriorityThread-3181-OrderedExecutor-7-0] INFO  org.apache.bookkeeper.proto.ReadEntryProcessorV3 - Ledger fence request received for ledger: 71 from address: /172.31.7.191:56482
13:30:00.560 [bookkeeper-io-16-15] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x1c3cd445, L:/172.31.7.191:60268]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.561 [bookkeeper-io-16-16] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xe17d70e4, L:/172.31.7.191:60270]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.561 [BookKeeperClientWorker-OrderedExecutor-7-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L71 E8955 from bookie: 172.31.15.110:3181
13:30:00.561 [BookKeeperClientWorker-OrderedExecutor-7-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (71, 8954): Bookie handle is not available
13:30:00.562 [BookKeeperClientWorker-OrderedExecutor-7-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.562 [BookKeeperClientWorker-OrderedExecutor-7-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.562 [BookKeeperClientWorker-OrderedExecutor-7-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.562 [BookKeeperClientWorker-OrderedExecutor-7-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.562 [BookKeeperClientWorker-OrderedExecutor-7-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.562 [BookKeeperClientWorker-OrderedExecutor-7-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.562 [BookKeeperClientWorker-OrderedExecutor-7-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 71
13:30:00.562 [BookKeeperClientWorker-OrderedExecutor-7-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L71 E8954
13:30:00.562 [BookKeeperClientWorker-OrderedExecutor-7-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8955 while recovering ledger: 71
13:30:00.562 [BookKeeperClientWorker-OrderedExecutor-7-0] WARN  org.apache.bookkeeper.client.LedgerRecoveryOp - Successfully read entry 8955 for ledger 71, but readDone is already false
13:30:00.562 [bookkeeper-io-16-17] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xf92416ee, L:/172.31.7.191:60272]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.562 [PendingReplicationTimer] ERROR org.apache.bookkeeper.replication.ReplicationWorker - BKException while fencing the ledger 71 for rereplication of postponed ledgers
org.apache.bookkeeper.client.BKException$BKLedgerRecoveryException: Error while recovering ledger
	at org.apache.bookkeeper.client.SyncCallbackUtils.finish(SyncCallbackUtils.java:83) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.SyncCallbackUtils$SyncOpenCallback.openComplete(SyncCallbackUtils.java:157) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp.openComplete(LedgerOpenOp.java:232) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:201) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:193) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.util.OrderedGenericCallback.operationComplete(OrderedGenericCallback.java:62) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookkeeperInternalCallbacks$TimedGenericCallback.operationComplete(BookkeeperInternalCallbacks.java:189) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.lambda$recover$5(ReadOnlyLedgerHandle.java:295) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990) ~[?:1.8.0_265]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.submitCallback(LedgerRecoveryOp.java:136) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.addComplete(LedgerRecoveryOp.java:217) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.AsyncCallback$AddCallback.addCompleteWithLatency(AsyncCallback.java:91) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.submitCallback(PendingAddOp.java:430) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1784) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1769) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleUnrecoverableErrorDuringAdd(ReadOnlyLedgerHandle.java:244) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleBookieFailure(ReadOnlyLedgerHandle.java:236) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:377) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:292) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) ~[org.apache.bookkeeper-bookkeeper-common-4.10.0.jar:4.10.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_265]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_265]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) ~[?:1.8.0_265]
13:30:00.565 [bookkeeper-io-16-18] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xb1ae5227, L:/172.31.7.191:60274]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.566 [PendingReplicationTimer] WARN  org.apache.bookkeeper.replication.ReplicationWorker - Missing bookie(s) from last segment. Opening Ledger85 for Recovery.
13:30:00.568 [BookieHighPriorityThread-3181-OrderedExecutor-5-0] INFO  org.apache.bookkeeper.proto.ReadEntryProcessorV3 - Ledger fence request received for ledger: 85 from address: /172.31.7.191:56482
13:30:00.569 [bookkeeper-io-16-19] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x290bd241, L:/172.31.7.191:60276]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.570 [bookkeeper-io-16-20] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x4151d69f, L:/172.31.7.191:60278]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.570 [bookkeeper-io-16-21] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x24d78e0e, L:/172.31.7.191:60280]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.573 [bookkeeper-io-16-22] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x61cbbecd, L:/172.31.7.191:60282]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.573 [BookKeeperClientWorker-OrderedExecutor-5-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L85 E8959 from bookie: 172.31.15.110:3181
13:30:00.573 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (85, 8958): Bookie handle is not available
13:30:00.574 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.574 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.574 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.574 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.574 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.574 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.574 [BookKeeperClientWorker-OrderedExecutor-5-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 85
13:30:00.574 [BookKeeperClientWorker-OrderedExecutor-5-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L85 E8958
13:30:00.574 [BookKeeperClientWorker-OrderedExecutor-5-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8959 while recovering ledger: 85
13:30:00.574 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.LedgerRecoveryOp - Successfully read entry 8959 for ledger 85, but readDone is already false
13:30:00.574 [PendingReplicationTimer] ERROR org.apache.bookkeeper.replication.ReplicationWorker - BKException while fencing the ledger 85 for rereplication of postponed ledgers
org.apache.bookkeeper.client.BKException$BKLedgerRecoveryException: Error while recovering ledger
	at org.apache.bookkeeper.client.SyncCallbackUtils.finish(SyncCallbackUtils.java:83) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.SyncCallbackUtils$SyncOpenCallback.openComplete(SyncCallbackUtils.java:157) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp.openComplete(LedgerOpenOp.java:232) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:201) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:193) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.util.OrderedGenericCallback.operationComplete(OrderedGenericCallback.java:62) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookkeeperInternalCallbacks$TimedGenericCallback.operationComplete(BookkeeperInternalCallbacks.java:189) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.lambda$recover$5(ReadOnlyLedgerHandle.java:295) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990) ~[?:1.8.0_265]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.submitCallback(LedgerRecoveryOp.java:136) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.addComplete(LedgerRecoveryOp.java:217) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.AsyncCallback$AddCallback.addCompleteWithLatency(AsyncCallback.java:91) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.submitCallback(PendingAddOp.java:430) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1784) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1769) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleUnrecoverableErrorDuringAdd(ReadOnlyLedgerHandle.java:244) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleBookieFailure(ReadOnlyLedgerHandle.java:236) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:377) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:292) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) ~[org.apache.bookkeeper-bookkeeper-common-4.10.0.jar:4.10.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_265]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_265]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) ~[?:1.8.0_265]
13:30:00.577 [bookkeeper-io-16-23] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xb2a3ea1e, L:/172.31.7.191:60284]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.577 [PendingReplicationTimer] WARN  org.apache.bookkeeper.replication.ReplicationWorker - Missing bookie(s) from last segment. Opening Ledger117 for Recovery.
13:30:00.577 [bookkeeper-io-16-24] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x41a7320e, L:/172.31.7.191:60286]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.579 [BookieHighPriorityThread-3181-OrderedExecutor-5-0] INFO  org.apache.bookkeeper.proto.ReadEntryProcessorV3 - Ledger fence request received for ledger: 117 from address: /172.31.7.191:56482
13:30:00.579 [bookkeeper-io-16-25] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xb2a595d2, L:/172.31.7.191:60288]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.579 [bookkeeper-io-16-26] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xd9f43cc9, L:/172.31.7.191:60290]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.579 [BookKeeperClientWorker-OrderedExecutor-5-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L117 E8965 from bookie: 172.31.15.110:3181
13:30:00.580 [bookkeeper-io-16-27] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x20bb642b, L:/172.31.7.191:60292]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.581 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (117, 8965): Bookie handle is not available
13:30:00.581 [bookkeeper-io-16-28] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x8677b2cb, L:/172.31.7.191:60294]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.581 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.581 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.581 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.582 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.582 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.582 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.582 [BookKeeperClientWorker-OrderedExecutor-5-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 117
13:30:00.582 [BookKeeperClientWorker-OrderedExecutor-5-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L117 E8965
13:30:00.582 [BookKeeperClientWorker-OrderedExecutor-5-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8966 while recovering ledger: 117
13:30:00.582 [BookKeeperClientWorker-OrderedExecutor-5-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L117 E8966
13:30:00.582 [BookKeeperClientWorker-OrderedExecutor-5-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8967 while recovering ledger: 117
13:30:00.582 [BookKeeperClientWorker-OrderedExecutor-5-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L117 E8967 from bookie: 172.31.15.110:3181
13:30:00.582 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (117, 8966): Bookie handle is not available
13:30:00.582 [PendingReplicationTimer] ERROR org.apache.bookkeeper.replication.ReplicationWorker - BKException while fencing the ledger 117 for rereplication of postponed ledgers
org.apache.bookkeeper.client.BKException$BKLedgerRecoveryException: Error while recovering ledger
	at org.apache.bookkeeper.client.SyncCallbackUtils.finish(SyncCallbackUtils.java:83) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.SyncCallbackUtils$SyncOpenCallback.openComplete(SyncCallbackUtils.java:157) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp.openComplete(LedgerOpenOp.java:232) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:201) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:193) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.util.OrderedGenericCallback.operationComplete(OrderedGenericCallback.java:62) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookkeeperInternalCallbacks$TimedGenericCallback.operationComplete(BookkeeperInternalCallbacks.java:189) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.lambda$recover$5(ReadOnlyLedgerHandle.java:295) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990) ~[?:1.8.0_265]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.submitCallback(LedgerRecoveryOp.java:136) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.addComplete(LedgerRecoveryOp.java:217) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.AsyncCallback$AddCallback.addCompleteWithLatency(AsyncCallback.java:91) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.submitCallback(PendingAddOp.java:430) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1784) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1769) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleUnrecoverableErrorDuringAdd(ReadOnlyLedgerHandle.java:244) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleBookieFailure(ReadOnlyLedgerHandle.java:236) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:377) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:292) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) ~[org.apache.bookkeeper-bookkeeper-common-4.10.0.jar:4.10.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_265]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_265]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) ~[?:1.8.0_265]
13:30:00.582 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.582 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.582 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.582 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.583 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.583 [BookKeeperClientWorker-OrderedExecutor-5-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.583 [BookKeeperClientWorker-OrderedExecutor-5-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 117
13:30:00.586 [bookkeeper-io-16-29] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x58cc44a4, L:/172.31.7.191:60296]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.587 [bookkeeper-io-16-30] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xd9c6f020, L:/172.31.7.191:60298]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.588 [PendingReplicationTimer] WARN  org.apache.bookkeeper.replication.ReplicationWorker - Missing bookie(s) from last segment. Opening Ledger106 for Recovery.
13:30:00.590 [BookieHighPriorityThread-3181-OrderedExecutor-2-0] INFO  org.apache.bookkeeper.proto.ReadEntryProcessorV3 - Ledger fence request received for ledger: 106 from address: /172.31.7.191:56482
13:30:00.591 [bookkeeper-io-16-31] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x9f820bf0, L:/172.31.7.191:60300]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.595 [bookkeeper-io-16-32] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xa92ce076, L:/172.31.7.191:60302]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.595 [bookkeeper-io-16-1] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x41df9945, L:/172.31.7.191:60304]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.596 [BookKeeperClientWorker-OrderedExecutor-10-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L106 E8951 from bookie: 172.31.15.110:3181
13:30:00.596 [BookKeeperClientWorker-OrderedExecutor-10-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (106, 8950): Bookie handle is not available
13:30:00.596 [BookKeeperClientWorker-OrderedExecutor-10-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.596 [BookKeeperClientWorker-OrderedExecutor-10-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.596 [BookKeeperClientWorker-OrderedExecutor-10-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.596 [BookKeeperClientWorker-OrderedExecutor-10-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.596 [BookKeeperClientWorker-OrderedExecutor-10-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.596 [BookKeeperClientWorker-OrderedExecutor-10-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.596 [BookKeeperClientWorker-OrderedExecutor-10-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 106
13:30:00.596 [BookKeeperClientWorker-OrderedExecutor-10-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L106 E8950
13:30:00.596 [BookKeeperClientWorker-OrderedExecutor-10-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8951 while recovering ledger: 106
13:30:00.597 [BookKeeperClientWorker-OrderedExecutor-10-0] WARN  org.apache.bookkeeper.client.LedgerRecoveryOp - Successfully read entry 8951 for ledger 106, but readDone is already false
13:30:00.596 [PendingReplicationTimer] ERROR org.apache.bookkeeper.replication.ReplicationWorker - BKException while fencing the ledger 106 for rereplication of postponed ledgers
org.apache.bookkeeper.client.BKException$BKLedgerRecoveryException: Error while recovering ledger
	at org.apache.bookkeeper.client.SyncCallbackUtils.finish(SyncCallbackUtils.java:83) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.SyncCallbackUtils$SyncOpenCallback.openComplete(SyncCallbackUtils.java:157) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp.openComplete(LedgerOpenOp.java:232) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:201) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:193) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.util.OrderedGenericCallback.operationComplete(OrderedGenericCallback.java:62) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookkeeperInternalCallbacks$TimedGenericCallback.operationComplete(BookkeeperInternalCallbacks.java:189) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.lambda$recover$5(ReadOnlyLedgerHandle.java:295) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990) ~[?:1.8.0_265]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.submitCallback(LedgerRecoveryOp.java:136) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.addComplete(LedgerRecoveryOp.java:217) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.AsyncCallback$AddCallback.addCompleteWithLatency(AsyncCallback.java:91) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.submitCallback(PendingAddOp.java:430) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1784) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1769) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleUnrecoverableErrorDuringAdd(ReadOnlyLedgerHandle.java:244) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleBookieFailure(ReadOnlyLedgerHandle.java:236) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:377) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:292) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) ~[org.apache.bookkeeper-bookkeeper-common-4.10.0.jar:4.10.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_265]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_265]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) ~[?:1.8.0_265]
13:30:00.599 [bookkeeper-io-16-2] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x11d3571c, L:/172.31.7.191:60306]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.600 [PendingReplicationTimer] WARN  org.apache.bookkeeper.replication.ReplicationWorker - Missing bookie(s) from last segment. Opening Ledger100 for Recovery.
13:30:00.601 [bookkeeper-io-16-3] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x6f71b07a, L:/172.31.7.191:60308]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.602 [bookkeeper-io-16-4] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xa503a6fa, L:/172.31.7.191:60310]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.603 [BookieHighPriorityThread-3181-OrderedExecutor-4-0] INFO  org.apache.bookkeeper.proto.ReadEntryProcessorV3 - Ledger fence request received for ledger: 100 from address: /172.31.7.191:56482
13:30:00.604 [bookkeeper-io-16-5] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x82e182e5, L:/172.31.7.191:60312]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.608 [bookkeeper-io-16-6] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x632ca10a, L:/172.31.7.191:60314]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.608 [BookKeeperClientWorker-OrderedExecutor-4-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L100 E8955 from bookie: 172.31.15.110:3181
13:30:00.608 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (100, 8954): Bookie handle is not available
13:30:00.609 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.609 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.609 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.609 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.609 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.609 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.609 [BookKeeperClientWorker-OrderedExecutor-4-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 100
13:30:00.609 [BookKeeperClientWorker-OrderedExecutor-4-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L100 E8954
13:30:00.609 [BookKeeperClientWorker-OrderedExecutor-4-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 8955 while recovering ledger: 100
13:30:00.609 [BookKeeperClientWorker-OrderedExecutor-4-0] WARN  org.apache.bookkeeper.client.LedgerRecoveryOp - Successfully read entry 8955 for ledger 100, but readDone is already false
13:30:00.609 [PendingReplicationTimer] ERROR org.apache.bookkeeper.replication.ReplicationWorker - BKException while fencing the ledger 100 for rereplication of postponed ledgers
org.apache.bookkeeper.client.BKException$BKLedgerRecoveryException: Error while recovering ledger
	at org.apache.bookkeeper.client.SyncCallbackUtils.finish(SyncCallbackUtils.java:83) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.SyncCallbackUtils$SyncOpenCallback.openComplete(SyncCallbackUtils.java:157) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp.openComplete(LedgerOpenOp.java:232) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:201) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:193) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.util.OrderedGenericCallback.operationComplete(OrderedGenericCallback.java:62) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookkeeperInternalCallbacks$TimedGenericCallback.operationComplete(BookkeeperInternalCallbacks.java:189) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.lambda$recover$5(ReadOnlyLedgerHandle.java:295) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990) ~[?:1.8.0_265]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.submitCallback(LedgerRecoveryOp.java:136) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.addComplete(LedgerRecoveryOp.java:217) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.AsyncCallback$AddCallback.addCompleteWithLatency(AsyncCallback.java:91) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.submitCallback(PendingAddOp.java:430) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1784) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1769) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleUnrecoverableErrorDuringAdd(ReadOnlyLedgerHandle.java:244) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleBookieFailure(ReadOnlyLedgerHandle.java:236) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:377) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:292) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) ~[org.apache.bookkeeper-bookkeeper-common-4.10.0.jar:4.10.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_265]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_265]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) ~[?:1.8.0_265]
13:30:00.612 [bookkeeper-io-16-7] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xfaa956d9, L:/172.31.7.191:60316]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.613 [PendingReplicationTimer] WARN  org.apache.bookkeeper.replication.ReplicationWorker - Missing bookie(s) from last segment. Opening Ledger217 for Recovery.
13:30:00.613 [bookkeeper-io-16-8] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x8c00318d, L:/172.31.7.191:60318]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.615 [BookieHighPriorityThread-3181-OrderedExecutor-1-0] INFO  org.apache.bookkeeper.proto.ReadEntryProcessorV3 - Ledger fence request received for ledger: 217 from address: /172.31.7.191:56482
13:30:00.616 [bookkeeper-io-16-9] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0xf5a282ca, L:/172.31.7.191:60320]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.620 [bookkeeper-io-16-10] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x10cc3be1, L:/172.31.7.191:60322]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.621 [BookKeeperClientWorker-OrderedExecutor-9-0] INFO  org.apache.bookkeeper.client.PendingReadOp - Error: Bookie handle is not available while reading L217 E1761 from bookie: 172.31.15.110:3181
13:30:00.621 [bookkeeper-io-16-11] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x0f57402d, L:/172.31.7.191:60324]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.621 [bookkeeper-io-16-12] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: [id: 0x6117aa61, L:/172.31.7.191:60326]/172.31.15.110:3181, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: finishConnect(..) failed: Connection refused: ip-172-31-15-110/172.31.15.110:3181
Caused by: java.net.ConnectException: finishConnect(..) failed: Connection refused
	at io.netty.channel.unix.Errors.throwConnectException(Errors.java:124) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.unix.Socket.finishConnect(Socket.java:243) ~[io.netty-netty-transport-native-unix-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.doFinishConnect(AbstractEpollChannel.java:672) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.finishConnect(AbstractEpollChannel.java:649) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe.epollOutReady(AbstractEpollChannel.java:529) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:465) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [io.netty-netty-transport-native-epoll-4.1.48.Final-linux-x86_64.jar:4.1.48.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:00.622 [BookKeeperClientWorker-OrderedExecutor-9-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (217, 1761): Bookie handle is not available
13:30:00.622 [BookKeeperClientWorker-OrderedExecutor-9-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.622 [BookKeeperClientWorker-OrderedExecutor-9-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.622 [BookKeeperClientWorker-OrderedExecutor-9-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.622 [BookKeeperClientWorker-OrderedExecutor-9-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.622 [BookKeeperClientWorker-OrderedExecutor-9-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], fallback to choose bookie randomly from the cluster.
13:30:00.622 [BookKeeperClientWorker-OrderedExecutor-9-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:172.31.7.191:3181>, <Bookie:172.31.15.110:3181>], allBookies [<Bookie:172.31.7.191:3181>].
13:30:00.622 [BookKeeperClientWorker-OrderedExecutor-9-0] ERROR org.apache.bookkeeper.client.ReadOnlyLedgerHandle - Could not get additional bookie to remake ensemble, closing ledger: 217
13:30:00.622 [BookKeeperClientWorker-OrderedExecutor-9-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L217 E1761
13:30:00.622 [BookKeeperClientWorker-OrderedExecutor-9-0] ERROR org.apache.bookkeeper.client.LedgerRecoveryOp - Failure NotEnoughBookiesException: Not enough non-faulty bookies available while writing entry: 1762 while recovering ledger: 217
13:30:00.622 [PendingReplicationTimer] ERROR org.apache.bookkeeper.replication.ReplicationWorker - BKException while fencing the ledger 217 for rereplication of postponed ledgers
org.apache.bookkeeper.client.BKException$BKLedgerRecoveryException: Error while recovering ledger
	at org.apache.bookkeeper.client.SyncCallbackUtils.finish(SyncCallbackUtils.java:83) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.SyncCallbackUtils$SyncOpenCallback.openComplete(SyncCallbackUtils.java:157) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp.openComplete(LedgerOpenOp.java:232) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:201) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerOpenOp$1.safeOperationComplete(LedgerOpenOp.java:193) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.util.OrderedGenericCallback.operationComplete(OrderedGenericCallback.java:62) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookkeeperInternalCallbacks$TimedGenericCallback.operationComplete(BookkeeperInternalCallbacks.java:189) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.lambda$recover$5(ReadOnlyLedgerHandle.java:295) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:774) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:750) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:488) ~[?:1.8.0_265]
	at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:1990) ~[?:1.8.0_265]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.submitCallback(LedgerRecoveryOp.java:136) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerRecoveryOp.addComplete(LedgerRecoveryOp.java:217) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.AsyncCallback$AddCallback.addCompleteWithLatency(AsyncCallback.java:91) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.submitCallback(PendingAddOp.java:430) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1784) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.LedgerHandle.errorOutPendingAdds(LedgerHandle.java:1769) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleUnrecoverableErrorDuringAdd(ReadOnlyLedgerHandle.java:244) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.ReadOnlyLedgerHandle.handleBookieFailure(ReadOnlyLedgerHandle.java:236) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:377) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:292) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) ~[org.apache.bookkeeper-bookkeeper-common-4.10.0.jar:4.10.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_265]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_265]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) ~[?:1.8.0_265]
13:30:00.956 [main-SendThread(172.31.15.110:2181)] WARN  org.apache.zookeeper.ClientCnxn - Session 0x200020c11060002 for server ip-172-31-15-110/172.31.15.110:2181, unexpected error, closing socket connection and attempting reconnect
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method) ~[?:1.8.0_265]
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39) ~[?:1.8.0_265]
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223) ~[?:1.8.0_265]
	at sun.nio.ch.IOUtil.read(IOUtil.java:192) ~[?:1.8.0_265]
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:377) ~[?:1.8.0_265]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:75) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:363) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1223) [org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
13:30:00.960 [main-SendThread(172.31.7.191:2181)] INFO  org.apache.zookeeper.ClientCnxn - Unable to read additional data from server sessionid 0x100020c20d80005, likely server has closed socket, closing socket connection and attempting reconnect
13:30:01.057 [PendingReplicationTimer] ERROR org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager - Error deleting underreplicated ledger lock
org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /ledgers/underreplication/locks/urL0000000217
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:102) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.zookeeper.ZooKeeper.delete(ZooKeeper.java:1793) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2101(ZooKeeperClient.java:70) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:770) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:764) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.delete(ZooKeeperClient.java:764) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.releaseUnderreplicatedLedger(ZkLedgerUnderreplicationManager.java:633) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker$3.run(ReplicationWorker.java:566) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at java.util.TimerThread.mainLoop(Timer.java:555) [?:1.8.0_265]
	at java.util.TimerThread.run(Timer.java:505) [?:1.8.0_265]
13:30:01.057 [ReplicationWorker] ERROR org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager - Error while checking the state of ledger re-replication
org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /ledgers/underreplication/disable
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:102) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:2021) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2301(ZooKeeperClient.java:70) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$13.call(ZooKeeperClient.java:830) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$13.call(ZooKeeperClient.java:824) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.exists(ZooKeeperClient.java:824) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:2049) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2401(ZooKeeperClient.java:70) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$14.call(ZooKeeperClient.java:851) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$14.call(ZooKeeperClient.java:845) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.exists(ZooKeeperClient.java:845) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.isLedgerReplicationEnabled(ZkLedgerUnderreplicationManager.java:723) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.waitIfLedgerReplicationDisabled(ZkLedgerUnderreplicationManager.java:619) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:600) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:01.057 [main-EventThread] ERROR org.apache.bookkeeper.meta.AbstractZkLedgerManager - Could not read metadata for ledger: 32
org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /ledgers/00/0000/L0032
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:102) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.bookkeeper.meta.AbstractZkLedgerManager$3.processResult(AbstractZkLedgerManager.java:446) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$19$1.processResult(ZooKeeperClient.java:994) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:601) [org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:510) [org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
13:30:01.058 [main-EventThread] WARN  org.apache.bookkeeper.meta.AbstractZkLedgerManager - Failed on read ledger metadata of ledger 32: -9
13:30:01.057 [AuditorBookie-172.31.7.191:3181] ERROR org.apache.bookkeeper.replication.Auditor - Exception while watching available bookies
org.apache.bookkeeper.replication.ReplicationException$BKAuditException: KeeperErrorCode = ConnectionLoss
	at org.apache.bookkeeper.replication.Auditor.auditBookies(Auditor.java:1088) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.Auditor.startAudit(Auditor.java:1033) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.Auditor.access$1500(Auditor.java:132) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.Auditor$9.run(Auditor.java:551) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.util.SafeRunnable$1.safeRun(SafeRunnable.java:43) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [org.apache.bookkeeper-bookkeeper-common-4.10.0.jar:4.10.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [?:1.8.0_265]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_265]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) [?:1.8.0_265]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) [?:1.8.0_265]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_265]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_265]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
Caused by: org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:102) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.lambda$tryMarkLedgerUnderreplicatedAsync$0(ZkLedgerUnderreplicationManager.java:323) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.util.ZkUtils$1.processResult(ZkUtils.java:80) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$10$1.processResult(ZooKeeperClient.java:737) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:642) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:510) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
13:30:01.058 [main-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is disconnected from zookeeper now, but it is OK unless we received EXPIRED event.
13:30:01.057 [PendingReplicationTimer] ERROR org.apache.bookkeeper.replication.ReplicationWorker - UnavailableException while replicating fragments of ledger 217
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Error contacting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.releaseUnderreplicatedLedger(ZkLedgerUnderreplicationManager.java:639) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker$3.run(ReplicationWorker.java:566) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at java.util.TimerThread.mainLoop(Timer.java:555) [?:1.8.0_265]
	at java.util.TimerThread.run(Timer.java:505) [?:1.8.0_265]
Caused by: org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /ledgers/underreplication/locks/urL0000000217
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:102) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.zookeeper.ZooKeeper.delete(ZooKeeper.java:1793) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2101(ZooKeeperClient.java:70) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:770) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:764) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.delete(ZooKeeperClient.java:764) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.releaseUnderreplicatedLedger(ZkLedgerUnderreplicationManager.java:633) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	... 3 more
13:30:01.058 [PendingReplicationTimer] INFO  org.apache.bookkeeper.replication.ReplicationWorker - Shutting down replication worker
13:30:01.058 [ReplicationWorker] ERROR org.apache.bookkeeper.replication.ReplicationWorker - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Error contacting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.isLedgerReplicationEnabled(ZkLedgerUnderreplicationManager.java:728) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.waitIfLedgerReplicationDisabled(ZkLedgerUnderreplicationManager.java:619) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:600) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [io.netty-netty-common-4.1.48.Final.jar:4.1.48.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
Caused by: org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /ledgers/underreplication/disable
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:102) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:2021) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2301(ZooKeeperClient.java:70) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$13.call(ZooKeeperClient.java:830) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$13.call(ZooKeeperClient.java:824) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.exists(ZooKeeperClient.java:824) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:2049) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2401(ZooKeeperClient.java:70) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$14.call(ZooKeeperClient.java:851) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$14.call(ZooKeeperClient.java:845) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.exists(ZooKeeperClient.java:845) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.isLedgerReplicationEnabled(ZkLedgerUnderreplicationManager.java:723) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	... 6 more
13:30:01.058 [PendingReplicationTimer] INFO  org.apache.bookkeeper.replication.ReplicationWorker - Shutting down ReplicationWorker
13:30:01.058 [ReplicationWorker] INFO  org.apache.bookkeeper.replication.ReplicationWorker - ReplicationWorker exited loop!
13:30:01.061 [main-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is disconnected from zookeeper now, but it is OK unless we received EXPIRED event.
13:30:01.145 [main-SendThread(172.31.15.110:2181)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server ip-172-31-15-110/172.31.15.110:2181. Will not attempt to authenticate using SASL (unknown error)
13:30:01.145 [main-SendThread(172.31.15.110:2181)] INFO  org.apache.zookeeper.ClientCnxn - Socket error occurred: ip-172-31-15-110/172.31.15.110:2181: Connection refused
13:30:01.250 [AutoRecoveryDeathWatcher-3181] INFO  org.apache.bookkeeper.replication.AutoRecoveryMain - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
13:30:01.250 [AutoRecoveryDeathWatcher-3181] ERROR org.apache.bookkeeper.common.component.ComponentStarter - Triggered exceptionHandler of Component: bookie-server because of Exception in Thread: Thread[AutoRecoveryDeathWatcher-3181,5,main]
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
13:30:01.251 [component-shutdown-thread] INFO  org.apache.bookkeeper.common.component.ComponentStarter - Closing component bookie-server in shutdown hook.
13:30:01.251 [component-shutdown-thread] INFO  org.apache.bookkeeper.replication.AutoRecoveryMain - Shutting down auto recovery: 0
13:30:01.252 [component-shutdown-thread] INFO  org.apache.bookkeeper.replication.AutoRecoveryMain - Shutting down AutoRecovery
13:30:01.252 [component-shutdown-thread] INFO  org.apache.bookkeeper.replication.Auditor - Shutting down auditor
13:30:01.252 [AuditorElector-172.31.7.191:3181] INFO  org.apache.bookkeeper.replication.AuditorElector - Shutting down AuditorElector
13:30:01.252 [component-shutdown-thread] INFO  org.apache.bookkeeper.replication.ReplicationWorker - Shutting down replication worker
13:30:01.252 [component-shutdown-thread] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 172.31.15.110:3181
13:30:01.254 [component-shutdown-thread] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 172.31.7.191:3181
13:30:01.257 [bookkeeper-io-16-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0x8bc236b9, L:/172.31.7.191:56482 ! R:172.31.7.191/172.31.7.191:3181]
13:30:01.257 [bookie-io-1-3] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xb9b45d11, L:/172.31.7.191:3181 ! R:/172.31.7.191:56482]
13:30:01.733 [main-SendThread(172.31.7.191:2181)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server ip-172-31-7-191/172.31.7.191:2181. Will not attempt to authenticate using SASL (unknown error)
13:30:01.734 [main-SendThread(172.31.7.191:2181)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /172.31.7.191:43554, server: ip-172-31-7-191/172.31.7.191:2181
13:30:01.836 [component-shutdown-thread] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x200020c11060002 closed
13:30:01.836 [main-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x200020c11060002
13:30:01.835 [PendingReplicationTimer] ERROR org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager - Error deleting underreplicated ledger lock
org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /ledgers/underreplication/locks/urL0000000064
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:102) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.zookeeper.ZooKeeper.delete(ZooKeeper.java:1793) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2101(ZooKeeperClient.java:70) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:770) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:764) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.delete(ZooKeeperClient.java:764) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.close(ZkLedgerUnderreplicationManager.java:653) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.shutdown(ReplicationWorker.java:643) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker$3.run(ReplicationWorker.java:570) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at java.util.TimerThread.mainLoop(Timer.java:555) [?:1.8.0_265]
	at java.util.TimerThread.run(Timer.java:505) [?:1.8.0_265]
13:30:01.835 [AuditorElector-172.31.7.191:3181] ERROR org.apache.bookkeeper.replication.AuditorElector - Exception while deleting myVote:/ledgers/underreplication/auditorelection/V_0000000000
org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /ledgers/underreplication/auditorelection/V_0000000000
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:102) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.zookeeper.ZooKeeper.delete(ZooKeeper.java:1793) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2101(ZooKeeperClient.java:70) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:770) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:764) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.delete(ZooKeeperClient.java:764) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.AuditorElector$2.run(AuditorElector.java:262) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [?:1.8.0_265]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_265]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_265]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_265]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_265]
13:30:01.836 [PendingReplicationTimer] WARN  org.apache.bookkeeper.replication.ReplicationWorker - Exception while closing the ZkLedgerUnderrepliationManager
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Error contacting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.close(ZkLedgerUnderreplicationManager.java:659) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker.shutdown(ReplicationWorker.java:643) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.replication.ReplicationWorker$3.run(ReplicationWorker.java:570) [org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at java.util.TimerThread.mainLoop(Timer.java:555) [?:1.8.0_265]
	at java.util.TimerThread.run(Timer.java:505) [?:1.8.0_265]
Caused by: org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /ledgers/underreplication/locks/urL0000000064
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:102) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.zookeeper.ZooKeeper.delete(ZooKeeper.java:1793) ~[org.apache.pulsar-pulsar-zookeeper-2.6.0.jar:2.6.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2101(ZooKeeperClient.java:70) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:770) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:764) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0.jar:4.10.0]
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140) ~[org.apache.bookkeeper-bookkeeper-server-4.10.0